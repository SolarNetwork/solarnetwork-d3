!function(t,e){"function"==typeof define&&define.amd?define(["colorbrewer","d3","queue-async"],e):"object"==typeof module&&module.exports?module.exports=e(require("colorbrewer"),require("d3"),require("queue-async")):t.sn=e(t.colorbrewer,t.d3,t.queue)}(this,function(t,e,n){"use strict";function r(t){var e,n,r,a,o,i,u={};if(void 0!==t&&t.length>0)for(t.match(/^\?/)&&(t=t.substring(1)),e=t.split("&"),r=0,a=e.length;a>r;r++)n=e[r].split("=",2),2===n.length&&(o=decodeURIComponent(n[0]),i=decodeURIComponent(n[1]),u[o]?(Array.isArray(u[o])||(u[o]=[u[o]]),u[o].push(i)):u[o]=i);return u}function a(t){var e;for(e in t)t.hasOwnProperty(e)&&void 0===G[e]&&(G[e]=t[e])}function o(t){var e;for(e in t)t.hasOwnProperty(e)&&(G[e]=t[e])}function i(t,e){var n,r;void 0===e&&(e={});for(n in t)t.hasOwnProperty(n)&&(r=Object.getOwnPropertyDescriptor(t,n),r?Object.defineProperty(e,n,r):e[n]=t[n]);return e}function u(t,e){var n,r,a,o,i=Object.getOwnPropertyNames(t);for(void 0===e&&(e={}),n=0,r=i.length;r>n;n+=1)a=i[n],o=Object.getOwnPropertyDescriptor(t,a),o?Object.defineProperty(e,a,o):e[a]=t[a];return e}function s(t,e){var n,r;if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(n=0,r=t.length;r>n;n+=1){if(Array.isArray(t[n])&&Array.isArray(e[n])&&arraysAreEqual(t[n],e[n])!==!0)return!1;if(t[n]!==e[n])return!1}return!0}function l(t){var e=this,n=e[t];return function(){return n.apply(e,arguments)}}function c(t,e){"function"==typeof e&&(void 0===X&&(X=[]),t=t.replace(/[^0-9a-zA-Z_]/,""),X.push({name:t,func:e}))}function d(t){return t.hostURL()+(j.config&&j.config.solarUserPath?j.config.solarUserPath:"/solaruser")+"/api/v1/sec"}function f(t,e){"function"==typeof e&&(void 0===K&&(K=[]),t=t.replace(/[^0-9a-zA-Z_]/,""),K.push({name:t,func:e}))}function p(t){return d(this)+"/instr/view?id="+encodeURIComponent(t)}function m(){return d(this)+"/instr/viewActive?nodeId="+this.nodeId}function v(){return d(this)+"/instr/viewPending?nodeId="+this.nodeId}function g(t,e){return d(this)+"/instr/updateState?id="+encodeURIComponent(t)+"&state="+encodeURIComponent(e)}function h(t,e){var n=d(this)+"/instr/add?nodeId="+this.nodeId+"&topic="+encodeURIComponent(t);if(Array.isArray(e)){var r,a;for(r=0,a=e.length;a>r;r++)n+="&"+encodeURIComponent("parameters["+r+"].name")+"="+encodeURIComponent(e[r].name)+"&"+encodeURIComponent("parameters["+r+"].value")+"="+encodeURIComponent(e[r].value)}return n}function y(t,e,n,r,a){var o,i,u,s,l,c,d,f,p=t.length,m=n.length,v=r.length;if(o=t[0].values.length,o>0){for(f=[],i=0;o>i;i+=1){if(l=t[0].values[i],d={},void 0!==a)for(c in a)a.hasOwnProperty(c)&&(d[c]=a[c]);for(s=0;m>s;s+=1)d[n[s]]=l[n[s]];for(s=0;v>s;s+=1)d[r[s]]=0;for(u=0;p>u;u+=1)for(s=0;v>s;s+=1)c=t[u].values[i][r[s]],void 0!==c&&(d[r[s]]+=c);f.push(d)}t=[{key:e,values:f}]}return t}function x(t){if(t){if(t.date)return t.date;if(t.localDate)return j.format.dateTimeFormat.parse(t.localDate+(t.localTime?" "+t.localTime:" 00:00"));if(t.created)return j.format.timestampFormat.parse(t.created)}return null}function b(){j.config.debug===!0&&void 0!==console&&console.log(j.format.fmt.apply(this,arguments))}function C(t,n,r){function a(t,e){var n=t.utc.ceil(e);return n.getTime()===e.getTime()&&(n=t.offset(n,1)),n}function o(t){var e;return e=isNaN(Number(n))?void 0!==n[t]?Number(n[t]):1:n,"number"!=typeof e&&(e=1),e}function i(t){var e=10;return 0===t.search(/^Five/)?e=5:0===t.search(/^Fifteen/)&&(e=15),e}var u,s,l,c,d;return t.search(/Minute$/)>=0?(c=o("numHours"),l="hour",u=a(e.time.minute,r),d=i(t),u.setUTCMinutes(u.getUTCMinutes()+d-u.getUTCMinutes()%d,0,0),s=e.time.hour.utc.offset(u,-c)):"Month"===t?(c=o("numYears"),l="year",u=a(e.time.month,r),s=e.time.year.utc.offset(e.time.month.utc.floor(r),-c)):"Day"===t?(c=o("numMonths"),l="month",u=a(e.time.day,r),s=e.time.month.utc.offset(e.time.day.utc.floor(r),-c)):(c=o("numDays"),l="day",u=a(e.time.hour,r),s=e.time.day.utc.offset(e.time.hour.utc.floor(u),-c)),{start:s,end:u,timeUnit:l,timeCount:c}}function T(t,n,r){var a,o,i,u,s,l=0,c=t.length-1;if(c>0)for(;l<e.max(t.map(function(t){return t.values.length}));){for(i=void 0,a=0;c>=a;a++)if(!(t[a].values.length<=l)&&(o=c>a?a+1:0,t[o].values.length<=l||t[a].values[l].date.getTime()<t[o].values[l].date.getTime())){if(i={date:t[a].values[l].date,sourceId:t[o].key},n)for(u in n)n.hasOwnProperty(u)&&(i[u]=n[u]);r&&(s=t[o].values.length>l?l:l>0?l-1:null,r(i,t[o].key,null!==s?t[o].values[s]:void 0)),t[o].values.splice(l,0,i)}void 0===i&&l++}}function k(t,r){function a(e){var n,r,a=0;for(a=0;a<e.length;a+=1)r=e[a],void 0!==r.data&&void 0!==r.data.endDate?(r=r.data,void 0===n?n=r:(r.endDateMillis>n.endDateMillis&&(n.endDateMillis=r.endDateMillis,n.endDate=r.endDate),r.startDateMillis<n.startDateMillis&&(n.startDateMillis=r.startDateMillis,n.startDate=r.startDate))):j.log("No data available for {0} sources {1}",i[a].keyDescription(),t[a].sourceIds.join(","));return n}var o=n(),i=[];!function(){var n,r,a;for(n=0;n<t.length;n+=1)a=t[n].nodeUrlHelper?t[n].nodeUrlHelper:t[n].locationUrlHelper?t[n].locationUrlHelper:t[n].urlHelper,a&&a.reportableIntervalURL&&(i.push(a),r=a.reportableIntervalURL(t[n].sourceIds),o.defer(e.json,r))}(),o.awaitAll(function(t,e){if(t)return void j.log("Error requesting available data range: "+t);var n=a(e);void 0!==n.startDateMillis&&(n.sDate=new Date(n.startDateMillis)),void 0!==n.endDateMillis&&(n.eDate=new Date(n.endDateMillis)),"function"==typeof r&&r(n)})}function D(t,n){if(t&&t.availableSourcesURL&&n){var r=t.availableSourcesURL();e.json(r,function(t,e){var a;t?n(t):e?e.success!==!0?n(e.message?e.message:"Query not successful."):(a=Array.isArray(e.data)?e.data.sort():[],a.sort(),n(null,a)):n("No data returned from "+r)})}}function I(t,e){"function"==typeof e&&(void 0===_&&(_=[]),t=t.replace(/[^0-9a-zA-Z_]/,""),_.push({name:t,func:e}))}function A(t){if(void 0!==t){var n=e.select(t).style("width");if(!n)return null;var r=n.match(/([0-9.]+)px/);if(null===r)return null;var a=Math.floor(r[1]);return isNaN(a)?null:a}}function w(t){return t.getUTCMonth()<2||11===t.getUTCMonth()?3:t.getUTCMonth()<5?0:t.getUTCMonth()<8?1:2}function M(t){return t*Math.PI/180}function P(t){return 180*t/Math.PI}function R(t,n){var r,a,o,i=e.scale.ordinal().range(t),u=n.map(function(t,e){return{source:t,color:i(e)}});for(r=0,a=u.length;a>r;r+=1)o=u[r].source,""===o&&(o="Main"),isNaN(Number(o))&&(u[o]=u[r].color);return u}function U(t){var e=Number(t.source);return isNaN(e)?j.runtime.colorData[t.source]:j.runtime.colorData.reduce(function(e,n){return n.source===t.source?n.color:e},j.runtime.colorData[0].color)}function O(e,n){function r(t){e[t].forEach(function(e){var n;n=""===e||"Main"===e?s(t):s(t)+" / "+l(t,e),f[t][e]=n,"Main"===e&&(f[t][""]=n),v.push(n),p.push(n),h[n]={dataType:t,source:e,display:n}})}var a,o,i,u,s,l,c,d=n||{},f={},p=[],m=[],v=[],g={},h={};s="function"==typeof d.displayDataType?d.displayDataType:function(t){return"Power"===t?"Generation":t},l="function"==typeof d.displaySource?d.displaySource:function(t,e){return e},c="function"==typeof d.displayColor?d.displayColor:function(e){return"Consumption"===e?t.Blues:t.Greens};for(a in e)e.hasOwnProperty(a)&&(f[a]={},v.length=0,r(a),o=c(a),i=void 0===o[v.length]?function(){var t;for(t=v.length;30>t;t+=1)if(void 0!==o[t])return t;return 0}():v.length,u=o[i].slice(-v.length),d.reverseColors!==!1&&u.reverse(),m=m.concat(u));var y,x,b={};for(a in f)if(f.hasOwnProperty(a)){b[a]={},x=f[a];for(y in x)x.hasOwnProperty(y)&&(b[x[y]]=y)}return g.sourceList=p,g.displaySourceMap=f,g.reverseDisplaySourceMap=b,g.colorMap=j.color.map(m,p),g.displaySourceObjects=h,g}function N(){var t=0,e=function(){return t};return e.incrementAndGet=function(){return t+=1},e}function L(t){var e=1,n=Number(t);return isNaN(n)===!1&&(t>=1e9?e=1e9:t>=1e6?e=1e6:t>=1e3&&(e=1e3)),e}function F(t,e){return(1e9===e?"G":1e6===e?"M":1e3===e?"k":"")+t}function S(){if(arguments.length){var t,e,n=0,r=arguments[n];for(n=1;n<arguments.length;n+=1)t=new RegExp("\\{"+(n-1)+"\\}","gi"),e=arguments[n],e instanceof Date&&(e=0===e.getUTCHours()&&0===e.getMinutes()?j.format.dateFormat(e):j.format.dateTimeFormatURL(e)),r=r.replace(t,e);return r}}function E(t){function e(t,e){i.length&&(i+="&"),i+=encodeURIComponent(t)+"="+encodeURIComponent(e)}var n,r,a,o,i="";if(t)for(n in t)if(t.hasOwnProperty(n))if(r=t[n],Array.isArray(r))for(a=0,o=r.length;o>a;a++)e(n,r[a]);else e(n,r);return i}function H(t,n,r,a){var o=e.select(t).selectAll("table").data([0]);o.enter().append("table").append("tbody");var i=o.select("tbody").selectAll("tr").data(n),u=i.enter().append("tr");i.exit().remove(),r&&u.on("click",r).classed("clickable",!0),void 0===a&&(a=function(t){t.text(Object)});var s=i.selectAll("td.swatch").data(function(t){return[t.color]}).style("background-color",Object);s.enter().append("td").attr("class","swatch").style("background-color",Object),s.exit().remove();var l=i.selectAll("td.desc").data(function(t){return[""===t.source?"Main":t.source]}).call(a);l.enter().append("td").attr("class","desc").call(a),l.exit().remove()}var j={version:"0.9.4"};j.api={};var B=e.time.format.utc("%Y-%m-%d %H:%M:%S.%LZ");j.api.control={},j.api.user={},j.api.node={};var z=function(){return"undefined"!=typeof self?self:"undefined"!=typeof z?z:new Function("return this")()}();j.net={},j.net.parseURLQueryTerms=r;var G={debug:!1,host:"data.solarnetwork.net",tls:function(){return void 0!==z&&void 0!==z.locaion&&void 0!==z.location.protocol&&0===z.location.protocol.toLowerCase().indexOf("https")?!0:!1}(),path:"/solarquery",solarUserPath:"/solaruser",secureQuery:!1};j.env=G,j.setEnv=o,j.setDefaultEnv=a,void 0!==z&&void 0!==z.location&&void 0!==z.location.search&&o(r(z.location.search)),j.config={debug:!1,host:"data.solarnetwork.net",tls:function(){return void 0!==z&&void 0!==z.locaion&&void 0!==z.location.protocol&&0===z.location.protocol.toLowerCase().indexOf("https")?!0:!1}(),path:"/solarquery",solarUserPath:"/solaruser",secureQuery:!1},j.util={arraysAreEqual:s,copy:i,copyAll:u,superMethod:l},j.api.node.registerUrlHelperFunction=c;var X;j.api.node.nodeUrlHelper=function(t,e){function n(){return"http"+(f.tls===!0?"s":"")+"://"+f.host}function r(){return n()+f.path+"/api/v1/"+(f.secureQuery===!0?"sec":"pub")}function a(t){var e=r()+"/range/interval?nodeId="+d;return Array.isArray(t)&&(e+="&"+t.map(function(t){return"sourceIds="+encodeURIComponent(t)}).join("&")),e}function o(t,e){var n=r()+"/range/sources?nodeId="+d;return void 0!==t&&(n+="&start="+encodeURIComponent(j.format.dateFormat(t))),void 0!==e&&(n+="&end="+encodeURIComponent(j.format.dateFormat(e))),n}function i(t,e,n,a,o){var i=r()+"/datum/list?nodeId="+d;return t&&(i+="&startDate="+encodeURIComponent(j.format.dateTimeFormatURL(t))),e&&(i+="&endDate="+encodeURIComponent(j.format.dateTimeFormatURL(e))),n&&(i+="&aggregate="+encodeURIComponent(n)),Array.isArray(a)&&a.length>0&&(i+="&"+a.map(function(t){return"sourceIds="+encodeURIComponent(t)}).join("&")),void 0!==o&&(o.max>0&&(i+="&max="+encodeURIComponent(o.max)),o.offset>0&&(i+="&offset="+encodeURIComponent(o.offset))),i}function u(t){var e=r()+"/datum/mostRecent?nodeId="+d;return Array.isArray(t)&&(e+="&"+t.map(function(t){return"sourceIds="+encodeURIComponent(t)}).join("&")),e}function s(t){return arguments.length?(d=t,c):d}function l(){return"node "+d}var c={version:"1.1.0"},d=t,f=j.util.copy(e,{host:"data.solarnetwork.net",tls:!0,path:"/solarquery",secureQuery:!1});return Object.defineProperties(c,{secureQuery:{get:function(){return f.secureQuery===!0},enumerable:!0},keyDescription:{value:l},nodeId:{get:function(){return d},enumerable:!0},nodeID:{value:s},hostURL:{value:n},baseURL:{value:r},reportableIntervalURL:{value:a},availableSourcesURL:{value:o},dateTimeListURL:{value:i},mostRecentURL:{value:u}}),function(){Array.isArray(X)&&X.forEach(function(t){c.hasOwnProperty(t.name)===!1&&Object.defineProperty(c,t.name,{value:function(){return t.func.apply(c,arguments)}})})}(),c},j.api.user.registerUrlHelperFunction=f;var K;j.api.user.userUrlHelper=function(t){function e(){return"http"+(i.tls===!0?"s":"")+"://"+i.host}function n(){return e()+i.path+"/api/v1/"+(i.secureQuery===!0?"sec":"pub")}function r(){return"user"}function a(){var t=n()+"/nodes";return t}var o={version:"1.0.0"},i=j.util.copy(t,{host:"data.solarnetwork.net",tls:!0,path:"/solaruser",secureQuery:!0});return Object.defineProperties(o,{keyDescription:{value:r},hostURL:{value:e},baseURL:{value:n},viewNodesURL:{value:a}}),function(){Array.isArray(K)&&K.forEach(function(t){o.hasOwnProperty(t.name)===!1&&Object.defineProperty(o,t.name,{value:function(){return t.func.apply(o,arguments)}})})}(),o},c("viewInstruction",p),c("viewActiveInstructionsURL",m),c("viewPendingInstructionsURL",v),c("updateInstructionStateURL",g),c("queueInstructionURL",h),j.api.control.toggler=function(t){function r(t){if(void 0!==v)try{v.call(g,t)}catch(e){j.log("Error in callback: {0}",e)}}function a(t){if(Array.isArray(t)&&0!==t.length){var e=t.reduce(function(t,e){return"SetControlParameter"===e.topic&&Array.isArray(e.parameters)&&e.parameters.length>0&&e.parameters[0].name===x&&(void 0===t||t.created<e.created)?e:t},void 0);return void 0!==e&&j.log("Active instruction for {3} found in state {0} (set control {1} to {2})",e.state,x,e.parameters[0].value,b.keyDescription()),e}}function o(){return void 0===p?void 0:p.state}function i(){return void 0===p?void 0:Number(p.parameters[0].value)}function u(){return["Queued","Received","Executing"].indexOf(o())<0?h:y}function s(t){if(!arguments.length)return void 0===f?void 0:f.val;var e=n(),a=void 0===f?void 0:f.val,s=o(),l=i();return"Queued"===s&&l!==t&&(j.log("Canceling {2} pending control {0} switch to {1}",x,l,b.keyDescription()),e.defer(C.json,b.updateInstructionStateURL(p.id,"Declined"),"POST"),p=void 0,s=void 0,l=void 0),a!==t&&l!==t&&(j.log("Request {2} to change control {0} to {1}",x,t,b.keyDescription()),e.defer(C.json,b.queueInstructionURL("SetControlParameter",[{name:x,value:String(t)}]),"POST")),e.awaitAll(function(t,e){if(t)return j.log("Error updating {2} control toggler {0}: {1}",x,t.status,b.keyDescription()),void r(t);if(!(e.length<1)){var n=e[0];null==n.data&&n.success===!0&&(p=void 0);var a=e[e.length-1].data;null!=a&&(p=a),r(),d&&(g.stop(),g.start(u()))}}),g}function l(t,e){var n,r;return e&&"Declined"!==e.status?t?(n=B.parse(t.created),r=B.parse(e.created),n.getTime()>r.getTime()?t.val:Number(e.parameters[0].value)):Number(e.parameters[0].value):t?t.val:void 0}function c(){var t=n();return t.defer(b.secureQuery?C.json:e.json,b.mostRecentURL([x])),C.hasTokenCredentials()===!0&&(t.defer(C.json,b.viewPendingInstructionsURL(),"GET"),p&&["Completed","Declined"].indexOf(o())<0&&t.defer(C.json,b.viewInstruction(p.id))),t.await(function(t,e,n,o){if(t)j.log("Error querying control toggler {0} for {2} status: {1}",x,t.status,b.keyDescription()),r(t);else{var i,v,g=void 0;if(e.data&&Array.isArray(e.data.results))for(i=0,v=e.data.results.length;v>i&&void 0===g;i++)e.data.results[i].sourceId===x&&(g=e.data.results[i]);var h=o?o.data:void 0,y=n?a(n.data):void 0,T=l(g,h?h:y?y:p),k=s();(T!==k||m!==C.hasTokenCredentials())&&(j.log("Control {0} for {1} value is currently {2}",x,b.keyDescription(),void 0!==T?T:"N/A"),f=g,f&&!y&&(f.val=T),p=h?h:y,m=C.hasTokenCredentials(),r())}void 0!==d&&(d=setTimeout(c,u()))}),g}var d,f,p,m,v,g={version:"1.3.0"},h=2e4,y=5e3,x="/power/switch/1",b=t,C=j.net.sec;return g.start=function(t){return void 0===d&&(d=setTimeout(c,t||20)),g},g.stop=function(){return void 0!==d&&(clearTimeout(d),d=void 0),g},g.controlID=function(t){return arguments.length?(x=t,g):x},g.refreshMs=function(t){return arguments.length?("number"==typeof t&&(h=t),g):h},g.pendingRefreshMs=function(t){return arguments.length?("number"==typeof t&&(y=t),g):y},g.nodeUrlHelper=function(t){return arguments.length?(b=t,g):b},g.callback=function(t){return arguments.length?("function"==typeof t&&(v=t),g):v},Object.defineProperties(g,{pendingInstructionState:{value:o},pendingInstructionValue:{value:i},lastKnownInstructionState:{value:o},lastKnownInstructionValue:{value:i},value:{value:s}}),g},j.api.datum={},j.api.datum.aggregateNestedDataLayers=y,j.format={},j.format.dateTimeFormat=e.time.format.utc("%Y-%m-%d %H:%M"),j.format.timestampFormat=e.time.format.utc("%Y-%m-%d %H:%M:%S.%LZ"),j.format.dateTimeFormatLocal=e.time.format("%Y-%m-%d %H:%M"),j.format.dateTimeFormatURL=e.time.format.utc("%Y-%m-%dT%H:%M"),j.format.dateFormat=e.time.format.utc("%Y-%m-%d"),j.api.datum.datumDate=x,j.log=b,j.api.datum.loader=function(t,n,r,a,o){function i(t){return"function"==typeof t&&(c=t),p=1,s(),i}function u(t){p=2,c&&c.call(l,t,f)}function s(i){var l,c,p,m={};i&&(m.offset=i),l=n.dateTimeListURL(r,a,o,t,m),d&&!function(){var t=E(d);t.length&&(l+="&"+t)}(),c=function(t){return t.success===!0&&void 0!==t.data&&Array.isArray(t.data.results)===!0?t.data.results:void 0},p=function(t){return t.data.returnedResultCount+t.data.startingOffset<t.data.totalResults?t.data.returnedResultCount+t.data.startingOffset:0},e.json(l,function(t,e){var r,a;return t?void j.log("Error requesting data for {0}: {2}",n.keyDescription(),t):(r=c(e),void 0===r?(j.log("No data available for {0}",n.keyDescription()),void u(t)):(f=void 0===f?r:f.concat(r),a=p(e),void(a>0?s(a):u(t))))})}var l=i;l.version="1.0.0";var c,d,f,p=0;return l.callback=function(t){return arguments.length?("function"==typeof t&&(c=t),l):c},l.urlParameters=function(t){return arguments.length?("object"==typeof t&&(d=t),l):d},l.load=i,l},j.api.datum.loaderQueryRange=C,j.api.datum.multiLoader=function(t){function e(e){return"function"==typeof e&&(a=e),t.forEach(function(t){o.defer(t.load)}),o.awaitAll(function(t,e){a&&a.call(r,t,e)}),r}var r=e;r.version="1.0.0";var a,o=n();return r.callback=function(t){return arguments.length?("function"==typeof t&&(a=t),r):a},r.load=e,r},j.api.datum.nestedStackDataNormalizeByDate=T,j.api.datum.sumCounter=function(t){function e(t){var e=0;return t.forEach(function(t){var n=Number(t[c]);isNaN(n)&&(n=0),e+=n}),e}function n(n){j.api.datum.loader(l,t,null,null,"RunningTotal").callback(function(t,r){var a=t?0:e(r);f=a,n()}).load()}function r(){function t(){i&&i.call(s,f),void 0!==u&&(u=setTimeout(r,d))}n(t)}function a(){return void 0===u?(u=setTimeout(r,20),s):void 0}function o(){return void 0!==u?(clearTimeout(u),u=void 0,s):void 0}var i,u,s={version:"1.1.0"},l=["Main"],c="wattHours",d=6e4,f=0;return s.callback=function(t){return arguments.length?("function"==typeof t&&(i=t),s):i},s.sourceIds=function(t){return arguments.length?(Array.isArray(t)?l=t:"string"==typeof t&&(l=t.split(/\s*,\s*/)),s):l},Object.defineProperties(s,{start:{value:a},stop:{value:o}}),s},j.api.node.availableDataRange=k,j.api.node.availableSources=D,j.api.loc={},j.api.loc.registerUrlHelperFunction=I;var _;return j.api.loc.locationUrlHelper=function(t,e){function n(){return"http"+(f.tls===!0?"s":"")+"://"+f.host}function r(){return n()+f.path+"/api/v1/"+(f.secureQuery===!0?"sec":"pub")}function a(t){var e=r()+"/location/datum/interval?locationId="+d;return Array.isArray(t)&&(e+="&"+t.map(function(t){return"sourceIds="+encodeURIComponent(t)}).join("&")),e}function o(t,e){var n=r()+"/location/datum/sources?locationId="+d;return void 0!==t&&(n+="&start="+encodeURIComponent(j.format.dateFormat(t))),void 0!==e&&(n+="&end="+encodeURIComponent(j.format.dateFormat(e))),n}function i(t,e,n,a,o){var i=r()+"/location/datum/list?locationId="+d;return t&&(i+="&startDate="+encodeURIComponent(j.format.dateTimeFormatURL(t))),e&&(i+="&endDate="+encodeURIComponent(j.format.dateTimeFormatURL(e))),n&&(i+="&aggregate="+encodeURIComponent(n)),Array.isArray(a)&&(i+="&"+a.map(function(t){return"sourceIds="+encodeURIComponent(t)}).join("&")),void 0!==o&&(o.max>0&&(i+="&max="+encodeURIComponent(o.max)),o.offset>0&&(i+="&offset="+encodeURIComponent(o.offset))),i}function u(t){var e=r()+"/location/datum/mostRecent?locationId="+d;return Array.isArray(t)&&(e+="&"+t.map(function(t){return"sourceIds="+encodeURIComponent(t)}).join("&")),e}function s(t){return arguments.length?(d=t,c):d}function l(){return"node "+nodeId}var c={version:"1.0.0"},d=t,f=j.util.copy(e,{host:"data.solarnetwork.net",tls:!0,path:"/solarquery",secureQuery:!1});return Object.defineProperties(c,{keyDescription:{value:l},locationId:{get:function(){return d},enumerable:!0},locationID:{value:s},hostURL:{value:n},baseURL:{value:r},reportableIntervalURL:{value:a},availableSourcesURL:{value:o},dateTimeListURL:{value:i},mostRecentURL:{value:u}}),function(){Array.isArray(_)&&_.forEach(function(t){c.hasOwnProperty(t.name)===!1&&Object.defineProperty(c,t.name,{value:function(){return t.func.apply(c,arguments)}})})}(),c},j.chart={},j.Configuration=function(t){if(this.map={},void 0!==t){var e=this;!function(){var n,r=function(t){return function(){return e.map[t]}},a=function(t){return function(n){e.map[t]=n}};for(n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:r(n),set:a(n)}),e.map[n]=t[n]}()}},j.Configuration.prototype={enabled:function(t){return void 0===t?!1:void 0!==this.map[t]},toggle:function(t,e){var n=e;return void 0===t?this:(void 0===n&&(n=void 0===this.map[t]),this.value(t,n===!0?!0:null))},value:function(t,e){var n=this;return 1===arguments.length?this.map[t]:(null===e?(delete this.map[t],this.hasOwnProperty(t)&&delete this[t]):(this.map[t]=e,this.hasOwnProperty(t)||Object.defineProperty(this,t,{enumerable:!0,configurable:!0,get:function(){return n.map[t]},set:function(e){n.map[t]=e}})),this)}},j.ui={},j.ui.pixelWidth=A,j.chart.baseTimeChart=function(t,n){function r(t,e,n){var r=j.tapEventNames[t];r&&(e.on(r)||e.on(r,n),tt[r]+=1)}function a(t,e,n){var r=j.tapEventNames[t];r&&(tt[r]-=1,tt[r]<1&&e.on(r,null))}function o(){var t=e.event,n=(new Date).getTime(),r=n-et.time,a=this;et.time=n,"dblclick"===t.type||j.hasTouchSupport&&500>r?(et.timer&&(clearTimeout(et.timer),delete et.timer),dt.call(a)):j.hasTouchSupport?(et.timer=setTimeout(function(){var n=e.event;try{e.event=t,ct.call(a)}finally{e.event=n}},500),t.preventDefault()):ct.call(a)}function i(){L.aggregate(H.aggregate),L.plotProperties(H.value("plotProperties")),D=H.value("transitionMs")||600,I=H.value("ruleOpacity")||.1,A=H.value("vertRuleOpacity")||.05}function u(){var t,n=e.max(_.domain(),function(t){return Math.abs(t)});nt=1,W?nt=W.call(F,n):n>=1e9?nt=1e9:n>=1e6?nt=1e6:n>=1e3&&(nt=1e3),t=1===nt?",d":",g",rt=e.format(t)}function s(t){return rt(t/nt)}function l(){return k[T]}function c(){return k[T]+"Reverse"}function d(){u()}function f(t){return"translate(0,"+(Math.round(_(t)+.5)-.5)+")"}function p(t){return 0===t?"origin":"m"}function m(t){return 0===t?"origin":null}function v(t){return T.indexOf("Minute")>=0&&0===t.getUTCHours()||"Hour"===T&&0===t.getUTCHours()||"Day"===T&&1===t.getUTCDate()||"Month"===T&&0===t.getUTCMonth()}function g(){return K.ticks(at)}function h(){var t=K.tickFormat(at);return function(e,n){return q?q.call(F,e,n,K,t):t(e,n)}}function y(){e.event&&e.event.transform&&e.event.transform(K);var t=g(),n=h(),r=M.selectAll("text").data(t).classed({major:v});r.transition().duration(D).attr("x",K).text(n),r.enter().append("text").attr("dy","-0.5em").style("opacity",1e-6).attr("x",K).classed({major:v}).transition().duration(D).style("opacity",1).text(n).each("end",function(){e.select(this).style("opacity",null)}),r.exit().transition().duration(D).style("opacity",1e-6).remove()}function x(){return _.ticks(ot)}function b(){var t=x(),n=w.select("g.rule").selectAll("g").data(t,Object),r=n.transition().duration(D);r.attr("transform",f).select("text").text(s).attr("class",m),r.select("line").attr("class",p),n.exit().transition().duration(D).style("opacity",1e-6).remove();var a=n.enter().append("g").style("opacity",1e-6).attr("transform",f);a.append("line").attr("x2",G+z[3]).attr("x1",z[3]).attr("class",p),a.append("text").attr("x",z[3]-10).text(s).attr("class",m),a.transition().duration(D).style("opacity",1).each("end",function(){e.select(this).style("opacity",null)})}function C(){return O||(O=w.append("g").attr("class","hover-root").attr("transform","translate("+z[3]+","+z[0]+")"),N=w.append("rect").attr("width",G).attr("height",X).attr("fill","none").attr("pointer-events","all").attr("class","pointer-capture").attr("transform","translate("+z[3]+","+z[0]+")")),N}var T,k,D,I,A,w,M,P,R,U,O,N,L={version:"1.0.0"},F=L,S="__internal__",E=["FiveMinute","TenMinute","FifteenMinute","Hour","HourOfDay","SeasonalHourOfDay","Day","DayOfWeek","SeasonalDayOfWeek","Month"],H=n||new j.Configuration,B=j.ui.pixelWidth(t),z=H.padding||[10,0,20,30],G=(H.width||B||812)-z[1]-z[3],X=(H.height||300)-z[0]-z[2],K=e.time.scale.utc().range([0,G]),_=e.scale.linear().range([X,0]),W=void 0,Y=void 0,q=void 0,Q=void 0,V=void 0,Z=void 0,J=void 0,$=void 0,tt=function(){var t={};return Object.keys(j.tapEventNames).forEach(function(e){t[j.tapEventNames[e]]=0}),t}(),et={time:0},nt=1,rt=e.format(",d"),at=12,ot=5,it=function(){y(),b()},ut=function(){Q&&Q.call(F,O,j.tapCoordinates(this))},st=function(){V&&V.call(F,O,j.tapCoordinates(this))},lt=function(){Z&&Z.call(F,O,j.tapCoordinates(this))},ct=function(){clickCallback&&clickCallback.call(F,O,j.tapCoordinates(this))},dt=function(){$&&$.call(F,O,j.tapCoordinates(this))};return w=e.select(t),w.node()&&"svg"!==w.node().tagName.toLowerCase()&&(w=w.select("svg"),w.empty()&&(w=e.select(t).append("svg:svg")),w.attr("class","chart").attr("width",G+z[1]+z[3]).attr("height",X+z[0]+z[2]).selectAll("*").remove()),P=w.append("g").attr("class","data-root").attr("transform","translate("+z[3]+","+z[0]+")"),M=w.append("g").attr("class","ticks").attr("transform","translate("+z[3]+","+(X+z[0]+z[2])+")"),w.append("g").attr("class","crisp rule").attr("transform","translate(0,"+z[0]+")"),R=w.append("g").attr("class","rule").attr("transform","translate("+z[3]+","+z[0]+")"),U=w.append("g").attr("class","annot-root").attr("transform","translate("+z[3]+","+z[0]+")"),L.scaleDate=function(t){return K(t)},L.scaleValue=function(t){return _(t)},L.xDomain=function(){return K.domain()},L.yDomain=function(){return _.domain()},L.yScale=function(){return W?W():nt},L.aggregate=function(t){if(!arguments.length)return T;var e=E.indexOf(t);return T=0>e?"Hour":t,F},L.aggregateNormalizedDuration=function(){return"FiveMinute"===T?3e5:"TenMinute"===T?6e5:"FifteenMinute"===T?9e5:"Hour"===T||"HourOfDay"===T||"SeasonalHourOfDay"===T?36e5:"Day"===T||"DayOfWeek"===T||"SeasonalDayOfWeek"===T?864e5:"Month"===T?2592e6:6e4},L.isNormalizedDuration=function(t,n){var r,a,o=L.aggregateNormalizedDuration();return t&&n?(r=Math.abs(n.getTime()-t.getTime()),r===o?!0:(n.getTime()<t.getTime()&&(a=t,t=n,n=a),"Month"===T?e.time.month.utc.offset(t,1).getTime()===n.getTime():"SeasonalHourOfDay"===T?(a=t.getUTCHours()+1,a>23&&(a=0),n.getUTCHours()===a&&t.getTime()!==n.getTime()):"SeasonalDayOfWeek"===T?(a=t.getUTCDay()+1,a>6&&(a=0),n.getUTCDay()===a&&t.getTime()!==n.getTime()):!1)):!1},L.addNormalizedDuration=function(t){return t?"Month"===T?e.time.month.utc.offset(t,1):new Date(t.getTime()+L.aggregateNormalizedDuration()):void 0},L.reset=function(){return O&&lt(),F},L.regenerate=function(){return i(),L.setup(),L.draw(),Y&&Y.call(F,U),F},L.transitionMs=function(t){return arguments.length?(D=+t,F):D},L.plotProperties=function(t){if(!arguments.length)return k;var e={};return E.forEach(function(n){e[n]=void 0!==t&&void 0!==t[n]?t[n]:"watts"}),k=e,F},L.displayFactorCallback=function(t){return arguments.length?(W="function"==typeof t?t:void 0,F):W},L.drawAnnotationsCallback=function(t){return arguments.length?(Y="function"==typeof t?t:void 0,F):Y},L.hoverEnterCallback=function(t){if(!arguments.length)return Q;var e=C();return"function"==typeof t?(Q=t,e.on("mouseover",ut)):(Q=void 0,e.on("mouseover",null)),F},L.hoverMoveCallback=function(t){if(!arguments.length)return V;var e=C();return"function"==typeof t?(C(),V=t,e.on("mousemove",st)):(V=void 0,e.on("mousemove",null)),F},L.hoverLeaveCallback=function(t){if(!arguments.length)return Z;var e=C();return"function"==typeof t?(Z=t,e.on("mouseout",lt)):(Z=void 0,e.on("mouseout",null)),F},L.doubleClickCallback=function(t){if(!arguments.length)return $;var e=C();return"function"==typeof t?($=t,r("dblclick",e,o)):($=void 0,a("dblclick",e,o)),F},L.rangeSelectionCallback=function(t){if(!arguments.length)return J;var e=C();return"function"==typeof t?(J=t,r("click",e,o)):(J=void 0,a("click",e,o)),F},L.xAxisTickCallback=function(t){return arguments.length?("function"==typeof t&&(q=t),F):q},L.ruleOpacity=function(t){return arguments.length?(I=t,F):I},L.vertRuleOpacity=function(t){return arguments.length?(A=t,F):A},Object.defineProperties(L,{me:{get:function(){return F},set:function(t){F=t}},x:{get:function(){return K},set:function(t){K=t}},y:{get:function(){return _},set:function(t){_=t}},xAxisTickCount:{get:function(){return at},set:function(t){at=t}},xAxisTicks:{get:function(){return g},set:function(t){g=t}},xAxisTickFormatter:{get:function(){return h},set:function(t){h=t}},yAxisTicks:{get:function(){return x},set:function(t){x=t}},yAxisTickCount:{get:function(){return ot},set:function(t){ot=t}},config:{value:H},internalPropName:{value:S},plotPropertyName:{get:l},plotReversePropertyName:{get:c},padding:{value:z},width:{value:G,enumerable:!0},height:{value:X,enumerable:!0},svgRoot:{value:w},svgDataRoot:{value:P},svgRuleRoot:{value:R},svgTickGroupX:{value:M},svgHoverRoot:{get:function(){return O}},handleHoverEnter:{get:function(){return ut},set:function(t){ut=t}},handleHoverMove:{get:function(){return st},set:function(t){st=t}},handleHoverLeave:{get:function(){return lt},set:function(t){lt=t}},handleClick:{get:function(){return ct},set:function(t){ct=t}},handleDoubleClick:{get:function(){return dt},set:function(t){dt=t}},computeUnitsY:{value:u},drawAxisX:{get:function(){return y},set:function(t){y=t}},drawAxisY:{get:function(){return b},set:function(t){b=t}},parseConfiguration:{get:function(){return i},set:function(t){i=t}},draw:{get:function(){return it},set:function(t){it=t}},setup:{get:function(){return d},set:function(t){d=t}}}),i(),L},j.chart.baseGroupedTimeChart=function(t,e){function n(t,e,n){return void 0===d?"black":d(t,e.sourceId,n)}function r(t){var e,n,r,a,o=i.plotPropertyName,u=i.plotReversePropertyName;for(n=0;n<t.length;n+=1)for(r=t[n].values,e=0;e<r.length-1;e+=1)i.isNormalizedDuration(r[e].date,r[e+1].date)!==!0&&(a=j.util.copy(r[e]),a.date=i.addNormalizedDuration(a.date),a[o]=null,a[u]=null,r.splice(e+1,0,a))}var a=j.chart.baseTimeChart(t,e),o=a.reset,i=u(a);i.me=i;var s={},l={},c=void 0,d=void 0,f=void 0,p=void 0,m=[],v={};return i.reset=function(){return o(),s={},m=[],v={},i.me},i.load=function(t,e){return void 0===s[e]?(m.push(e),s[e]=t):s[e]=s[e].concat(t),i.me},i.data=function(t){return s[t]},i.stash=function(t,e,n){return void 0===v[e]||n===!0?v[e]=t:v[e]=v[e].concat(t),i.me},i.stashedData=function(t){return v[t]},i.scaleFactor=function(t,e){var n;if(!arguments.length)return l;if(1===arguments.length){if("string"==typeof t)return n=l[t],void 0===n?1:n;l=t}else 2==arguments.length&&(l[t]=e);return i.me},i.dataCallback=function(t){return arguments.length?(c="function"==typeof t?t:void 0,i.me):c},i.colorCallback=function(t){return arguments.length?(d="function"==typeof t?t:void 0,i.me):d},i.sourceExcludeCallback=function(t){return arguments.length?(f="function"==typeof t?t:void 0,i.me):f},i.layerPostProcessCallback=function(t){return arguments.length?(p="function"==typeof t?t:void 0,i.me):p},Object.defineProperties(i,{fillColor:{value:n},insertNormalizedDurationIntoLayerData:{value:r},groupIds:{get:function(){return m}}}),i},j.color={},j.color.colors={steelblue:["#356287","#4682b4","#6B9BC3","#89AFCF","#A1BFD9","#B5CDE1","#DAE6F0"],triplets:["#3182bd","#6baed6","#9ecae1","#e6550d","#fd8d3c","#fdae6b","#31a354","#74c476","#a1d99b","#756bb1","#9e9ac8","#bcbddc","#843c39","#ad494a","#d6616b","#8c6d31","#bd9e39","#e7ba52","#7b4173","#a55194","#ce6dbd"],seasonColors:["#5c8726","#e9a712","#762123","#80a3b7"]
},j.format.seasonForDate=w,j.chart.baseGroupedSeasonalLineChart=function(t,n){function r(t,e){var n=p.config.seasonColors||j.color.colors.seasonColors,r=(e+(h?0:2))%4;return n[r]}function a(t){return new Date(Date.UTC(2001,0,1)+t)}function o(t){t.getTime()}function i(){return e.time.day.utc}function u(t){var e,n,r,o,i,u,s=null,l=null,c=null,d=t.length,f=!1;for(r=0;d>r;r+=1)e=t[r],o=e[p.internalPropName].groupId,p.sourceExcludeCallback()&&p.sourceExcludeCallback().call(p.me,o,e.sourceId)||(n=e[p.plotPropertyName],void 0!==n&&(f=x[o]===!0,f?c+=n:l+=n),e.date&&((void 0===i||e.date.getTime()<i.getTime())&&(i=e.date),(void 0===u||e.date.getTime()>u.getTime())&&(u=e.date)));return(null!==l||null!==c)&&(s=l-c),{date:a(t[0].timeKey),y:s,plus:l,minus:c,season:t[0].season,timeKey:t[0].timeKey,groupId:t[0][p.internalPropName].groupId}}function s(){var t=p.groupIds,n=[null,null],r=[0,0],a=i(),s=e.format("02g");y={},t.forEach(function(t){var a,i,l,c=p.data(t);!c||!c.length>1||(a=e.nest().key(function(e){return e.hasOwnProperty(p.internalPropName)||(e[p.internalPropName]={groupId:t},p.dataCallback()?p.dataCallback().call(p.me,t,e):void 0===e.date&&(e.date=j.api.datum.datumDate(e)),e.season=j.format.seasonForDate(e.date),e.timeKey=o(e.date)),e.season}).key(function(t){return s(t.timeKey)}).sortKeys(e.ascending).rollup(u).entries(c),a.length<1||(p.layerPostProcessCallback()&&(a=p.layerPostProcessCallback().call(p.me,t,a)),y[t]=a,i=a.reduce(function(t,e){return t.concat(e.values.map(function(t){return t.values}))},[]),l=e.extent(i,function(t){return t.y}),l[0]<r[0]&&(r[0]=l[0]),l[1]>r[1]&&(r[1]=l[1]),l=e.extent(i,function(t){return t.date.getTime()}),(null===n[0]||l[0]<n[0].getTime())&&(n[0]=new Date(l[0])),(null===n[1]||l[1]>n[1].getTime())&&(n[1]=new Date(l[1]))))}),p.x.domain(a.range(n[0],a.offset(n[1],1))),p.y.domain(r).nice(),p.computeUnitsY()}function l(t){return Math.round(p.x(t)+.5)-.5}function c(){var t=p.transitionMs(),n=p.svgRuleRoot.selectAll("line.vert").data(p.x.domain());n.transition().duration(t).attr("x1",l).attr("x2",l),n.enter().append("line").style("opacity",1e-6).classed("vert",!0).attr("x1",l).attr("x2",l).attr("y1",0).attr("y2",p.height).transition().duration(t).style("opacity",p.vertRuleOpacity()).each("end",function(){e.select(this).style("opacity",null)}),n.exit().transition().duration(t).style("opacity",1e-6).remove()}function d(){var t=[[],[],[],[]],e=p.groupIds;return e.forEach(function(e){var n=y[e];n&&n.forEach(function(e){var n=Number(e.key);t[n].push(e.values.map(function(t){return t.values}))})}),{groupedData:t}}function f(){var t,e,n,a=p.transitionMs();n=d(),t=p.svgDataRoot.selectAll("g.season").data(n.groupedData),t.enter().append("g").attr("class","season").style("stroke",r),e=t.selectAll("path.line").data(Object,function(t){return t[0].groupId}),e.transition().duration(a).attr("d",b),e.enter().append("path").classed("line",!0).attr("d",b),e.exit().transition().duration(a).style("opacity",1e-6).remove(),m(),c()}var p=j.chart.baseGroupedTimeChart(t,n),m=j.util.superMethod.call(p,"draw"),v=j.util.copyAll(p,{version:"1.0.0"});v.me=v;var g=["Midnight","1am","2am","3am","4am","5am","6am","7am","8am","9am","10am","11am","Noon","1pm","2pm","3pm","4pm","5pm","6pm","7pm","8pm","9pm","10pm","11pm"];p.x=e.scale.ordinal().rangePoints([0,p.width],.2),p.xAxisTicks=function(){return p.x.domain()},p.xAxisTickFormatter=function(){return function(t,e){return p.xAxisTickCallback()?xAxisTickCallback().call(p.me,t,e,p.x):g[p.x.domain().indexOf(t)]}};var h,y,x={Consumption:!0},b=e.svg.line().interpolate("monotone").x(function(t){return Math.round(p.x(t.date)+.5)-.5}).y(function(t){return Math.round(p.y(t.y)+.5)-.5});return v.northernHemisphere=function(t){if(!arguments.length)return h;if(t!==h)return h=t===!0,p.svgDataRoot.selectAll("g.season").transition().duration(p.transitionMs()).style("stroke",r),p.me},v.negativeGroupIds=function(t){return arguments.length?(x={},t.forEach(function(t){x[t]=!0}),p.me):function(){var t,e=[];for(t in x)x.hasOwnProperty(t)&&e.pus(t);return e}()},v.timeKeyLabels=function(t){return arguments.length?(Array.isArray(t)&&(g=t),p.me):g},Object.defineProperties(v,{dateForTimeKey:{get:function(){return a},set:function(t){a=t}},timeKeyForDate:{get:function(){return o},set:function(t){o=t}},timeKeyInterval:{get:function(){return i},set:function(t){i=t}}}),p.setup=s,p.draw=f,v},j.chart.baseGroupedStackTimeChart=function(t,n){function r(){d(),v=p.config.value("wiggle")===!0?"wiggle":"zero",g=p.config.value("reverseValueSupport")===!0?!0:!1}function a(t,e){var n=p.config.value("opacityReduction")||.1;return 1-e*n}function o(t){var n,r=p.plotReversePropertyName;return n="zero"!==v?e.layout.stack().offset(v).offset():function(e){var n,a,o,i,u,s=e[0].length,l=e.length,c=[];for(n=0;s>n;n+=1){for(o=0,a=0;l>a;a+=1)i=e[a][n][1],u=g?t[a].values[n][r]:0,0>i?(o+=i,e[a][n][1]=-i):u&&(o-=u);c[n]=o}return c}}function i(){var t,n,r,a,i=p.plotPropertyName,u=p.plotReversePropertyName,s=e.layout.stack().values(function(t){return t.values}).x(function(t){return t.date}).y(function(t){var e=t[i],n=0,r=l.scaleFactor(t[l.internalPropName].groupId);return void 0===e||null===e||"zero"!==v&&0>e?e=0:g&&"zero"===v&&void 0!==t[u]&&(n=t[u]),(e+n)*r});h={},p.groupIds.forEach(function(u){var c,d,f=p.data(u);if(f&&!(!f.length>1)&&(d=e.nest().key(function(t){return t.hasOwnProperty(p.internalPropName)||(t[p.internalPropName]={groupId:u},p.dataCallback()?p.dataCallback().call(p.me,u,t):void 0===t.date&&(t.date=j.api.datum.datumDate(t))),p.sourceExcludeCallback()&&p.sourceExcludeCallback().call(p.me,u,t.sourceId)?m:t.sourceId}).sortKeys(e.ascending).entries(f),d=d.filter(function(t){return t.key!==m}),!(d.length<1))){c={},c[i]=null,c[p.internalPropName]={groupId:u},j.api.datum.nestedStackDataNormalizeByDate(d,c),y===!0&&l.insertNormalizedDurationIntoLayerData(d),p.layerPostProcessCallback()&&(d=p.layerPostProcessCallback().call(p.me,u,d));var v=[f[0].date,f[f.length-1].date];(void 0===t||v[0].getTime()<t.getTime())&&(t=v[0]),(void 0===n||v[1].getTime()>n.getTime())&&(n=v[1]),s.offset(o(d));var g=s(d);h[u]=g;var x=[e.min(g[0].values,function(t){return t.y0}),e.max(g[g.length-1].values,function(t){return t.y0+t.y})];(void 0===r||x[0]<r)&&(r=x[0]),(void 0===a||x[1]>a)&&(a=x[1])}}),void 0!==t&&void 0!==n&&p.x.domain([t,n]),void 0!==r&&void 0!==a&&p.y.domain([r,a]).nice(),p.computeUnitsY()}function s(){return p.wiggle()===!0?[]:f()}var l=j.chart.baseGroupedTimeChart(t,n),c=l.reset,d=l.parseConfiguration,f=l.yAxisTicks,p=u(l);p.me=p;var m="__discard__",v=void 0,g=!0,h={},y=!1;return p.reset=function(){return c(),h={},p.me},p.stackOffset=function(t){return arguments.length?(v=t,p.me):v},p.wiggle=function(t){return arguments.length?p.stackOffset(t===!0?"wiggle":"zero"):"wiggle"===v},p.normalizeDataTimeGaps=function(t){return arguments.length?(y=t===!0,p.me):y},p.enumerateDataOverTime=function(t){if("function"!=typeof t)return p.me;var e,n=p.groupIds,r={},a=p.xDomain()[0];if(!n||n.length<1)return p.me;for(;;)if(e={date:a,data:{}},n.forEach(function(t){var n=h[t];void 0===r[t]&&(r[t]={index:0}),!n||n.length<1||n[0].values.length<=r[t].index||(void 0===r[t].date&&(r[t].date=n[0].values[0].date),n[0].values[r[t].index].date.getTime()===a.getTime()&&(n.forEach(function(n){e.data[n.key]=n.values[r[t].index]}),r[t].index+=1,r[t].date=r[t].index<n[0].values.length?n[0].values[r[t].index].date:null))}),t.call(p.me,e.data,a),a=r[n.reduce(function(t,e){var n=r[t].date,a=r[e].date;return n?a?a>n?t:e:t:e})].date,!a)break;return p.me},Object.defineProperties(p,{negativeOffsetFromReversePlotProperty:{get:function(){return g},set:function(t){g=t}},groupOpacityFn:{value:a},discardId:{value:m},groupLayers:{get:function(){return h}}}),r(),p.parseConfiguration=r,p.setup=i,p.yAxisTicks=s,p},j.chart.baseGroupedStackTimeBarChart=function(t,n){function r(t,e){return I.fillColor.call(this,t[0][I.internalPropName].groupId,t[0],e)}function a(){return I.config.vertRuleOpacity||.05}function o(){var t,n=I.x,r=I.aggregate(),a=n.domain(),o=1,i=a[1];"Month"===r?(i=e.time.month.utc.offset(i,1),t=e.time.months.utc):"Day"===r?(i=e.time.day.utc.offset(i,1),t=e.time.days.utc):"FiveMinute"===r?(o=5,i=e.time.minute.utc.offset(i,o),t=e.time.minutes.utc):"TenMinute"===r?(o=10,i=e.time.minute.utc.offset(i,o),t=e.time.minutes.utc):"FifteenMinute"===r?(o=15,i=e.time.minute.utc.offset(i,o),t=e.time.minutes.utc):(i=e.time.hour.utc.offset(i,1),t=e.time.hours.utc),t=t(a[0],i,o),w.domain(t).rangeRoundBands(n.range(),.2)}function i(t){return t.date}function s(t){return w(t.date)}function l(t){return p(t.date)}function c(t){return Math.floor(s(t)-h()/2)+.5}function d(t){return I.y(t.y0+t.y)}function f(t){return I.y(t.y0)-I.y(t.y0+t.y)}function p(t){return w(t)+w.rangeBand()/2}function m(t){var e=I.aggregate();return"Day"===e&&1===t.getUTCDate()||"Hour"===e&&0===t.getUTCHours()||"Month"===e&&0===t.getUTCMonth()}function v(){var t=I.config.value("tickCountX");return t||(I.width>600?12:5)}function g(){var t=w.domain();return t.length<7?t:I.x.ticks(v())}function h(){var t=w.domain(),e=t.length>1?w(t[1])-w(t[0]):w.rangeBand(),n=e-w.rangeBand();return n}function y(t){for(var e=0,n=t.length,r=I.x.domain()[0];n>e&&!(t[e].date.getTime()>=r.getTime());)e+=1;return 0===e?t:t.slice(e)}function x(){var t=I.x.tickFormat(v()),e=I.xAxisTickCallback();return function(n,r){return e?e.call(I.me,n,r,I.x,t):t(n,r)}}function b(){var t,n=g(),r=I.transitionMs(),a=x();n=n.filter(function(t){return void 0!==w(t)}),t=I.svgTickGroupX.selectAll("text").data(n,Object).classed({major:m}),t.transition().duration(r).attr("x",p).text(a),t.enter().append("text").attr("dy","-0.5em").style("opacity",1e-6).attr("x",p).classed({major:m}).transition().duration(r).style("opacity",1).text(a).each("end",function(){e.select(this).style("opacity",null)}),t.exit().transition().duration(r).style("opacity",1e-6).remove()}function C(t){var e=I.y(0),n=I.transitionMs(),r=t.selectAll("rect").data(Object,i);r.transition().duration(n).attr("x",s).attr("y",d).attr("height",f).attr("width",w.rangeBand()),r.enter().append("rect").attr("x",s).attr("y",e).attr("height",1e-6).attr("width",w.rangeBand()).transition().duration(n).attr("y",d).attr("height",f),r.exit().transition().duration(n).style("opacity",1e-6).remove()}function T(t){var n,r,o=I.transitionMs();r=y(t),n=M.selectAll("line").data(r,i),n.transition().duration(o).attr("x1",c).attr("x2",c),n.enter().append("line").style("opacity",1e-6).attr("x1",c).attr("x2",c).attr("y1",0).attr("y2",I.height+10).transition().duration(o).style("opacity",a()).each("end",function(){e.select(this).style("opacity",null)}),n.exit().transition().duration(o).style("opacity",1e-6).remove()}function k(t){var e=I.svgHoverRoot.selectAll("rect.highlightbar").data(t);e.attr("x",s).attr("width",w.rangeBand()),e.enter().append("rect").attr("x",s).attr("y",0).attr("height",I.height).attr("width",w.rangeBand()).classed("highlightbar clickable",!0),e.exit().remove()}function D(t){var e=t&&t.length>0?t.slice(0,1):[],n=t&&t.length>0?s(t[0]):0,r=t&&t.length>0?s(t[t.length-1]):0,a=r-n+w.rangeBand(),o=I.svgHoverRoot.selectAll("rect.selectionbar").data(e);o.attr("x",n).attr("width",a),o.enter().append("rect").attr("x",n).attr("y",0).attr("height",I.height).attr("width",a).classed("selectionbar clickable",!0),o.exit().remove()}var I=j.chart.baseGroupedStackTimeChart(t,n),A=u(I);A.me=A;var w=e.scale.ordinal(),M=I.svgRoot.insert("g",".annot-root").attr("class","vertrule").attr("transform","translate("+I.padding[3]+","+I.padding[0]+")");return A.scaleDate=function(t){var e=w.range(),n=w.rangeExtent(),r=I.scaleDate(t),a=e[Math.round(r/n[1]*(e.length-1))]+w.rangeBand()/2;return a},Object.defineProperties(A,{svgVertRuleGroup:{value:M},xBar:{value:w},xBarPadding:{value:h},trimToXDomain:{value:y},computeDomainX:{value:o},groupFillFn:{value:r},keyX:{value:i},valueX:{value:s},valueXMidBar:{value:l},valueXVertRule:{value:c},valueY:{value:d},heightY:{value:f},drawAxisXRules:{value:T},drawBarsForSources:{value:C},drawHoverHighlightBars:{value:k},drawSelection:{value:D}}),I.drawAxisX=b,A},j.chart.basicLineChart=function(n,r){function a(){var e=c.plotPropertyName,n=[null,null],r=[null,null];y=[],g.forEach(function(t){var a=f.data(t);a&&a.forEach(function(a){var o;void 0===a.date&&(a.date=j.api.datum.datumDate(a)),p&&p.call(this,t)||((null===n[0]||a.date<n[0])&&(n[0]=a.date),(null===n[1]||a.date>n[1])&&(n[1]=a.date),o=a[h[t]?h[t]:e],void 0!==o&&((null===r[0]||o<r[0])&&(r[0]=o),(null===r[1]||o>r[1])&&(r[1]=o)))}),y.push(a)}),b.domain(g.length),m&&m.length>0||b.range(t.Set3[g.length<3?3:g.length>11?12:g.length]),c.x.domain(n),c.y.domain(r).nice(),c.computeUnitsY()}function o(t,e){return g[e]}function i(t,e){return b(e)}function u(t,e){var n=p?p.call(this,g[e]):!1;return n?1e-6:1}function s(t){t.style("opacity",u).attr("stroke",i).attr("d",x)}function l(){var t,e=c.transitionMs();t=c.svgDataRoot.selectAll("path").data(y,function(t,e){return g[e]}),t.attr("class",o).transition().duration(e).call(s),t.enter().append("path").attr("class",o).call(s),t.exit().transition().duration(e).style("opacity",1e-6).remove(),d()}var c=j.chart.baseTimeChart(n,r),d=j.util.superMethod.call(c,"draw"),f=function(){var t=j.util.copy(c);return Object.defineProperty(t,"version",{value:"1.0.0",enumerable:!0,configurable:!0}),t}();c.me=f;var p,m,v={},g=[],h={},y=[],x=e.svg.line().interpolate("monotone").x(function(t){return Math.round(c.x(t.date)+.5)-.5}).y(function(t){var e=this.getAttribute("class"),n=h[e]?h[e]:c.plotPropertyName,r=t[n];return Math.round(c.y(void 0===r?null:r)+.5)-.5}),b=e.scale.ordinal().range(t.Set3[12]);return f.load=function(t,e,n){return void 0===v[e]?(g.push(e),v[e]=t):v[e]=v[e].concat(t),n?h[e]=n:h[e]&&delete h[e],f},f.sourceExcludeCallback=function(t){return arguments.length?(p="function"==typeof t?t:void 0,f):p},f.colors=function(t){return arguments.length?(m=t,b.range(t),f):b.range()},f.colorScale=function(){return b},f.data=function(t){return v[t]},f.reset=function(){return c.reset(),v={},g.length=0,h={},y.length=0,f},c.setup=a,c.draw=l,f},j.chart.energyBarOverlapChart=function(t,e){function n(t,e){return a.groupOpacityFn(null,e)}function r(){var t,e,r=[],o=a.groupIds,i=a.transitionMs();a.computeDomainX(),o.forEach(function(t){var e=a.groupLayers[t];void 0===e?r.push([]):r.push(e.map(function(t){return t.values}))}),t=u.selectAll("g.dataType").data(r,function(t,e){return o[e]}),t.enter().append("g").attr("class","dataType").style("opacity",n),e=t.selectAll("g.source").data(Object,function(t){return t[0].sourceId}).style("fill",a.groupFillFn),e.enter().append("g").attr("class","source").style("fill",a.groupFillFn),e.exit().transition().duration(i).style("opacity",1e-6).remove(),a.drawBarsForSources(e),a.drawAxisY(),a.drawAxisX()}var a=j.chart.baseGroupedStackTimeBarChart(t,e),o=function(){var t=j.util.copy(a);return Object.defineProperty(t,"version",{value:"1.0.0",enumerable:!0,configurable:!0}),t}();a.me=o;var i=o,u=a.svgDataRoot.append("g").attr("class","data");return Object.defineProperty(o,"me",{enumerable:!1,get:function(){return i},set:function(t){i=t,a.me=t}}),a.draw=r,o},j.chart.energyIOBarChart=function(t,n){function r(t){var e=y.config.seasonColors||["#5c8726","#e9a712","#762123","#80a3b7"],n=t.date.getUTCMonth();return 2>n||11==n?b?e[3]:e[1]:5>n?b?e[0]:e[2]:8>n?b?e[1]:e[3]:b?e[2]:e[0]}function a(t){return"Month"===y.aggregate()?r(t):null}function o(){var t;return t=1===y.yScale()?",d":",.1f",e.format(t)}function i(t){var e,n,r,a,o,i=null,u=null,s=null,l=t.length,c=!1;for(r=0;l>r;r+=1)e=t[r],n=e[y.plotPropertyName],void 0!==n&&(a=e[y.internalPropName].groupId,o=y.scaleFactor(a),c=C[a]===!0,c?s+=n*o:u+=n*o);return(null!==u||null!==s)&&(i=u-s),{date:t[0].date,y:i,plus:u,minus:s}}function u(){var t,n,r=[],a=y.groupIds,o=0,u=0,s=y.aggregate();a.forEach(function(t){var n=y.groupLayers[t];void 0===n?r.push([]):r.push(n.map(function(n){var r=e.max(n.values,function(t){return t.y+t.y0});return C[t]===!0?r>u&&(u=r):r>o&&(o=r),n.values}))});var l=e.merge(e.merge(r)).concat(y.xBar.domain().map(function(t){return{date:t}}));return t=e.nest().key(function(t){return t.date.getTime()}).sortKeys(e.ascending).rollup(i).entries(l).map(function(t){return t.values}),n=e.nest().key(function(t){var n;return n="Day"===s?e.time.month.utc.floor(t.date):"Month"===s?e.time.month.utc.offset(t.date,-((t.date.getUTCMonth()+1)%3)):e.time.day.utc.floor(t.date),n.getTime()}).sortKeys(e.ascending).rollup(i).entries(l).map(function(t){return t.values.date=new Date(Number(t.key)),t.values}),{allData:l,groupedData:r,sumLineData:t,timeAggregateData:n,maxPositiveY:o,maxNegativeY:u}}function s(){function t(t,e){var n=0;return C[o[e]]===!0?(n=-(2*r),"scale(1, -1) translate(0,"+n+")"):null}var e,n,r,a,o=y.groupIds,i=y.transitionMs(),s=y.y.domain();y.computeDomainX(),a=u(),w=a,s[0]=-a.maxNegativeY,s[1]=a.maxPositiveY,y.y.domain(s).nice(),r=y.y(0),e=D.selectAll("g.dataType").data(a.groupedData,function(t,e){return o[e]}),e.transition().duration(i).attr("transform",t),e.enter().append("g").attr("class","dataType").attr("transform",t),n=e.selectAll("g.source").data(Object,function(t){return t[0].sourceId}).style("fill",y.groupFillFn),n.enter().append("g").attr("class","source").style("fill",y.groupFillFn),n.exit().transition().duration(i).style("opacity",1e-6).remove(),y.drawBarsForSources(n),l(a.sumLineData),c(a.timeAggregateData),d(a.timeAggregateData),y.drawAxisY(),y.drawAxisX(),y.drawAxisXRules(a.timeAggregateData)}function l(t){function n(t){return null!==t.y}var r=y.transitionMs(),a=e.svg.line().x(y.valueXMidBar).y(function(t){return y.y(t.y)-.5}).interpolate("monotone").defined(n),o=I.selectAll("path").data([t]);o.transition().duration(r).attr("d",a),o.enter().append("path").attr("d",e.svg.line().x(y.valueXMidBar).y(function(){return y.y(0)-.5}).interpolate("monotone").defined(n)).transition().duration(r).attr("d",a),o.exit().transition().duration(r).style("opacity",1e-6).remove()}function c(t){function n(t){var e=y.valueXMidBar(t);return e}function a(t){return v((t.plus-t.minus)/y.yScale())}var i,u=y.transitionMs(),s=y.x.domain(),l=y.xBar,c=t.length;i="Month"===y.aggregate()&&c>0?t:[];var d=l.rangeBand(),f=y.xBarPadding()/2,p=T.selectAll("line").data(i,y.keyX),m=function(t){t.attr("x1",function(t){var e=t.date;return e.getTime()<s[0].getTime()&&(e=s[0]),l(e)-f}).attr("x2",function(t,e){return e+1<i.length?l(i[e+1].date)-f:i.length>0?l(s[1])+d+f:l(t.date)+f}).style("stroke",r)};p.transition().duration(u).call(m),p.enter().append("line").style("opacity",1e-6).call(m).transition().duration(u).style("opacity",1).each("end",function(){e.select(this).style("opacity",null)}),p.exit().transition().duration(u).style("opacity",1e-6).remove();var v=o(),g=k.selectAll("text").data(y.trimToXDomain(i),y.keyX);g.transition().duration(u).attr("x",n).text(a),g.enter().append("text").style("opacity",1e-6).attr("x",n).transition().duration(u).style("opacity",1).text(a).each("end",function(){e.select(this).style("opacity",null)}),g.exit().transition().duration(u).style("opacity",1e-6).remove()}function d(t){function n(t){return s(t.plus/y.yScale())}var r,i,u=y.transitionMs(),s=o();i=y.trimToXDomain(t),r=A.selectAll("text").data(i,y.keyX),r.transition().duration(u).attr("x",y.valueXMidBar).text(n).style("fill",a),r.enter().append("text").attr("x",y.valueXMidBar).style("opacity",1e-6).style("fill",a).transition().duration(u).text(n).style("opacity",1).each("end",function(){e.select(this).style("opacity",null)}),r.exit().transition().duration(u).style("opacity",1e-6).remove()}function f(t){if(w){var n=y.xBar.range(),r=e.bisectLeft(n,t[0]),a=1>r?0:r-1,o=y.xBar.domain()[a],i=[],u=[],s={data:u,yRange:[y.y(0),y.y(0)],allData:i,groups:{}};return w.groupedData.forEach(function(t,e){var n,r,a={groupId:y.groupIds[e],data:[],negate:C[y.groupIds[e]]===!0},l=y.scaleFactor(a.groupId),c=0;t.length>0&&t[0].length>0&&(r=R(t[0],o),r>=t[0].length&&(r-=1),a.index=r,t.forEach(function(t){t[r].date.getTime()===o.getTime()?(n=t[r][y.plotPropertyName]*l,void 0===s.dateUTC&&t[r].created&&(s.dateUTC=t[r].created,s.utcDate=j.format.timestampFormat.parse(s.dateUTC))):n=null,c+=n,a.data.push(n),i.push(n)}),a.total=c,a.y=y.y(c),a.y<s.yRange[0]&&(s.yRange[0]=a.y),a.y>s.yRange[1]&&(s.yRange[1]=a.y)),u.push(a),s.groups[a.groupId]=a}),s.date=o,s.x=y.valueXMidBar({date:o}),s.index=a,void 0===s.utcDate&&w.groupedData.some(function(t){return t.some(function(t){var n,r=t.length>0?t[0]:void 0,o=-1,i=e.time.month,u=1,l=y.aggregate();return r&&r.date&&r.created&&(y.xBar.domain().some(function(t,e){return t.getTime()===r.date.getTime()?(o=e,!0):!1}),o>=0)?(n=j.format.timestampFormat.parse(r.created),"Day"===l?i=e.time.day:"Hour"===l?i=e.time.hour:"FiveMinute"===l?(i=e.time.minute,u=5):"TenMinute"===l?(i=e.time.minute,u=10):"FifteenMinute"===l&&(i=e.time.minute,u=15),s.utcDate=i.offset(n,u*(a-o)),!0):!1})}),s}}function p(){var t=y.hoverEnterCallback();if(t){var e=j.tapCoordinates(this),n=f(e);if(!n)return void(M=void 0);y.drawHoverHighlightBars(n&&n.dateUTC?[n]:[]),M=n,t.call(y.me,this,e,n)}}function m(){var t=y.hoverMoveCallback();if(t){var e=j.tapCoordinates(this),n=f(e);if(!n)return void(M=void 0);y.drawHoverHighlightBars(n&&n.dateUTC?[n]:[]),M=n,P.length>0&&(n.date>P[0].date?y.drawSelection(P.concat(n)):y.drawSelection([n,P[0]])),t.call(y.me,this,e,n)}}function v(){var t=y.hoverLeaveCallback();if(t){var e=[];this&&(e.push(this),e.push(j.tapCoordinates(this))),y.drawHoverHighlightBars([]),M=void 0,t.apply(y.me,e)}}function g(){var t=y.doubleClickCallback();if(t){var n=j.tapCoordinates(this),r=M;r||(r=f(n)),P.length>0&&(P.length=0,y.drawSelection(P)),e.event.preventDefault(),t.call(y.me,this,n,r)}}function h(){var t=y.rangeSelectionCallback();if(t){var n,r=j.tapCoordinates(this),a=M;a||(a=f(r)),a&&((j.hasTouchSupport||e.event.shiftKey)&&P.length>0?a.date>P[0].date?P.push(a):P.splice(0,0,a):P.length>0?P.length=0:P.push(a),n=P,P.length>1&&(n=P.slice(0,P.length),P.length=0),y.drawSelection(P),e.event.preventDefault(),t.call(y.me,this,r,n))}}n&&n.padding||n.value("padding",[20,0,30,30]);var y=j.chart.baseGroupedStackTimeBarChart(t,n),x=function(){var t=j.util.copy(y);return Object.defineProperty(t,"version",{value:"1.0.0",enumerable:!0,configurable:!0}),t}();y.me=x;var b=void 0,C={Consumption:!0},T=y.svgDataRoot.append("g").attr("class","agg-band").attr("transform","translate(0,"+(y.height+y.padding[2]-25)+".5)"),k=y.svgDataRoot.append("g").attr("class","agg-band-ticks").attr("transform","translate(0,"+(y.height+y.padding[2]-21)+")"),D=y.svgDataRoot.append("g").attr("class","data"),I=y.svgDataRoot.append("g").attr("class","agg-sum"),A=y.svgDataRoot.append("g").attr("class","agg-gen").attr("transform","translate(0,"+(10-y.padding[0])+")"),w=void 0,M=void 0,P=[],R=e.bisector(function(t){return t.date}).left;return x.showSumLine=function(t){if(!arguments.length)return!I.classed("off");var n=y.transitionMs();return I.style("opacity",t?1e-6:1).classed("off",!1).transition().duration(n).style("opacity",t?1:1e-6).each("end",function(){e.select(this).style("opacity",null).classed("off",!t)}),y.me},x.northernHemisphere=function(t){if(!arguments.length)return b;if(t!==b){var e=y.transitionMs();return b=t===!0,T.selectAll("line").transition().duration(e).style("stroke",r),A.selectAll("text").transition().duration(e).style("fill",a),y.me}},x.negativeGroupIds=function(t){return arguments.length?(C={},t.forEach(function(t){C[t]=!0}),y.me):function(){var t,e=[];for(t in C)C.hasOwnProperty(t)&&e.pus(t);return e}()},y.draw=s,y.handleHoverEnter=p,y.handleHoverMove=m,y.handleHoverLeave=v,y.handleClick=h,y.handleDoubleClick=g,x},j.math={deg2rad:M,rad2deg:P},j.chart.energyIOPieChart=function(t,n){function r(t){return"scale(1.05) "+x(t,4)}function a(){return M||(M=w.append("g").attr("class","hover-root").attr("transform","translate("+L[3]+","+L[0]+")")),M}function o(t){var e=t.data()[0],n=g(e),r=h(e);return{groupId:e.data.groupId,sourceId:e.data.sourceId,allData:nt.map(function(t){return t.data}),value:e.value,valueDisplay:b(e),percent:e.value/rt,percentDisplay:C(e),totalValue:rt,totalValueDisplay:dt(rt/ct),angle:n,angleStart:e.startAngle,angleEnd:e.endAngle,degrees:j.math.rad2deg(n),radius:E,innerRadius:at,center:[(F+L[1]+L[3])/2,(S+L[0]+L[2])/2],centerContainer:w.node(),labelTranslate:[Math.cos(r)*(E+15),Math.sin(r)*(E+15)]}}function i(t,e){return t.key.localeCompare(e.key)}function u(){H=O.value("transitionMs")||600,at=O.value("innerRadius")||0,ot.innerRadius(at).outerRadius(E)}function s(t){return t.value}function l(){var t,n=e.max(nt,s);ct=1,W?ct=W.call(P,n):n>=1e9?ct=1e9:n>=1e6?ct=1e6:n>=1e3&&(ct=1e3),t=ct>=1e6?",.2f":1e3===ct?",.1f":1===ct?",d":",g",dt=e.format(t),rt=e.sum(nt,s)}function c(){var t=[];et.forEach(function(n){var r=function(t,e){return Y?Y.call(P,n,t,e):(n+"-"+t.sourceId).replace(/\W/,"-")},a=e.nest().key(r).rollup(function(t){var r={sum:0,groupId:n};return t.length&&(r.sourceId=t[0].sourceId,r.sum=e.sum(t,function(t){var e=t[B];return(e&&0>e||_&&_.call(P,n,t.sourceId))&&(e=0),e})*P.scaleFactor(n)),r}).entries(tt[n]);_&&(a=a.filter(function(t){return!_.call(P,n,t.key)})),t=t.concat(a.map(function(t){return t.values.key=t.key,t.values}))});var n=e.layout.pie().sort(q).value(function(t){return t.sum});nt=n(t),l()}function d(t,n){if(K)return K.call(P,t.data.groupId,t.data.sourceId,n);var r=e.scale.category10().range();return r[n%r.length]}function f(){e.select(this).style("opacity",null)}function p(t){var n=e.interpolate(this._data_start.startAngle,t.startAngle),r=e.interpolate(this._data_start.endAngle,t.endAngle);return this._data_start=t,function(t){var e={startAngle:n(t),endAngle:r(t)};return ot(e)}}function m(t){return t.data.key}function v(){var t=z.selectAll("path").data(nt,m);t.transition().duration(H).attr("d",ot).style("fill",d).attrTween("d",p),t.enter().append("path").attr("class",function(t){return"area "+t.data.key}).style("fill",d).style("opacity",1e-6).attr("d",ot).attr("pointer-events","all").on("mouseover",it).on("mousemove",ut).on("mouseout",st).on(j.tapEventNames.click,lt).each(function(t){this._data_start=t}).transition().duration(H).style("opacity",1).each("end",f),t.exit().transition().duration(H).style("opacity",1e-6).remove(),A()}function g(t){return t.startAngle+(t.endAngle-t.startAngle)/2}function h(t){return g(t)-Math.PI/2}function y(t,n){var r=e.interpolate(g(this._data_start),g(t));return this._data_start=t,function(t){var e=r(t)-Math.PI/2;return"translate("+Math.cos(e)*n+","+Math.sin(e)*n+")"}}function x(t,e){var n=h(t);return"translate("+Math.cos(n)*e+","+Math.sin(n)*e+")"}function b(t){return dt(t.value/ct)}function C(t){return $(t.value/rt)}function T(t){var e=g(t);return e<2*Math.PI*(1/8)||e>2*Math.PI*(7/8)?"middle":e<2*Math.PI*(3/8)?"start":e<2*Math.PI*(5/8)?"middle":"end"}function k(t){var e=g(t);return e>=2*Math.PI*(3/8)&&e<2*Math.PI*(5/8)?"0.5em":0}function D(){var t=Number(O.value("percentageLabelMinimumPercent"));return(isNaN(t)?5:t)/100*rt}function I(){var t=Number(O.value("valueLabelMinimumPercent"));return(isNaN(t)?5:t)/100*rt}function A(){var t=I(),e=O.enabled("hideValues")?[]:nt.filter(function(e){return e.value>t}),n=G.selectAll("text.outer").data(e,m);n.transition().duration(H).text(b).attr("text-anchor",T).attr("dy",k).attr("transform",function(t){return x(t,E+15)}).attrTween("transform",function(t){return y.call(this,t,E+15)}),n.enter().append("text").classed("outer",!0).attr("transform",function(t){return x(t,E+15)}).attr("text-anchor",T).attr("dy",k).style("opacity",1e-6).text(b).each(function(t){this._data_start=t}).transition().duration(H).style("opacity",1).each("end",f),n.exit().transition().duration(H).style("opacity",1e-6).remove();var r=D(),a=O.enabled("hidePercentages")?[]:nt.filter(function(t){return t.value>r}),o=G.selectAll("text.inner").data(a,m),i=(E-at)/2+at;o.transition().duration(H).text(C).attr("transform",function(t){return x(t,i)}).attrTween("transform",function(t){return y.call(this,t,i)}),o.enter().append("text").classed("inner",!0).attr("transform",function(t){return x(t,i)}).attr("text-anchor","middle").style("opacity",1e-6).text(C).each(function(t){this._data_start=t}).transition().duration(H).style("opacity",1).each("end",f),o.exit().transition().duration(H).style("opacity",1e-6).remove()}var w,M,P={version:"1.0.0"},R=P,U=[],O=n||new j.Configuration,N=j.ui.pixelWidth(t),L=O.padding||[24,24,24,24],F=(O.width||N||300)-L[1]-L[3],S=(O.height||300)-L[0]-L[2],E=e.min([F,S])/2,H=void 0,B="wattHours",z=void 0,G=void 0,X={},K=void 0,_=void 0,W=void 0,Y=void 0,q=i,Q=void 0,V=void 0,Z=void 0,J=void 0,$=e.format(".0%"),tt={},et=[],nt=void 0,rt=0,at=0,ot=e.svg.arc(),it=function(){if(Q){var t=e.select(this),n=e.mouse(this),a=o(t,n);t.transition().duration(H).attr("transform",r),Q.call(R,this,n,a)}},ut=function(){if(V){var t=e.select(this),n=e.mouse(this),r=o(t,n);V.call(R,this,n,r)}},st=function(){if(Z){var t=e.select(this),n=e.mouse(this),r=o(t,n);t.transition().duration(H).attr("transform","identity").each("end",function(){e.select(this).style("transform",null)}),Z.call(R,this,n,r)}},lt=function(){if(J){var t=e.select(this),n=e.mouse(this),r=o(t,n);J.call(R,this,n,r)}};u(),w=e.select(t),w.node()&&"svg"!==w.node().tagName.toLowerCase()&&(w=w.select("svg"),w.empty()?w=e.select(t).append("svg:svg").attr("class","chart").attr("width",F+L[1]+L[3]).attr("height",S+L[0]+L[2]):w.selectAll("*").remove()),z=w.append("g").attr("class","data").attr("transform","translate("+(F+L[1]+L[3])/2+","+(S+L[0]+L[2])/2+")"),G=w.append("g").attr("class","label").attr("transform","translate("+(F+L[1]+L[3])/2+","+(S+L[0]+L[2])/2+")");var ct=1,dt=e.format(",d");return P.sources=U,P.scale=function(){return W?W():ct},P.totalValue=function(){return rt},P.reset=function(){return tt={},et=[],nt=void 0,R},P.load=function(t,e){return void 0===tt[e]?(et.push(e),tt[e]=t):tt[e].concat(t),R},P.regenerate=function(){return void 0===tt?P:(u(),c(),v(),R)},P.transitionMs=function(t){return arguments.length?(H=+t,R):H},P.plotProperty=function(t){return arguments.length?(B=t,R):B},P.scaleFactor=function(t,e){var n;if(!arguments.length)return X;if(1===arguments.length){if("string"==typeof t)return n=X[t],void 0===n?1:n;X=t}else 2==arguments.length&&(X[t]=e);return R},P.colorCallback=function(t){return arguments.length?(K="function"==typeof t?t:void 0,R):K},P.displayFactorCallback=function(t){return arguments.length?(W="function"==typeof t?t:void 0,R):W},P.sourceExcludeCallback=function(t){return arguments.length?(_="function"==typeof t?t:void 0,R):_},P.layerKeyCallback=function(t){return arguments.length?("function"==typeof t&&(Y=t),R):Y},P.layerKeySort=function(t){return arguments.length?("function"==typeof t&&(q=t),R):q},P.hoverEnterCallback=function(t){return arguments.length?(a(),Q="function"==typeof t?t:void 0,R):Q},P.hoverMoveCallback=function(t){return arguments.length?(a(),"function"==typeof t?(a(),V=t):V=void 0,R):V},P.hoverLeaveCallback=function(t){return arguments.length?(a(),Z="function"==typeof t?t:void 0,R):Z},P.clickCallback=function(t){return arguments.length?(J="function"==typeof t?t:void 0,R):J},P},j.chart.gauge=function(t,n){function r(t){var e=g(t),n=c.minAngle+e*d;return n}function a(t){var n=void 0;for(n in t)c[n]=t[n];d=c.maxAngle-c.minAngle,f=c.size/2,p=Math.round(f*c.pointerHeadLengthPercent),g=e.scale.linear().range([0,1]).domain([c.minValue,c.maxValue]),h=g.ticks(c.majorTicks),y=e.range(c.majorTicks).map(function(){return 1/c.majorTicks}),v=e.svg.arc().innerRadius(f-c.ringWidth-c.ringInset).outerRadius(f-c.ringInset).startAngle(function(t,e){var n=t*e;return j.math.deg2rad(c.minAngle+n*d)}).endAngle(function(t,e){var n=t*(e+1);return j.math.deg2rad(c.minAngle+n*d)})}function o(){return"translate("+f+","+f+")"}function i(){return void 0!==m}function u(n){m=e.select(t).append("svg:svg").attr("class","gauge").attr("width",c.clipWidth).attr("height",c.clipHeight);var a=o(),i=m.append("g").attr("class","arc").attr("transform",a);i.selectAll("path").data(y).enter().append("path").attr("fill",function(t,e){
return c.arcColorFn(t*e)}).attr("d",v);var u=m.append("g").attr("class","label").attr("transform",a);u.selectAll("text").data(h).enter().append("text").attr("transform",function(t){var e=r(t);return"rotate("+e+") translate(0,"+(c.labelInset-f)+")"}).text(c.labelFormat);var l=[[c.pointerWidth/2,0],[0,-p],[-(c.pointerWidth/2),0],[0,c.pointerTailLength],[c.pointerWidth/2,0]],d=e.svg.line().interpolate("monotone"),g=m.append("g").data([l]).attr("class","pointer").attr("transform",a);x=g.append("path").attr("d",d).attr("transform","rotate("+c.minAngle+")"),s(void 0===n?0:n)}function s(t,e){void 0!==e&&a(e);var n=r(t);x.transition().duration(c.transitionMs).ease("elastic").attr("transform","rotate("+n+")")}var l={version:"1.0.0"},c={size:200,clipWidth:200,clipHeight:110,ringInset:20,ringWidth:20,pointerWidth:10,pointerTailLength:5,pointerHeadLengthPercent:.9,minValue:0,maxValue:10,minAngle:-90,maxAngle:90,transitionMs:750,majorTicks:5,labelFormat:e.format(",g"),labelInset:10,arcColorFn:e.interpolateHsl(e.rgb("#e8e2ca"),e.rgb("#3e6c0a"))},d=void 0,f=void 0,p=void 0,m=void 0,v=void 0,g=void 0,h=void 0,y=void 0,x=void 0;return l.configure=a,l.isRendered=i,l.render=u,l.update=s,a(n),l},j.chart.powerAreaChart=function(t,n){function r(t,e){return i.fillColor.call(this,t[0][i.internalPropName].groupId,t[0],e)}function a(){var t,n,r,a,o,u=[],l=i.plotPropertyName,c=e.layout.stack().offset(s.stackOffset()).values(function(t){return t.values}).x(function(t){return t.date}).y(function(t){var e=t[l],n=i.scaleFactor(t[i.internalPropName].groupId);return(void 0===e||0>e||null===e)&&(e=0),e*n});i.groupIds.forEach(function(t){var e,n,r,a=s.data(t);if(a&&!(!a.length>1))for(e=0,n=a.length;n>e;e+=1)r=a[e],r.hasOwnProperty(i.internalPropName)||(r[i.internalPropName]={},r[i.internalPropName].groupId=t,s.dataCallback()?s.dataCallback().call(i.me,t,r):void 0===r.date&&(r.date=j.api.datum.datumDate(r))),s.sourceExcludeCallback()&&s.sourceExcludeCallback().call(i.me,t,r.sourceId)||u.push(r)}),t=e.nest().key(function(t){return t[i.internalPropName].groupId+"|"+t.sourceId}).sortKeys(e.ascending).entries(u),t.length<1||(n={},n[l]=null,j.api.datum.nestedStackDataNormalizeByDate(t,n,function(t,e){var n=e.indexOf("|");t[i.internalPropName]={groupId:e.slice(0,n)},t.sourceId=e.slice(n+1)}),i.insertNormalizedDurationIntoLayerData(t),i.me.layerPostProcessCallback()&&(t=function(){var e=[];return i.groupIds.forEach(function(n){var r=t.filter(function(t){return 0===t.key.indexOf(n+"|")});r.length>0&&(e=e.concat(i.me.layerPostProcessCallback().call(i.me,n,r)))}),e}()),r=u.length>0?[u[0].date,u[u.length-1].date]:void 0,o=c(t),i.groupLayers.All=o,a=[0,e.max(o[o.length-1].values,function(t){return t.y0+t.y})],void 0!==r&&i.x.domain(r),void 0!==a&&i.y.domain(a).nice(),i.computeUnitsY())}function o(){var t=i.transitionMs(),e=i.groupLayers.All,n=e?e.map(function(t){return t.values}):[],a=i.svgDataRoot.selectAll("path.area").data(n,function(t){return t.length?t[0][i.internalPropName].groupId+"-"+t[0].sourceId:null});a.transition().duration(t).attr("d",l).style("fill",r),a.enter().append("path").attr("class","area").style("fill",r).attr("d",l).style("opacity",1e-6).transition().duration(t).style("opacity",1),a.exit().transition().duration(t).style("opacity",1e-6).remove(),u()}var i=j.chart.baseGroupedStackTimeChart(t,n),u=j.util.superMethod.call(i,"draw"),s=function(){var t=j.util.copy(i);return t}();i.me=s;var l=e.svg.area().interpolate("monotone").x(function(t){return i.x(t.date)}).y0(function(t){return i.y(t.y0)}).y1(function(t){return i.y(t.y0+t.y)});return i.setup=a,i.draw=o,s},j.chart.powerAreaOverlapChart=function(t,n){function r(t,e){return i.fillColor.call(this,t[0][i.internalPropName].groupId,t[0],e)}function a(t,e,n){return i.groupOpacityFn(null,n)}function o(){var t=[],e=[],n=i.groupIds,o=i.transitionMs();n.forEach(function(n){var r=i.groupLayers[n];if(void 0!==r){e.push(n);var a=r.map(function(t){return t.values});t.push(a)}});var s=i.svgDataRoot.selectAll("g.data").data(t,function(t,n){return e[n]});s.enter().append("g").attr("class","data"),s.exit().transition().duration(o).style("opacity",1e-6).remove();var c=s.selectAll("path.area").data(Object,function(t){return t.length?t[0][i.internalPropName].groupId+"."+t[0].sourceId:null});c.transition().duration(o).delay(200).attr("d",l).style("fill",r),c.enter().append("path").attr("class","area").style("fill",r).attr("d",l).style("opacity",1e-6).transition().duration(o).style("opacity",a),c.exit().transition().duration(o).style("opacity",1e-6).remove(),u()}var i=j.chart.baseGroupedStackTimeChart(t,n),u=j.util.superMethod.call(i,"draw"),s=function(){var t=j.util.copy(i);return t}();i.me=s;var l=e.svg.area().interpolate("monotone").x(function(t){return i.x(t.date)}).y0(function(t){return i.y(t.y0)}).y1(function(t){return i.y(t.y0+t.y)});return i.draw=o,i.normalizeDataTimeGaps(!0),s},j.chart.powerIOAreaChart=function(t,n){function r(t,e){return l.fillColor.call(this,t[0][l.internalPropName].groupId,t[0],e)}function a(t){var e,n,r,a,o,i=null,u=null,s=null,c=t.length,d=!1;for(r=0;c>r;r+=1)e=t[r],n=e[l.plotPropertyName],void 0!==n&&(a=e[l.internalPropName].groupId,o=l.scaleFactor(a),d=m[a]===!0,d?s+=n*o:u+=n*o);return(null!==u||null!==s)&&(i=u-s),{date:t[0].date,y:i,plus:u,minus:s}}function o(){var t,n,r=e.scale.ordinal(),a=l.x,o=l.aggregate(),i=a.domain(),u=1;return"Month"===o?t=e.time.month.utc:"Day"===o?t=e.time.day.utc:"Hour"===o?t=e.time.hour.utc:0===o.search(/^Ten/)?(t=e.time.minute.utc,u=10):0===o.search(/^Five/)?(t=e.time.minute.utc,u=5):(t=e.time.minute.utc,u=15),n=t.range(i[0],t.offset(i[1],u),u),r.domain(n),r}function i(){var t,n=[],r=l.groupIds,i=0,u=0,s=o();r.forEach(function(t){var r=l.groupLayers[t];void 0===r?n.push([]):n.push(r.map(function(n){var r=e.max(n.values,function(t){return t.y+t.y0});return m[t]===!0?r>u&&(u=r):r>i&&(i=r),n.values}))});var c=e.merge(e.merge(n)).concat(s.domain().map(function(t){return{date:t}}));return t=e.nest().key(function(t){return t.date.getTime()}).sortKeys(e.ascending).rollup(a).entries(c).map(function(t){return t.values}),{groupedData:n,sumLineData:t,maxPositiveY:i,maxNegativeY:u}}function u(){function t(t,e){var n=0;return m[u[e]]===!0?(n=-(2*a),"scale(1, -1) translate(0,"+n+")"):null}var e,n,a,o,u=l.groupIds,d=l.transitionMs(),f=l.y.domain();o=i(),f[0]=-o.maxNegativeY,f[1]=o.maxPositiveY,l.y.domain(f).nice(),a=l.y(0),e=l.svgDataRoot.selectAll("g.dataType").data(o.groupedData,function(t,e){return u[e]}),e.transition().duration(d).attr("transform",t),e.enter().append("g").attr("class","dataType").attr("transform",t),n=e.selectAll("path.source").data(Object,function(t){return t.length?t[0].sourceId:null}),n.transition().duration(d).attr("d",p).style("fill",r),n.enter().append("path").attr("class","source").style("fill",r).attr("d",p).style("opacity",1e-6).transition().duration(d).style("opacity",1),n.exit().transition().duration(d).style("opacity",1e-6).remove(),s(o.sumLineData),c()}function s(t){function n(t){return null!==t.y}function r(t){return l.x(t.date)}var a=l.transitionMs(),o=e.svg.line().x(r).y(function(t){return l.y(t.y)-.5}).interpolate("monotone").defined(n),i=f.selectAll("path").data([t]);i.transition().duration(a).attr("d",o),i.enter().append("path").attr("d",e.svg.line().x(r).y(function(){return l.y(0)-.5}).interpolate("monotone").defined(n)).transition().duration(a).attr("d",o),i.exit().transition().duration(a).style("opacity",1e-6).remove()}var l=j.chart.baseGroupedStackTimeChart(t,n),c=j.util.superMethod.call(l,"draw"),d=function(){var t=j.util.copy(l);return Object.defineProperty(t,"version",{value:"1.0.0",enumerable:!0,configurable:!0}),t}();l.me=d;var f=l.svgRoot.append("g").attr("class","agg-sum").attr("transform",l.svgDataRoot.attr("transform")),p=e.svg.area().interpolate("monotone").x(function(t){return l.x(t.date)}).y0(function(t){return l.y(t.y0)}).y1(function(t){return l.y(t.y0+t.y)}),m={Consumption:!0};return d.showSumLine=function(t){if(!arguments.length)return!f.classed("off");var n=l.transitionMs();return f.style("opacity",t?1e-6:1).classed("off",!1).transition().duration(n).style("opacity",t?1:1e-6).each("end",function(){e.select(this).style("opacity",null).classed("off",!t)}),l.me},d.negativeGroupIds=function(t){return arguments.length?(m={},t.forEach(function(t){m[t]=!0}),l.me):function(){var t,e=[];for(t in m)m.hasOwnProperty(t)&&e.pus(t);return e}()},l.draw=u,l.normalizeDataTimeGaps(!0),d},j.chart.seasonalDayOfWeekLineChart=function(t,n){var r=j.chart.baseGroupedSeasonalLineChart(t,n),a=function(){var t=j.util.copy(r);return Object.defineProperty(t,"version",{value:"1.0.0",enumerable:!0,configurable:!0}),t}();return r.me=a,r.timeKeyLabels(["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]),r.xAxisTicks=function(){return r.x.domain()},r.dateForTimeKey=function(t){return new Date(Date.UTC(2001,0,1+t))},r.timeKeyForDate=function(t){return(t.getUTCDay()+6)%7},r.timeKeyInterval=function(){return e.time.day.utc},a},j.chart.seasonalHourOfDayLineChart=function(t,n){var r=j.chart.baseGroupedSeasonalLineChart(t,n),a=function(){var t=j.util.copy(r);return Object.defineProperty(t,"version",{value:"1.0.0",enumerable:!0,configurable:!0}),t}();return r.me=a,r.timeKeyLabels(["Midnight","1am","2am","3am","4am","5am","6am","7am","8am","9am","10am","11am","Noon","1pm","2pm","3pm","4pm","5pm","6pm","7pm","8pm","9pm","10pm","11pm"]),r.xAxisTicks=function(){return r.x.domain().filter(function(t,e){return e%2===0})},r.dateForTimeKey=function(t){return new Date(Date.UTC(2001,0,1,t))},r.timeKeyForDate=function(t){return t.getUTCHours()},r.timeKeyInterval=function(){return e.time.hour.utc},a},j.runtime={},j.color.map=R,j.color.color=U,j.color.sourceColorMapping=O,j.counter=N,j.hasTouchSupport=function(){if(!z||!z.document)return!1;if("createTouch"in z.document)return!0;try{var t=z.document.createEvent("TouchEvent");return!!t.initTouchEvent}catch(e){return!1}}(),j.tapEventNames=function(){return j.hasTouchSupport?{start:"touchstart",move:"touchmove",end:"touchend",cancel:"touchcancel",click:"touchstart",dblclick:"touchstart"}:{start:"mousedown",move:"mousemove",end:"mouseup",cancel:"touchcancel",click:"click",dblclick:"dblclick"}}(),j.tapCoordinates=function(t){var n;return j.hasTouchSupport?(n=e.touches(t),n&&n.length>0?n[0]:void 0):e.mouse(t)},j.format.displayScaleForValue=L,j.format.displayUnitsForScale=F,j.format.fmt=S,j.net.encodeURLQueryTerms=E,j.net.securityHelper=function(){function t(){return f.token&&f.token.length>0&&f.secret&&f.secret.length>0}function n(t){return arguments.length?(f.token=t&&t.length>0?t:void 0,d):f.token}function r(t){return arguments.length&&(f.secret=t),d}function a(){return f.secret&&f.secret.length>0}function o(){return f.secret=void 0,d}function i(t){return null!==t&&t.indexOf("application/x-www-form-urlencoded")<0}function u(t){var e=(void 0===t.method?"GET":t.method.toUpperCase())+"\n"+(void 0!==t.data&&i(t.contentType)?CryptoJS.MD5(t.data):"")+"\n"+(void 0===t.contentType?"":t.contentType)+"\n"+t.date+"\n"+t.path,n=CryptoJS.HmacSHA1(e,t.secret||""),r=t.token+":"+CryptoJS.enc.Base64.stringify(n);return r}function s(t){var e,n,r,a,o={};if(void 0!==t&&t.length>0)for(t.match(/^\?/)&&(t=t.substring(1)),e=t.split("&"),r=0,a=e.length;a>r;r++)n=e[r].split("=",2),2===n.length&&(o[decodeURIComponent(n[0])]=decodeURIComponent(n[1]));return o}function l(t,e){var n=document.createElement("a");n.href=t;var r,a,o=n.pathname,i=s(void 0===e?n.search:e),u=[],l=void 0,c=!0;o.length>0&&"/"!==o.charAt(0)&&(o="/"+o);for(l in i)u.push(l);if(u.sort(),u.length>0)for(o+="?",r=0,a=u.length;a>r;r++)c?c=!1:o+="&",o+=u[r],o+="=",o+=i[u[r]];return o}function c(t,n,r,a,o){var s=t;arguments.length>0&&(arguments.length<5&&"function"==typeof arguments[arguments.length-1]&&(o=arguments[arguments.length-1]),"string"!=typeof n&&(n=void 0),"string"!=typeof r&&(r=void 0),"string"!=typeof a&&(a=void 0)),n=void 0===n?"GET":n.toUpperCase(),("POST"===n||"PUT"===n)&&(r||!function(){var e=t.indexOf("?");-1!==e&&(e+1<t.length-1&&(r=t.substring(e+1)),s=t.substring(0,e),a="application/x-www-form-urlencoded; charset=UTF-8")}());var c=e.json(s);return void 0!==a&&c.header("Content-Type",a),c.on("beforesend",function(e){var o=(new Date).toUTCString(),s=l(t,void 0!==a&&0===a.indexOf("application/x-www-form-urlencoded")?r:void 0),c=u({method:n,date:o,path:s,token:f.token,secret:f.secret,data:r,contentType:a});void 0!==r&&i(a)&&e.setRequestHeader("Content-MD5",CryptoJS.MD5(r)),e.setRequestHeader("X-SN-Date",o),e.setRequestHeader("Authorization","SolarNetworkWS "+c)}),c.on("load.internal",function(){}),void 0!==o&&c.send(n,r,o),c}var d={version:"1.1.0"},f={token:void 0,secret:void 0};return Object.defineProperties(d,{hasTokenCredentials:{value:t},token:{value:n},secret:{value:r},hasSecret:{value:a},clearSecret:{value:o},generateAuthorizationHeaderValue:{value:u},parseURLQueryTerms:{value:s},authURLPath:{value:l},json:{value:c}}),d},j.net.sec=j.net.securityHelper(),j.ui.adjustDisplayUnits=function(t,e,n,r){var a=j.format.displayUnitsForScale(e,n);t.selectAll(".unit").text(a),void 0!==r&&t.selectAll(".unit-kind").text(r)},j.ui.colorDataLegendTable=H,j.ui.flipCounter=function(t,n){function r(t){var e=void 0;for(e in t)s[e]=t[e]}function a(n){l=e.select(t).classed("flipCounter",!0),i(void 0===n?0:n)}function o(t,e){return s.flipperWidth*(c.length-1)-s.flipperWidth*e+"px"}function i(t){var n=s.format(t);c=function(){var t,e,r=[];for(t=0,e=n.length;e>t;t++)r.push(n.charAt(t));return r.reverse()}();var r=l.selectAll("span.flipper").data(c);r.style("left",o).each(function(t){var n=e.select(this),r=s.animate===!0?n.classed("flipped"):!1,a=n.select(r||s.animate!==!0?"span.a":"span.b"),o=n.select(r?"span.b":"span.a").text();o!==t&&(a.select("span.value").text(t),s.animate&&n.classed("flipped",!r))}),r.enter().append("span").attr("class","flipper").style("left",o).html(function(t){return(s.animate?'<span class="face b"><span class="value">b</span></span>':"")+'<span class="face a"><span class="value">'+t+"</span></span>"}),r.exit().remove()}var u={version:"1.0.0"},s={flipperWidth:34,transitionMs:200,format:e.format("07,g"),animate:!0},l=void 0,c=["0"];return u.configure=r,u.render=a,u.update=i,r(n),u},j.ui.Matrix=function(){var t="Float32Array"in window;this.matrix=function(){var e;return t?(e=new Float32Array(6),e[0]=1,e[3]=1):e=[1,0,0,1,0,0],e}(),this.support={use3d:this.supportDefaults.use3d,tProp:this.supportDefaults.tProp,trProp:this.supportDefaults.trProp,trTransform:this.supportDefaults.trTransform,trEndEvent:this.supportDefaults.trEndEvent}},j.ui.Matrix.prototype={constructor:j.ui.Matrix,supportDefaults:function(){for(var t=document.createElement("div").style,e="Transform",n=["Webkit"+e,"O"+e,"ms"+e,"Moz"+e],r=["webkitTransitionEnd","oTransitionEnd","transitionend","transitionend"],a=["WebkitTransition","OTransition","transition","MozTransition"],o=["-webkit-transform","-o-transform","transform","-moz-transform"],i="Transform",u="Transition",s="transform",l="transitionEnd",c=n.length;c--;)if(n[c]in t){i=n[c],u=a[c],s=o[c],l=r[c];break}return{use3d:void 0===window.devicePixelRatio?!1:window.devicePixelRatio>1,tProp:i,trProp:u,trTransform:s,trEndEvent:l}}(),toMatrix3D:function(){return"matrix3d("+this.matrix[0]+","+this.matrix[1]+",0,0,"+this.matrix[2]+","+this.matrix[3]+",0,0,0,0,1,0,"+this.matrix[4]+","+this.matrix[5]+",0,1)"},toMatrix2D:function(){return"matrix("+this.matrix[0]+","+this.matrix[1]+","+this.matrix[2]+","+this.matrix[3]+","+this.matrix[4]+","+this.matrix[5]+")"},setRotation:function(t){var e=Math.cos(t),n=Math.sin(t);this.matrix[0]=this.matrix[3]=e,this.matrix[1]=0-n,this.matrix[2]=n},setScale:function(t){this.matrix[0]=t,this.matrix[3]=t},setTranslation:function(t,e){this.matrix[4]=t,this.matrix[5]=e},translate:function(t,e){this.matrix[4]+=t,this.matrix[5]+=e},getTranslation:function(){return{x:this.matrix[4],y:this.matrix[5]}},getDistanceFrom:function(t){return Math.sqrt(Math.pow(t.x-this.matrix[4],2),Math.pow(t.y-this.matrix[5],2))},apply:function(t){var e=this.support.use3d===!0?this.toMatrix3D():this.toMatrix2D();t.style[this.support.tProp]=e},animateListen:function(t,e){var n=void 0,r=this;n=function(a){a.target===t&&(t.removeEventListener(r.support.trEndEvent,n,!1),e.apply(t))},t.addEventListener(r.support.trEndEvent,n,!1)},animate:function(t,e,n,r){var a=this;this.animateListen(t,function(){t.style[a.support.trProp]="",void 0!==r&&r.apply(t)});var o=this.support.trTransform+" "+(void 0!==n?n:"0.3s")+" "+(void 0!==e?e:"ease-out");t.style[this.support.trProp]=o,this.apply(t)},easeOut:function(t,e){this.animate(t,"ease-out",void 0,e)},easeIn:function(t,e){this.animate(t,"ease-in",void 0,e)},isUse3d:function(){return this.support.use3d===!0},setUse3d:function(t){this.support.use3d=t===!0}},j});
//# sourceMappingURL=solarnetwork-d3.min.js.map
