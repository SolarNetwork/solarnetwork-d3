!function(t,e){"function"==typeof define&&define.amd?define(["colorbrewer","d3","queue-async","crypto-js"],e):"object"==typeof module&&module.exports?module.exports=e(require("colorbrewer"),require("d3"),require("queue-async"),require("crypto-js")):t.sn=e(t.colorbrewer,t.d3,t.queue,t.CryptoJS)}(this,function(t,e,n,r){"use strict";function a(t){var e,n,r,a,o,i,u={};if(void 0!==t&&t.length>0)for(t.match(/^\?/)&&(t=t.substring(1)),e=t.split("&"),r=0,a=e.length;a>r;r++)n=e[r].split("=",2),2===n.length&&(o=decodeURIComponent(n[0]),i=decodeURIComponent(n[1]),u[o]?(Array.isArray(u[o])||(u[o]=[u[o]]),u[o].push(i)):u[o]=i);return u}function o(t){var e;for(e in t)t.hasOwnProperty(e)&&void 0===X[e]&&(X[e]=t[e])}function i(t){var e;for(e in t)t.hasOwnProperty(e)&&(X[e]=t[e])}function u(t,e){var n,r;void 0===e&&(e={});for(n in t)t.hasOwnProperty(n)&&(r=Object.getOwnPropertyDescriptor(t,n),r?Object.defineProperty(e,n,r):e[n]=t[n]);return e}function l(t,e){var n,r,a,o,i=Object.getOwnPropertyNames(t);for(void 0===e&&(e={}),n=0,r=i.length;r>n;n+=1)a=i[n],o=Object.getOwnPropertyDescriptor(t,a),o?Object.defineProperty(e,a,o):e[a]=t[a];return e}function s(t,e){var n,r;if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(n=0,r=t.length;r>n;n+=1){if(Array.isArray(t[n])&&Array.isArray(e[n])&&arraysAreEqual(t[n],e[n])!==!0)return!1;if(t[n]!==e[n])return!1}return!0}function c(t){var e=this,n=e[t];return function(){return n.apply(e,arguments)}}function d(t,e){"function"==typeof e&&(void 0===K&&(K=[]),t=t.replace(/[^0-9a-zA-Z_]/,""),K.push({name:t,func:e}))}function f(t){return t.hostURL()+(B.config&&B.config.solarUserPath?B.config.solarUserPath:"/solaruser")+"/api/v1/sec"}function p(t,e){"function"==typeof e&&(void 0===_&&(_=[]),t=t.replace(/[^0-9a-zA-Z_]/,""),_.push({name:t,func:e}))}function v(t){return f(this)+"/instr/view?id="+encodeURIComponent(t)}function m(){return f(this)+"/instr/viewActive?nodeId="+this.nodeId}function h(){return f(this)+"/instr/viewPending?nodeId="+this.nodeId}function g(t,e){return f(this)+"/instr/updateState?id="+encodeURIComponent(t)+"&state="+encodeURIComponent(e)}function y(t,e){var n=f(this)+"/instr/add?nodeId="+this.nodeId+"&topic="+encodeURIComponent(t);if(Array.isArray(e)){var r,a;for(r=0,a=e.length;a>r;r++)n+="&"+encodeURIComponent("parameters["+r+"].name")+"="+encodeURIComponent(e[r].name)+"&"+encodeURIComponent("parameters["+r+"].value")+"="+encodeURIComponent(e[r].value)}return n}function x(t,e,n,r,a){var o,i,u,l,s,c,d,f,p=t.length,v=n.length,m=r.length;if(o=t[0].values.length,o>0){for(f=[],i=0;o>i;i+=1){if(s=t[0].values[i],d={},void 0!==a)for(c in a)a.hasOwnProperty(c)&&(d[c]=a[c]);for(l=0;v>l;l+=1)d[n[l]]=s[n[l]];for(l=0;m>l;l+=1)d[r[l]]=0;for(u=0;p>u;u+=1)for(l=0;m>l;l+=1)c=t[u].values[i][r[l]],void 0!==c&&(d[r[l]]+=c);f.push(d)}t=[{key:e,values:f}]}return t}function b(t){if(t){if(t.date)return t.date;if(t.localDate)return B.format.dateTimeFormat.parse(t.localDate+(t.localTime?" "+t.localTime:" 00:00"));if(t.created)return B.format.timestampFormat.parse(t.created)}return null}function C(){B.config.debug===!0&&void 0!==console&&console.log(B.format.fmt.apply(this,arguments))}function D(t,n,r,a){function o(t,e){var n=t.utc.ceil(e);return n.getTime()===e.getTime()&&(n=t.offset(n,1)),n}function i(t){var e;return e=isNaN(Number(n))?void 0!==n[t]?Number(n[t]):1:n,"number"!=typeof e&&(e=1),e}function u(t){var e=10;return 0===t.search(/^Five/)?e=5:0===t.search(/^Fifteen/)&&(e=15),e}var l,s,c,d,f;return t.search(/Minute$/)>=0?(d=i("numHours"),c="hour",l=o(e.time.minute,r),f=u(t),l.setUTCMinutes(l.getUTCMinutes()+f-l.getUTCMinutes()%f,0,0),s=e.time.hour.utc.offset(l,-d)):"Month"===t?(d=i("numYears"),c="year",l=o(e.time.month,r),s=e.time.year.utc.offset(e.time.month.utc.floor(r),-d)):"Day"===t?(d=i("numMonths"),c="month",l=o(e.time.day,r),s=e.time.month.utc.offset(e.time.day.utc.floor(r),-d)):(d=i("numDays"),c="day",l=o(e.time.hour,r),s=e.time.day.utc.offset(e.time.hour.utc.floor(l),-d)),a&&a>s&&(s=a),{start:s,end:l,timeUnit:c,timeCount:d}}function T(t,n,r){var a,o,i,u,l,s=0,c=t.length-1;if(c>0)for(;s<e.max(t.map(function(t){return t.values.length}));){for(i=void 0,a=0;c>=a;a++)if(!(t[a].values.length<=s)&&(o=c>a?a+1:0,t[o].values.length<=s||t[a].values[s].date.getTime()<t[o].values[s].date.getTime())){if(i={date:t[a].values[s].date,sourceId:t[o].key},n)for(u in n)n.hasOwnProperty(u)&&(i[u]=n[u]);r&&(l=t[o].values.length>s?s:s>0?s-1:null,r(i,t[o].key,null!==l?t[o].values[l]:void 0)),t[o].values.splice(s,0,i)}void 0===i&&s++}}function k(t,r,a){function o(e){var n,r,a=0;for(a=0;a<e.length;a+=1)r=e[a],void 0!==r.data&&void 0!==r.data.endDate?(r=r.data,void 0===n?n=r:(r.endDateMillis>n.endDateMillis&&(n.endDateMillis=r.endDateMillis,n.endDate=r.endDate),r.startDateMillis<n.startDateMillis&&(n.startDateMillis=r.startDateMillis,n.startDate=r.startDate))):B.log("No data available for {0} sources {1}",u[a].keyDescription(),t[a].sourceIds.join(","));return n}var i=n(),u=[];void 0===a&&(a=r,r=e.json),function(){var e,n,a;for(e=0;e<t.length;e+=1)a=t[e].nodeUrlHelper?t[e].nodeUrlHelper:t[e].locationUrlHelper?t[e].locationUrlHelper:t[e].urlHelper,a&&a.reportableIntervalURL&&(u.push(a),n=a.reportableIntervalURL(t[e].sourceIds),i.defer(r,n))}(),i.awaitAll(function(t,e){if(t)return void B.log("Error requesting available data range: "+t);var n=o(e);void 0!==n.startDateMillis&&(n.sDate=new Date(n.startDateMillis)),void 0!==n.endDateMillis&&(n.eDate=new Date(n.endDateMillis)),"function"==typeof a&&a(n)})}function I(t,n,r){if(void 0===r&&(r=n,n=e.json),t&&t.availableSourcesURL&&r){var a=t.availableSourcesURL();n(a,function(t,e){var n;t?r(t):e?e.success!==!0?r(e.message?e.message:"Query not successful."):(n=Array.isArray(e.data)?e.data.sort():[],n.sort(),r(null,n)):r("No data returned from "+a)})}}function A(t,e){"function"==typeof e&&(void 0===W&&(W=[]),t=t.replace(/[^0-9a-zA-Z_]/,""),W.push({name:t,func:e}))}function w(t){if(void 0!==t){var n=e.select(t).style("width");if(!n)return null;var r=n.match(/([0-9.]+)px/);if(null===r)return null;var a=Math.floor(r[1]);return isNaN(a)?null:a}}function M(t){return t.getUTCMonth()<2||11===t.getUTCMonth()?3:t.getUTCMonth()<5?0:t.getUTCMonth()<8?1:2}function P(t){return t*Math.PI/180}function R(t){return 180*t/Math.PI}function U(t,n){var r,a,o,i=e.scale.ordinal().range(t),u=n.map(function(t,e){return{source:t,color:i(e)}});for(r=0,a=u.length;a>r;r+=1)o=u[r].source,""===o&&(o="Main"),isNaN(Number(o))&&(u[o]=u[r].color);return u}function O(t){var e=Number(t.source);return isNaN(e)?B.runtime.colorData[t.source]:B.runtime.colorData.reduce(function(e,n){return n.source===t.source?n.color:e},B.runtime.colorData[0].color)}function N(e,n){function r(t){e[t].forEach(function(e){var n;n=""===e||"Main"===e?l(t):l(t)+" / "+s(t,e),f[t][e]=n,"Main"===e&&(f[t][""]=n),m.push(n),p.push(n),g[n]={dataType:t,source:e,display:n}})}var a,o,i,u,l,s,c,d=n||{},f={},p=[],v=[],m=[],h={},g={};l="function"==typeof d.displayDataType?d.displayDataType:function(t){return"Power"===t?"Generation":t},s="function"==typeof d.displaySource?d.displaySource:function(t,e){return e},c="function"==typeof d.displayColor?d.displayColor:function(e){return"Consumption"===e?t.Blues:t.Greens};for(a in e)e.hasOwnProperty(a)&&(f[a]={},m.length=0,r(a),o=c(a),i=void 0===o[m.length]?function(){var t;for(t=m.length;30>t;t+=1)if(void 0!==o[t])return t;return 0}():m.length,u=o[i].slice(-m.length),d.reverseColors!==!1&&u.reverse(),v=v.concat(u));var y,x,b={};for(a in f)if(f.hasOwnProperty(a)){b[a]={},x=f[a];for(y in x)x.hasOwnProperty(y)&&(b[x[y]]=y)}return h.sourceList=p,h.displaySourceMap=f,h.reverseDisplaySourceMap=b,h.colorMap=B.color.map(v,p),h.displaySourceObjects=g,h}function L(){var t=0,e=function(){return t};return e.incrementAndGet=function(){return t+=1},e}function E(t){var e=1,n=Number(t);return isNaN(n)===!1&&(t>=1e9?e=1e9:t>=1e6?e=1e6:t>=1e3&&(e=1e3)),e}function F(t,e){return(1e9===e?"G":1e6===e?"M":1e3===e?"k":"")+t}function S(){if(arguments.length){var t,e,n=0,r=arguments[n];for(n=1;n<arguments.length;n+=1)t=new RegExp("\\{"+(n-1)+"\\}","gi"),e=arguments[n],e instanceof Date&&(e=0===e.getUTCHours()&&0===e.getMinutes()?B.format.dateFormat(e):B.format.dateTimeFormatURL(e)),r=r.replace(t,e);return r}}function j(t){function e(t,e){i.length&&(i+="&"),i+=encodeURIComponent(t)+"="+encodeURIComponent(e)}var n,r,a,o,i="";if(t)for(n in t)if(t.hasOwnProperty(n))if(r=t[n],Array.isArray(r))for(a=0,o=r.length;o>a;a++)e(n,r[a]);else e(n,r);return i}function H(t,n,r,a){var o=e.select(t).selectAll("table").data([0]);o.enter().append("table").append("tbody");var i=o.select("tbody").selectAll("tr").data(n),u=i.enter().append("tr");i.exit().remove(),r&&u.on("click",r).classed("clickable",!0),void 0===a&&(a=function(t){t.text(Object)});var l=i.selectAll("td.swatch").data(function(t){return[t.color]}).style("background-color",Object);l.enter().append("td").attr("class","swatch").style("background-color",Object),l.exit().remove();var s=i.selectAll("td.desc").data(function(t){return[""===t.source?"Main":t.source]}).call(a);s.enter().append("td").attr("class","desc").call(a),s.exit().remove()}var B={version:"0.11.1"};B.api={};var z=e.time.format.utc("%Y-%m-%d %H:%M:%S.%LZ");B.api.control={},B.api.user={},B.api.node={};var G=function(){return"undefined"!=typeof self?self:"undefined"!=typeof G?G:new Function("return this")()}();B.net={},B.net.parseURLQueryTerms=a;var X={debug:!1,host:"data.solarnetwork.net",tls:function(){return void 0!==G&&void 0!==G.location&&void 0!==G.location.protocol&&0===G.location.protocol.toLowerCase().indexOf("https")}(),path:"/solarquery",solarUserPath:"/solaruser",secureQuery:!1};B.env=X,B.setEnv=i,B.setDefaultEnv=o,void 0!==G&&void 0!==G.location&&void 0!==G.location.search&&i(a(G.location.search)),B.config={debug:!1,host:"data.solarnetwork.net",tls:function(){return void 0!==G&&void 0!==G.location&&void 0!==G.location.protocol&&0===G.location.protocol.toLowerCase().indexOf("https")}(),path:"/solarquery",solarUserPath:"/solaruser",secureQuery:!1},B.util={arraysAreEqual:s,copy:u,copyAll:l,superMethod:c},B.api.node.registerUrlHelperFunction=d;var K;B.api.node.nodeUrlHelper=function(t,e){function n(){return"http"+(f.tls===!0?"s":"")+"://"+f.host}function r(){return n()+f.path+"/api/v1/"+(f.secureQuery===!0?"sec":"pub")}function a(t){var e=r()+"/range/interval?nodeId="+d;return Array.isArray(t)&&(e+="&sourceIds="+t.map(function(t){return encodeURIComponent(t)}).join(",")),e}function o(t,e){var n=r()+"/range/sources?nodeId="+d;return void 0!==t&&(n+="&start="+encodeURIComponent(B.format.dateFormat(t))),void 0!==e&&(n+="&end="+encodeURIComponent(B.format.dateFormat(e))),n}function i(t,e,n,a,o){var i=r()+"/datum/list?nodeId="+d;return t&&(i+="&startDate="+encodeURIComponent(B.format.dateTimeFormatURL(t))),e&&(i+="&endDate="+encodeURIComponent(B.format.dateTimeFormatURL(e))),n&&(i+="&aggregate="+encodeURIComponent(n)),Array.isArray(a)&&a.length>0&&(i+="&sourceIds="+a.map(function(t){return encodeURIComponent(t)}).join(",")),void 0!==o&&(o.max>0&&(i+="&max="+encodeURIComponent(o.max)),o.offset>0&&(i+="&offset="+encodeURIComponent(o.offset))),i}function u(t){var e=r()+"/datum/mostRecent?nodeId="+d;return Array.isArray(t)&&(e+="&sourceIds="+t.map(function(t){return encodeURIComponent(t)}).join(",")),e}function l(t){return arguments.length?(d=t,c):d}function s(){return"node "+d}var c={version:"1.1.0"},d=t,f=B.util.copy(e,{host:"data.solarnetwork.net",tls:!0,path:"/solarquery",secureQuery:!1});return Object.defineProperties(c,{secureQuery:{get:function(){return f.secureQuery===!0},enumerable:!0},keyDescription:{value:s},nodeId:{get:function(){return d},enumerable:!0},nodeID:{value:l},hostURL:{value:n},baseURL:{value:r},reportableIntervalURL:{value:a},availableSourcesURL:{value:o},dateTimeListURL:{value:i},mostRecentURL:{value:u}}),function(){Array.isArray(K)&&K.forEach(function(t){c.hasOwnProperty(t.name)===!1&&Object.defineProperty(c,t.name,{value:function(){return t.func.apply(c,arguments)}})})}(),c},B.api.user.registerUrlHelperFunction=p;var _;B.api.user.userUrlHelper=function(t){function e(){return"http"+(i.tls===!0?"s":"")+"://"+i.host}function n(){return e()+i.path+"/api/v1/"+(i.secureQuery===!0?"sec":"pub")}function r(){return"user"}function a(){var t=n()+"/nodes";return t}var o={version:"1.0.0"},i=B.util.copy(t,{host:"data.solarnetwork.net",tls:!0,path:"/solaruser",secureQuery:!0});return Object.defineProperties(o,{keyDescription:{value:r},hostURL:{value:e},baseURL:{value:n},viewNodesURL:{value:a}}),function(){Array.isArray(_)&&_.forEach(function(t){o.hasOwnProperty(t.name)===!1&&Object.defineProperty(o,t.name,{value:function(){return t.func.apply(o,arguments)}})})}(),o},d("viewInstruction",v),d("viewActiveInstructionsURL",m),d("viewPendingInstructionsURL",h),d("updateInstructionStateURL",g),d("queueInstructionURL",y),B.api.control.toggler=function(t){function r(t){if(void 0!==m)try{m.call(h,t)}catch(e){B.log("Error in callback: {0}",e)}}function a(t){if(Array.isArray(t)&&0!==t.length){var e=t.reduce(function(t,e){return"SetControlParameter"===e.topic&&Array.isArray(e.parameters)&&e.parameters.length>0&&e.parameters[0].name===x&&(void 0===t||t.created<e.created)?e:t},void 0);return void 0!==e&&B.log("Active instruction for {3} found in state {0} (set control {1} to {2})",e.state,x,e.parameters[0].value,b.keyDescription()),e}}function o(){return void 0===p?void 0:p.state}function i(){return void 0===p?void 0:Number(p.parameters[0].value)}function u(){return["Queued","Received","Executing"].indexOf(o())<0?g:y}function l(t){if(!arguments.length)return void 0===f?void 0:f.val;var e=n(),a=void 0===f?void 0:f.val,l=o(),s=i();return"Queued"===l&&s!==t&&(B.log("Canceling {2} pending control {0} switch to {1}",x,s,b.keyDescription()),e.defer(C.json,b.updateInstructionStateURL(p.id,"Declined"),"POST"),p=void 0,l=void 0,s=void 0),a!==t&&s!==t&&(B.log("Request {2} to change control {0} to {1}",x,t,b.keyDescription()),e.defer(C.json,b.queueInstructionURL("SetControlParameter",[{name:x,value:String(t)}]),"POST")),e.awaitAll(function(t,e){if(t)return B.log("Error updating {2} control toggler {0}: {1}",x,t.status,b.keyDescription()),void r(t);if(!(e.length<1)){var n=e[0];null==n.data&&n.success===!0&&(p=void 0);var a=e[e.length-1].data;null!=a&&(p=a),r(),d&&(h.stop(),h.start(u()))}}),h}function s(t,e){var n,r;return e&&"Declined"!==e.status?t?(n=z.parse(t.created),r=z.parse(e.created),n.getTime()>r.getTime()?t.val:Number(e.parameters[0].value)):Number(e.parameters[0].value):t?t.val:void 0}function c(){var t=n();return t.defer(b.secureQuery?C.json:e.json,b.mostRecentURL([x])),C.hasTokenCredentials()===!0&&(t.defer(C.json,b.viewPendingInstructionsURL(),"GET"),p&&["Completed","Declined"].indexOf(o())<0&&t.defer(C.json,b.viewInstruction(p.id))),t.await(function(t,e,n,o){if(t)B.log("Error querying control toggler {0} for {2} status: {1}",x,t.status,b.keyDescription()),r(t);else{var i,m,h=void 0;if(e.data&&Array.isArray(e.data.results))for(i=0,m=e.data.results.length;m>i&&void 0===h;i++)e.data.results[i].sourceId===x&&(h=e.data.results[i]);var g=o?o.data:void 0,y=n?a(n.data):void 0,D=s(h,g?g:y?y:p),T=l();D===T&&v===C.hasTokenCredentials()||(B.log("Control {0} for {1} value is currently {2}",x,b.keyDescription(),void 0!==D?D:"N/A"),f=h,f&&!y&&(f.val=D),p=g?g:y,v=C.hasTokenCredentials(),r())}void 0!==d&&(d=setTimeout(c,u()))}),h}var d,f,p,v,m,h={version:"1.3.0"},g=2e4,y=5e3,x="/power/switch/1",b=t,C=B.net.sec;return h.start=function(t){return void 0===d&&(d=setTimeout(c,t||20)),h},h.stop=function(){return void 0!==d&&(clearTimeout(d),d=void 0),h},h.controlID=function(t){return arguments.length?(x=t,h):x},h.refreshMs=function(t){return arguments.length?("number"==typeof t&&(g=t),h):g},h.pendingRefreshMs=function(t){return arguments.length?("number"==typeof t&&(y=t),h):y},h.nodeUrlHelper=function(t){return arguments.length?(b=t,h):b},h.callback=function(t){return arguments.length?("function"==typeof t&&(m=t),h):m},Object.defineProperties(h,{pendingInstructionState:{value:o},pendingInstructionValue:{value:i},lastKnownInstructionState:{value:o},lastKnownInstructionValue:{value:i},value:{value:l}}),h},B.api.datum={},B.api.datum.aggregateNestedDataLayers=x,B.format={},B.format.dateTimeFormat=e.time.format.utc("%Y-%m-%d %H:%M"),B.format.timestampFormat=e.time.format.utc("%Y-%m-%d %H:%M:%S.%LZ"),B.format.dateTimeFormatLocal=e.time.format("%Y-%m-%d %H:%M"),B.format.dateTimeFormatURL=e.time.format.utc("%Y-%m-%dT%H:%M"),B.format.dateFormat=e.time.format.utc("%Y-%m-%d"),B.api.datum.datumDate=b,B.log=C,B.api.datum.loader=function(t,n,r,a,o){function i(t){return"function"==typeof t&&(s=t),v=1,l(),i}function u(t){v=2,s&&s.call(f,t,d)}function l(e){var i,s,f,v={};e&&(v.offset=e),i=n.dateTimeListURL(r,a,o,t,v),c&&!function(){var t=j(c);t.length&&(i+="&"+t)}(),s=function(t){return t.success===!0&&void 0!==t.data&&Array.isArray(t.data.results)===!0?t.data.results:void 0},f=function(t){return t.data.returnedResultCount+t.data.startingOffset<t.data.totalResults?t.data.returnedResultCount+t.data.startingOffset:0},p(i,function(t,e){var r,a;return t?void B.log("Error requesting data for {0}: {2}",n.keyDescription(),t):(r=s(e),void 0===r?(B.log("No data available for {0}",n.keyDescription()),void u(t)):(d=void 0===d?r:d.concat(r),a=f(e),void(a>0?l(a):u(t))))})}var s,c,d,f=i,p=e.json,v=0;return Object.defineProperties(f,{version:{value:"1.1.0"}}),f.callback=function(t){return arguments.length?("function"==typeof t&&(s=t),f):s},f.urlParameters=function(t){return arguments.length?("object"==typeof t&&(c=t),f):c},f.jsonClient=function(t){return arguments.length?("function"==typeof t&&(p=t),f):p},f.load=i,f},B.api.datum.loaderQueryRange=D,B.api.datum.multiLoader=function(t){function e(e){return"function"==typeof e&&(a=e),t.forEach(function(t){o.defer(t.load)}),o.awaitAll(function(t,e){a&&a.call(r,t,e)}),r}var r=e;r.version="1.0.0";var a,o=n();return r.callback=function(t){return arguments.length?("function"==typeof t&&(a=t),r):a},r.load=e,r},B.api.datum.nestedStackDataNormalizeByDate=T,B.api.datum.sumCounter=function(t){function e(t){var e=0;return t.forEach(function(t){var n=Number(t[c]);isNaN(n)&&(n=0),e+=n}),e}function n(n){B.api.datum.loader(s,t,null,null,"RunningTotal").callback(function(t,r){var a=t?0:e(r);f=a,n()}).load()}function r(){function t(){i&&i.call(l,f),void 0!==u&&(u=setTimeout(r,d))}n(t)}function a(){return void 0===u?(u=setTimeout(r,20),l):void 0}function o(){return void 0!==u?(clearTimeout(u),u=void 0,l):void 0}var i,u,l={version:"1.1.0"},s=["Main"],c="wattHours",d=6e4,f=0;return l.callback=function(t){return arguments.length?("function"==typeof t&&(i=t),l):i},l.sourceIds=function(t){return arguments.length?(Array.isArray(t)?s=t:"string"==typeof t&&(s=t.split(/\s*,\s*/)),l):s},Object.defineProperties(l,{start:{value:a},stop:{value:o}}),l},B.api.node.availableDataRange=k,B.api.node.availableSources=I,B.api.loc={},B.api.loc.registerUrlHelperFunction=A;var W;return B.api.loc.locationUrlHelper=function(t,e){function n(){return"http"+(f.tls===!0?"s":"")+"://"+f.host}function r(){return n()+f.path+"/api/v1/"+(f.secureQuery===!0?"sec":"pub")}function a(t){var e=r()+"/location/datum/interval?locationId="+d;return Array.isArray(t)&&(e+="&sourceIds="+t.map(function(t){return encodeURIComponent(t)}).join(",")),e}function o(t,e){var n=r()+"/location/datum/sources?locationId="+d;return void 0!==t&&(n+="&start="+encodeURIComponent(B.format.dateFormat(t))),void 0!==e&&(n+="&end="+encodeURIComponent(B.format.dateFormat(e))),n}function i(t,e,n,a,o){var i=r()+"/location/datum/list?locationId="+d;return t&&(i+="&startDate="+encodeURIComponent(B.format.dateTimeFormatURL(t))),e&&(i+="&endDate="+encodeURIComponent(B.format.dateTimeFormatURL(e))),n&&(i+="&aggregate="+encodeURIComponent(n)),Array.isArray(a)&&(i+="&sourceIds="+a.map(function(t){return encodeURIComponent(t)}).join(",")),void 0!==o&&(o.max>0&&(i+="&max="+encodeURIComponent(o.max)),o.offset>0&&(i+="&offset="+encodeURIComponent(o.offset))),i}function u(t){var e=r()+"/location/datum/mostRecent?locationId="+d;return Array.isArray(t)&&(e+="&sourceIds="+t.map(function(t){return encodeURIComponent(t)}).join(",")),e}function l(t){return arguments.length?(d=t,c):d}function s(){return"node "+nodeId}var c={version:"1.0.0"},d=t,f=B.util.copy(e,{host:"data.solarnetwork.net",tls:!0,path:"/solarquery",secureQuery:!1});return Object.defineProperties(c,{keyDescription:{value:s},locationId:{get:function(){return d},enumerable:!0},locationID:{value:l},hostURL:{value:n},baseURL:{value:r},reportableIntervalURL:{value:a},availableSourcesURL:{value:o},dateTimeListURL:{value:i},mostRecentURL:{value:u}}),function(){Array.isArray(W)&&W.forEach(function(t){c.hasOwnProperty(t.name)===!1&&Object.defineProperty(c,t.name,{value:function(){return t.func.apply(c,arguments)}})})}(),c},B.chart={},B.Configuration=function(t){if(this.map={},void 0!==t){var e=this;!function(){var n,r=function(t){return function(){return e.map[t]}},a=function(t){return function(n){e.map[t]=n}};for(n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:r(n),set:a(n)}),e.map[n]=t[n]}()}},B.Configuration.prototype={enabled:function(t){return void 0===t?!1:void 0!==this.map[t]},toggle:function(t,e){var n=e;return void 0===t?this:(void 0===n&&(n=void 0===this.map[t]),this.value(t,n===!0?!0:null))},value:function(t,e){var n=this;return 1===arguments.length?this.map[t]:(null===e?(delete this.map[t],this.hasOwnProperty(t)&&delete this[t]):(this.map[t]=e,this.hasOwnProperty(t)||Object.defineProperty(this,t,{enumerable:!0,configurable:!0,get:function(){return n.map[t]},set:function(e){n.map[t]=e}})),this)}},B.ui={},B.ui.pixelWidth=w,B.chart.baseTimeChart=function(t,n){function r(t,e,n){var r=B.tapEventNames[t];r&&(e.on(r)||e.on(r,n),et[r]+=1)}function a(t,e,n){var r=B.tapEventNames[t];r&&(et[r]-=1,et[r]<1&&e.on(r,null))}function o(){var t=e.event,n=(new Date).getTime(),r=n-nt.time,a=this;nt.time=n,"dblclick"===t.type||B.hasTouchSupport&&500>r?(nt.timer&&(clearTimeout(nt.timer),delete nt.timer),ft.call(a)):B.hasTouchSupport?(nt.timer=setTimeout(function(){var n=e.event;try{e.event=t,dt.call(a)}finally{e.event=n}},500),t.preventDefault()):dt.call(a)}function i(){var n=B.ui.pixelWidth(t);k=W.padding||[10,0,20,30],I=(W.width||n||812)-k[1]-k[3],A=(W.height||300)-k[0]-k[2],w=e.time.scale.utc().range([0,I]),M=e.scale.linear().range([A,0])}function u(){i(),G.aggregate(W.aggregate),G.plotProperties(W.value("plotProperties")),U=W.value("transitionMs")||600,O=W.value("ruleOpacity")||.1,N=W.value("vertRuleOpacity")||.05}function l(){L=e.select(t),L.node()&&"svg"!==L.node().tagName.toLowerCase()&&(L=L.select("svg"),L.empty()&&(L=e.select(t).append("svg:svg")),L.attr("class","chart").attr("width",I+k[1]+k[3]).attr("height",A+k[0]+k[2]).selectAll("*").remove()),F=L.append("g").attr("class","data-root").attr("transform","translate("+k[3]+","+k[0]+")"),E=L.append("g").attr("class","ticks").attr("transform","translate("+k[3]+","+(A+k[0]+k[2])+")"),L.append("g").attr("class","crisp rule").attr("transform","translate(0,"+k[0]+")"),S=L.append("g").attr("class","rule").attr("transform","translate("+k[3]+","+k[0]+")"),j=L.append("g").attr("class","annot-root").attr("transform","translate("+k[3]+","+k[0]+")")}function s(){var t,n=e.max(M.domain(),function(t){return Math.abs(t)});rt=1,Y?rt=Y.call(X,n):n>=1e9?rt=1e9:n>=1e6?rt=1e6:n>=1e3&&(rt=1e3),t=1===rt?",d":",g",at=e.format(t)}function c(t){return at(t/rt)}function d(){return R[P]}function f(){return R[P]+"Reverse"}function p(){s()}function v(t){return"translate(0,"+(Math.round(M(t)+.5)-.5)+")"}function m(t){return 0===t?"origin":"m"}function h(t){return 0===t?"origin":null}function g(t){return P.indexOf("Minute")>=0&&0===t.getUTCHours()||"Hour"===P&&0===t.getUTCHours()||"Day"===P&&1===t.getUTCDate()||"Month"===P&&0===t.getUTCMonth()}function y(){return w.ticks(ot)}function x(){var t=w.tickFormat(ot);return function(e,n){return Q?Q.call(X,e,n,w,t):t(e,n)}}function b(){e.event&&e.event.transform&&e.event.transform(w);var t=y(),n=x(),r=E.selectAll("text").data(t).classed({major:g});r.transition().duration(U).attr("x",w).text(n),r.enter().append("text").attr("dy","-0.5em").style("opacity",1e-6).attr("x",w).classed({major:g}).transition().duration(U).style("opacity",1).text(n).each("end",function(){e.select(this).style("opacity",null)}),r.exit().transition().duration(U).style("opacity",1e-6).remove()}function C(){return M.ticks(it)}function D(){var t=C(),n=L.select("g.rule").selectAll("g").data(t,Object),r=n.transition().duration(U);r.attr("transform",v).select("text").attr("x",k[3]-10).text(c).attr("class",h),r.select("line").attr("x2",I+k[3]).attr("x1",k[3]).attr("class",m),n.exit().transition().duration(U).style("opacity",1e-6).remove();var a=n.enter().append("g").style("opacity",1e-6).attr("transform",v);a.append("line").attr("x2",I+k[3]).attr("x1",k[3]).attr("class",m),a.append("text").attr("x",k[3]-10).text(c).attr("class",h),a.transition().duration(U).style("opacity",1).each("end",function(){e.select(this).style("opacity",null)})}function T(){return H||(H=L.append("g").attr("class","hover-root").attr("transform","translate("+k[3]+","+k[0]+")"),z=L.append("rect").attr("width",I).attr("height",A).attr("fill","none").attr("pointer-events","all").attr("class","pointer-capture").attr("transform","translate("+k[3]+","+k[0]+")")),z}var k,I,A,w,M,P,R,U,O,N,L,E,F,S,j,H,z,G={version:"1.0.0"},X=G,K="__internal__",_=["FiveMinute","TenMinute","FifteenMinute","Hour","HourOfDay","SeasonalHourOfDay","Day","DayOfWeek","SeasonalDayOfWeek","Month"],W=n||new B.Configuration,Y=void 0,q=void 0,Q=void 0,V=void 0,Z=void 0,J=void 0,$=void 0,tt=void 0,et=function(){var t={};return Object.keys(B.tapEventNames).forEach(function(e){t[B.tapEventNames[e]]=0}),t}(),nt={time:0},rt=1,at=e.format(",d"),ot=12,it=5,ut=function(){b(),D()},lt=function(){V&&V.call(X,H,B.tapCoordinates(this))},st=function(){Z&&Z.call(X,H,B.tapCoordinates(this))},ct=function(){J&&J.call(X,H,B.tapCoordinates(this))},dt=function(){clickCallback&&clickCallback.call(X,H,B.tapCoordinates(this))},ft=function(){tt&&tt.call(X,H,B.tapCoordinates(this))};return G.scaleDate=function(t){return w(t)},G.scaleValue=function(t){return M(t)},G.xDomain=function(){return w.domain()},G.yDomain=function(){return M.domain()},G.yScale=function(){return Y?Y():rt},G.aggregate=function(t){if(!arguments.length)return P;var e=_.indexOf(t);return P=0>e?"Hour":t,X},G.aggregateNormalizedDuration=function(){return"FiveMinute"===P?3e5:"TenMinute"===P?6e5:"FifteenMinute"===P?9e5:"Hour"===P||"HourOfDay"===P||"SeasonalHourOfDay"===P?36e5:"Day"===P||"DayOfWeek"===P||"SeasonalDayOfWeek"===P?864e5:"Month"===P?2592e6:6e4},G.isNormalizedDuration=function(t,n){var r,a,o=G.aggregateNormalizedDuration();return t&&n?(r=Math.abs(n.getTime()-t.getTime()),r===o?!0:(n.getTime()<t.getTime()&&(a=t,t=n,n=a),"Month"===P?e.time.month.utc.offset(t,1).getTime()===n.getTime():"SeasonalHourOfDay"===P?(a=t.getUTCHours()+1,a>23&&(a=0),n.getUTCHours()===a&&t.getTime()!==n.getTime()):"SeasonalDayOfWeek"===P?(a=t.getUTCDay()+1,a>6&&(a=0),n.getUTCDay()===a&&t.getTime()!==n.getTime()):!1)):!1},G.addNormalizedDuration=function(t){return t?"Month"===P?e.time.month.utc.offset(t,1):new Date(t.getTime()+G.aggregateNormalizedDuration()):void 0},G.reset=function(){return H&&ct(),X},G.regenerate=function(){return u(),G.setup(),G.draw(),q&&q.call(X,j),X},G.transitionMs=function(t){return arguments.length?(U=+t,X):U},G.plotProperties=function(t){if(!arguments.length)return R;var e={};return _.forEach(function(n){e[n]=void 0!==t&&void 0!==t[n]?t[n]:"watts"}),R=e,X},G.displayFactorCallback=function(t){return arguments.length?(Y="function"==typeof t?t:void 0,X):Y},G.drawAnnotationsCallback=function(t){return arguments.length?(q="function"==typeof t?t:void 0,X):q},G.hoverEnterCallback=function(t){if(!arguments.length)return V;var e=T();return"function"==typeof t?(V=t,e.on("mouseover",lt)):(V=void 0,e.on("mouseover",null)),X},G.hoverMoveCallback=function(t){if(!arguments.length)return Z;var e=T();return"function"==typeof t?(T(),Z=t,e.on("mousemove",st)):(Z=void 0,e.on("mousemove",null)),X},G.hoverLeaveCallback=function(t){if(!arguments.length)return J;var e=T();return"function"==typeof t?(J=t,e.on("mouseout",ct)):(J=void 0,e.on("mouseout",null)),X},G.doubleClickCallback=function(t){if(!arguments.length)return tt;var e=T();return"function"==typeof t?(tt=t,r("dblclick",e,o)):(tt=void 0,a("dblclick",e,o)),X},G.rangeSelectionCallback=function(t){if(!arguments.length)return $;var e=T();return"function"==typeof t?($=t,r("click",e,o)):($=void 0,a("click",e,o)),X},G.xAxisTickCallback=function(t){return arguments.length?("function"==typeof t&&(Q=t),X):Q},G.ruleOpacity=function(t){return arguments.length?(O=t,X):O},G.vertRuleOpacity=function(t){return arguments.length?(N=t,X):N},u(),l(),Object.defineProperties(G,{me:{get:function(){return X},set:function(t){X=t}},x:{get:function(){return w},set:function(t){w=t}},y:{get:function(){return M},set:function(t){M=t}},xAxisTickCount:{get:function(){return ot},set:function(t){ot=t}},xAxisTicks:{get:function(){return y},set:function(t){y=t}},xAxisTickFormatter:{get:function(){return x},set:function(t){x=t}},yAxisTicks:{get:function(){return C},set:function(t){C=t}},yAxisTickCount:{get:function(){return it},set:function(t){it=t}},config:{value:W},internalPropName:{value:K},plotPropertyName:{get:d},plotReversePropertyName:{get:f},padding:{value:k},width:{value:I,enumerable:!0},height:{value:A,enumerable:!0},svgRoot:{value:L},svgDataRoot:{value:F},svgRuleRoot:{value:S},svgTickGroupX:{value:E},svgHoverRoot:{get:function(){return H}},handleHoverEnter:{get:function(){return lt},set:function(t){lt=t}},handleHoverMove:{get:function(){return st},set:function(t){st=t}},handleHoverLeave:{get:function(){return ct},set:function(t){ct=t}},handleClick:{get:function(){return dt},set:function(t){dt=t}},handleDoubleClick:{get:function(){return ft},set:function(t){ft=t}},computeUnitsY:{value:s},drawAxisX:{get:function(){return b},set:function(t){b=t}},drawAxisY:{get:function(){return D},set:function(t){D=t}},parseConfiguration:{get:function(){return u},set:function(t){u=t}},draw:{get:function(){return ut},set:function(t){ut=t}},setup:{get:function(){return p},set:function(t){p=t}}}),G},B.chart.baseGroupedTimeChart=function(t,e){function n(t,e,n){return void 0===d?"black":d(t,e.sourceId,n)}function r(t){var e,n,r,a,o=i.plotPropertyName,u=i.plotReversePropertyName;for(n=0;n<t.length;n+=1)for(r=t[n].values,e=0;e<r.length-1;e+=1)i.isNormalizedDuration(r[e].date,r[e+1].date)!==!0&&(a=B.util.copy(r[e]),a.date=i.addNormalizedDuration(a.date),a[o]=null,a[u]=null,r.splice(e+1,0,a))}var a=B.chart.baseTimeChart(t,e),o=a.reset,i=l(a);i.me=i;var u={},s={},c=void 0,d=void 0,f=void 0,p=void 0,v=[],m={};return i.reset=function(){return o(),u={},v=[],m={},i.me},i.load=function(t,e){return void 0===u[e]?(v.push(e),u[e]=t):u[e]=u[e].concat(t),i.me},i.data=function(t){return u[t]},i.stash=function(t,e,n){return void 0===m[e]||n===!0?m[e]=t:m[e]=m[e].concat(t),i.me},i.stashedData=function(t){return m[t]},i.scaleFactor=function(t,e){var n;if(!arguments.length)return s;if(1===arguments.length){if("string"==typeof t)return n=s[t],void 0===n?1:n;s=t}else 2==arguments.length&&(s[t]=e);return i.me},i.dataCallback=function(t){return arguments.length?(c="function"==typeof t?t:void 0,i.me):c},i.colorCallback=function(t){return arguments.length?(d="function"==typeof t?t:void 0,i.me):d},i.sourceExcludeCallback=function(t){return arguments.length?(f="function"==typeof t?t:void 0,i.me):f},i.layerPostProcessCallback=function(t){return arguments.length?(p="function"==typeof t?t:void 0,i.me):p},Object.defineProperties(i,{fillColor:{value:n},insertNormalizedDurationIntoLayerData:{value:r},groupIds:{get:function(){return v}}}),i},B.color={},B.color.colors={steelblue:["#356287","#4682b4","#6B9BC3","#89AFCF","#A1BFD9","#B5CDE1","#DAE6F0"],
triplets:["#3182bd","#6baed6","#9ecae1","#e6550d","#fd8d3c","#fdae6b","#31a354","#74c476","#a1d99b","#756bb1","#9e9ac8","#bcbddc","#843c39","#ad494a","#d6616b","#8c6d31","#bd9e39","#e7ba52","#7b4173","#a55194","#ce6dbd"],seasonColors:["#5c8726","#e9a712","#762123","#80a3b7"]},B.format.seasonForDate=M,B.chart.baseGroupedSeasonalLineChart=function(t,n){function r(t,e){var n=p.config.seasonColors||B.color.colors.seasonColors,r=(e+(g?0:2))%4;return n[r]}function a(t){return new Date(Date.UTC(2001,0,1)+t)}function o(t){t.getTime()}function i(){return e.time.day.utc}function u(t){var e,n,r,o,i,u,l=null,s=null,c=null,d=t.length,f=!1;for(r=0;d>r;r+=1)e=t[r],o=e[p.internalPropName].groupId,p.sourceExcludeCallback()&&p.sourceExcludeCallback().call(p.me,o,e.sourceId)||(n=e[p.plotPropertyName],void 0!==n&&(f=x[o]===!0,f?c+=n:s+=n),e.date&&((void 0===i||e.date.getTime()<i.getTime())&&(i=e.date),(void 0===u||e.date.getTime()>u.getTime())&&(u=e.date)));return null===s&&null===c||(l=s-c),{date:a(t[0].timeKey),y:l,plus:s,minus:c,season:t[0].season,timeKey:t[0].timeKey,groupId:t[0][p.internalPropName].groupId}}function l(){var t=p.groupIds,n=[null,null],r=[0,0],a=i(),l=e.format("02g");y={},t.forEach(function(t){var a,i,s,c=p.data(t);!c||!c.length>1||(a=e.nest().key(function(e){return e.hasOwnProperty(p.internalPropName)||(e[p.internalPropName]={groupId:t},p.dataCallback()?p.dataCallback().call(p.me,t,e):void 0===e.date&&(e.date=B.api.datum.datumDate(e)),e.season=B.format.seasonForDate(e.date),e.timeKey=o(e.date)),e.season}).key(function(t){return l(t.timeKey)}).sortKeys(e.ascending).rollup(u).entries(c),a.length<1||(p.layerPostProcessCallback()&&(a=p.layerPostProcessCallback().call(p.me,t,a)),y[t]=a,i=a.reduce(function(t,e){return t.concat(e.values.map(function(t){return t.values}))},[]),s=e.extent(i,function(t){return t.y}),s[0]<r[0]&&(r[0]=s[0]),s[1]>r[1]&&(r[1]=s[1]),s=e.extent(i,function(t){return t.date.getTime()}),(null===n[0]||s[0]<n[0].getTime())&&(n[0]=new Date(s[0])),(null===n[1]||s[1]>n[1].getTime())&&(n[1]=new Date(s[1]))))}),p.x.domain(a.range(n[0],a.offset(n[1],1))),p.y.domain(r).nice(),p.computeUnitsY()}function s(t){return Math.round(p.x(t)+.5)-.5}function c(){var t=p.transitionMs(),n=p.svgRuleRoot.selectAll("line.vert").data(p.x.domain());n.transition().duration(t).attr("x1",s).attr("x2",s),n.enter().append("line").style("opacity",1e-6).classed("vert",!0).attr("x1",s).attr("x2",s).attr("y1",0).attr("y2",p.height).transition().duration(t).style("opacity",p.vertRuleOpacity()).each("end",function(){e.select(this).style("opacity",null)}),n.exit().transition().duration(t).style("opacity",1e-6).remove()}function d(){var t=[[],[],[],[]],e=p.groupIds;return e.forEach(function(e){var n=y[e];n&&n.forEach(function(e){var n=Number(e.key);t[n].push(e.values.map(function(t){return t.values}))})}),{groupedData:t}}function f(){var t,e,n,a=p.transitionMs();n=d(),t=p.svgDataRoot.selectAll("g.season").data(n.groupedData),t.enter().append("g").attr("class","season").style("stroke",r),e=t.selectAll("path.line").data(Object,function(t){return t[0].groupId}),e.transition().duration(a).attr("d",b),e.enter().append("path").classed("line",!0).attr("d",b),e.exit().transition().duration(a).style("opacity",1e-6).remove(),v(),c()}var p=B.chart.baseGroupedTimeChart(t,n),v=B.util.superMethod.call(p,"draw"),m=B.util.copyAll(p,{version:"1.0.0"});m.me=m;var h=["Midnight","1am","2am","3am","4am","5am","6am","7am","8am","9am","10am","11am","Noon","1pm","2pm","3pm","4pm","5pm","6pm","7pm","8pm","9pm","10pm","11pm"];p.x=e.scale.ordinal().rangePoints([0,p.width],.2),p.xAxisTicks=function(){return p.x.domain()},p.xAxisTickFormatter=function(){return function(t,e){return p.xAxisTickCallback()?xAxisTickCallback().call(p.me,t,e,p.x):h[p.x.domain().indexOf(t)]}};var g,y,x={Consumption:!0},b=e.svg.line().interpolate("monotone").x(function(t){return Math.round(p.x(t.date)+.5)-.5}).y(function(t){return Math.round(p.y(t.y)+.5)-.5});return m.northernHemisphere=function(t){return arguments.length?t===g?p.me:(g=t===!0,p.svgDataRoot.selectAll("g.season").transition().duration(p.transitionMs()).style("stroke",r),p.me):g},m.negativeGroupIds=function(t){return arguments.length?(x={},t.forEach(function(t){x[t]=!0}),p.me):function(){var t,e=[];for(t in x)x.hasOwnProperty(t)&&e.pus(t);return e}()},m.timeKeyLabels=function(t){return arguments.length?(Array.isArray(t)&&(h=t),p.me):h},Object.defineProperties(m,{dateForTimeKey:{get:function(){return a},set:function(t){a=t}},timeKeyForDate:{get:function(){return o},set:function(t){o=t}},timeKeyInterval:{get:function(){return i},set:function(t){i=t}}}),p.setup=l,p.draw=f,m},B.chart.baseGroupedStackTimeChart=function(t,n){function r(){d(),m=p.config.value("wiggle")===!0?"wiggle":"zero",h=p.config.value("reverseValueSupport")===!0}function a(t,e){var n=p.config.value("opacityReduction")||.1;return 1-e*n}function o(t){var n,r=p.plotReversePropertyName;return n="zero"!==m?e.layout.stack().offset(m).offset():function(e){var n,a,o,i,u,l=e[0].length,s=e.length,c=[];for(n=0;l>n;n+=1){for(o=0,a=0;s>a;a+=1)i=e[a][n][1],u=h?t[a].values[n][r]:0,0>i?(o+=i,e[a][n][1]=-i):u&&(o-=u);c[n]=o}return c}}function i(){var t,n,r,a,i=p.plotPropertyName,u=p.plotReversePropertyName,l=e.layout.stack().values(function(t){return t.values}).x(function(t){return t.date}).y(function(t){var e=t[i],n=0,r=s.scaleFactor(t[s.internalPropName].groupId);return void 0===e||null===e||"zero"!==m&&0>e?e=0:h&&"zero"===m&&void 0!==t[u]&&(n=t[u]),(e+n)*r});g={},p.groupIds.forEach(function(u){var c,d,f=p.data(u);if(f&&!(!f.length>1)&&(d=e.nest().key(function(t){return t.hasOwnProperty(p.internalPropName)||(t[p.internalPropName]={groupId:u},p.dataCallback()?p.dataCallback().call(p.me,u,t):void 0===t.date&&(t.date=B.api.datum.datumDate(t))),p.sourceExcludeCallback()&&p.sourceExcludeCallback().call(p.me,u,t.sourceId)?v:t.sourceId}).sortKeys(e.ascending).entries(f),d=d.filter(function(t){return t.key!==v}),!(d.length<1))){c={},c[i]=null,c[p.internalPropName]={groupId:u},B.api.datum.nestedStackDataNormalizeByDate(d,c),y===!0&&s.insertNormalizedDurationIntoLayerData(d),p.layerPostProcessCallback()&&(d=p.layerPostProcessCallback().call(p.me,u,d));var m=[f[0].date,f[f.length-1].date];(void 0===t||m[0].getTime()<t.getTime())&&(t=m[0]),(void 0===n||m[1].getTime()>n.getTime())&&(n=m[1]),l.offset(o(d));var h=l(d);g[u]=h;var x=[e.min(h[0].values,function(t){return t.y0}),e.max(h[h.length-1].values,function(t){return t.y0+t.y})];(void 0===r||x[0]<r)&&(r=x[0]),(void 0===a||x[1]>a)&&(a=x[1])}}),void 0!==t&&void 0!==n&&p.x.domain([t,n]),void 0!==r&&void 0!==a&&p.y.domain([r,a]).nice(),p.computeUnitsY()}function u(){return p.wiggle()===!0?[]:f()}var s=B.chart.baseGroupedTimeChart(t,n),c=s.reset,d=s.parseConfiguration,f=s.yAxisTicks,p=l(s);p.me=p;var v="__discard__",m=void 0,h=!0,g={},y=!1;return p.reset=function(){return c(),g={},p.me},p.stackOffset=function(t){return arguments.length?(m=t,p.me):m},p.wiggle=function(t){return arguments.length?p.stackOffset(t===!0?"wiggle":"zero"):"wiggle"===m},p.normalizeDataTimeGaps=function(t){return arguments.length?(y=t===!0,p.me):y},p.enumerateDataOverTime=function(t){if("function"!=typeof t)return p.me;var e,n=p.groupIds,r={},a=p.xDomain()[0];if(!n||n.length<1)return p.me;for(;;)if(e={date:a,data:{}},n.forEach(function(t){var n=g[t];void 0===r[t]&&(r[t]={index:0}),!n||n.length<1||n[0].values.length<=r[t].index||(void 0===r[t].date&&(r[t].date=n[0].values[0].date),n[0].values[r[t].index].date.getTime()===a.getTime()&&(n.forEach(function(n){e.data[n.key]=n.values[r[t].index]}),r[t].index+=1,r[t].date=r[t].index<n[0].values.length?n[0].values[r[t].index].date:null))}),t.call(p.me,e.data,a),a=r[n.reduce(function(t,e){var n=r[t].date,a=r[e].date;return n?a?a>n?t:e:t:e})].date,!a)break;return p.me},Object.defineProperties(p,{negativeOffsetFromReversePlotProperty:{get:function(){return h},set:function(t){h=t}},groupOpacityFn:{value:a},discardId:{value:v},groupLayers:{get:function(){return g}}}),r(),p.parseConfiguration=r,p.setup=i,p.yAxisTicks=u,p},B.chart.baseGroupedStackTimeBarChart=function(t,n){function r(t,e){return I.fillColor.call(this,t[0][I.internalPropName].groupId,t[0],e)}function a(){return I.config.vertRuleOpacity||.05}function o(){var t,n=I.x,r=I.aggregate(),a=n.domain(),o=1,i=a[1];"Month"===r?(i=e.time.month.utc.offset(i,1),t=e.time.months.utc):"Day"===r?(i=e.time.day.utc.offset(i,1),t=e.time.days.utc):"FiveMinute"===r?(o=5,i=e.time.minute.utc.offset(i,o),t=e.time.minutes.utc):"TenMinute"===r?(o=10,i=e.time.minute.utc.offset(i,o),t=e.time.minutes.utc):"FifteenMinute"===r?(o=15,i=e.time.minute.utc.offset(i,o),t=e.time.minutes.utc):(i=e.time.hour.utc.offset(i,1),t=e.time.hours.utc),t=t(a[0],i,o),w.domain(t).rangeRoundBands(n.range(),.2)}function i(t){return t.date}function u(t){return w(t.date)}function s(t){return p(t.date)}function c(t){return Math.floor(u(t)-g()/2)+.5}function d(t){return I.y(t.y0+t.y)}function f(t){return I.y(t.y0)-I.y(t.y0+t.y)}function p(t){return w(t)+w.rangeBand()/2}function v(t){var e=I.aggregate();return"Day"===e&&1===t.getUTCDate()||"Hour"===e&&0===t.getUTCHours()||"Month"===e&&0===t.getUTCMonth()}function m(){var t=I.config.value("tickCountX");return t||(I.width>600?12:5)}function h(){var t=w.domain();return t.length<7?t:I.x.ticks(m())}function g(){var t=w.domain(),e=t.length>1?w(t[1])-w(t[0]):w.rangeBand(),n=e-w.rangeBand();return n}function y(t){for(var e=0,n=t.length,r=I.x.domain()[0];n>e&&!(t[e].date.getTime()>=r.getTime());)e+=1;return 0===e?t:t.slice(e)}function x(){var t=I.x.tickFormat(m()),e=I.xAxisTickCallback();return function(n,r){return e?e.call(I.me,n,r,I.x,t):t(n,r)}}function b(){var t,n=h(),r=I.transitionMs(),a=x();n=n.filter(function(t){return void 0!==w(t)}),t=I.svgTickGroupX.selectAll("text").data(n,Object).classed({major:v}),t.transition().duration(r).attr("x",p).text(a),t.enter().append("text").attr("dy","-0.5em").style("opacity",1e-6).attr("x",p).classed({major:v}).transition().duration(r).style("opacity",1).text(a).each("end",function(){e.select(this).style("opacity",null)}),t.exit().transition().duration(r).style("opacity",1e-6).remove()}function C(t){var e=I.y(0),n=I.transitionMs(),r=t.selectAll("rect").data(Object,i);r.transition().duration(n).attr("x",u).attr("y",d).attr("height",f).attr("width",w.rangeBand()),r.enter().append("rect").attr("x",u).attr("y",e).attr("height",1e-6).attr("width",w.rangeBand()).transition().duration(n).attr("y",d).attr("height",f),r.exit().transition().duration(n).style("opacity",1e-6).remove()}function D(t){var n,r,o=I.transitionMs();r=y(t),n=M.selectAll("line").data(r,i),n.transition().duration(o).attr("x1",c).attr("x2",c),n.enter().append("line").style("opacity",1e-6).attr("x1",c).attr("x2",c).attr("y1",0).attr("y2",I.height+10).transition().duration(o).style("opacity",a()).each("end",function(){e.select(this).style("opacity",null)}),n.exit().transition().duration(o).style("opacity",1e-6).remove()}function T(t){var e=I.svgHoverRoot.selectAll("rect.highlightbar").data(t);e.attr("x",u).attr("width",w.rangeBand()),e.enter().append("rect").attr("x",u).attr("y",0).attr("height",I.height).attr("width",w.rangeBand()).classed("highlightbar clickable",!0),e.exit().remove()}function k(t){var e=t&&t.length>0?t.slice(0,1):[],n=t&&t.length>0?u(t[0]):0,r=t&&t.length>0?u(t[t.length-1]):0,a=r-n+w.rangeBand(),o=I.svgHoverRoot.selectAll("rect.selectionbar").data(e);o.attr("x",n).attr("width",a),o.enter().append("rect").attr("x",n).attr("y",0).attr("height",I.height).attr("width",a).classed("selectionbar clickable",!0),o.exit().remove()}var I=B.chart.baseGroupedStackTimeChart(t,n),A=l(I);A.me=A;var w=e.scale.ordinal(),M=I.svgRoot.insert("g",".annot-root").attr("class","vertrule").attr("transform","translate("+I.padding[3]+","+I.padding[0]+")");return A.scaleDate=function(t){var e=w.range(),n=w.rangeExtent(),r=I.scaleDate(t),a=e[Math.round(r/n[1]*(e.length-1))]+w.rangeBand()/2;return a},Object.defineProperties(A,{svgVertRuleGroup:{value:M},xBar:{value:w},xBarPadding:{value:g},trimToXDomain:{value:y},computeDomainX:{value:o},groupFillFn:{value:r},keyX:{value:i},valueX:{value:u},valueXMidBar:{value:s},valueXVertRule:{value:c},valueY:{value:d},heightY:{value:f},drawAxisXRules:{value:D},drawBarsForSources:{value:C},drawHoverHighlightBars:{value:T},drawSelection:{value:k}}),I.drawAxisX=b,A},B.chart.basicLineChart=function(n,r){function a(){var e=d.plotPropertyName,n=[null,null],r=[null,null];x=[],g.forEach(function(t){var a=p.data(t);a&&a.forEach(function(a){var o;void 0===a.date&&(a.date=B.api.datum.datumDate(a)),v&&v.call(this,t)||((null===n[0]||a.date<n[0])&&(n[0]=a.date),(null===n[1]||a.date>n[1])&&(n[1]=a.date),o=a[y[t]?y[t]:e],void 0!==o&&((null===r[0]||o<r[0])&&(r[0]=o),(null===r[1]||o>r[1])&&(r[1]=o)))}),x.push(a)}),C.domain(g.length),m&&m.length>0||C.range(t.Set3[g.length<3?3:g.length>11?12:g.length]),d.x.domain(n),d.y.domain(r).nice(),d.computeUnitsY()}function o(t,e){return g[e]}function i(t,e){return C(e)}function u(t,e){var n=v?v.call(this,g[e]):!1;return n?1e-6:1}function s(t){t.style("opacity",u).attr("stroke",i).attr("d",b)}function c(){var t,e=d.transitionMs();t=d.svgDataRoot.selectAll("path").data(x,function(t,e){return g[e]}),t.attr("class",o).transition().duration(e).call(s),t.enter().append("path").attr("class",o).call(s),t.exit().transition().duration(e).style("opacity",1e-6).remove(),f()}var d=B.chart.baseTimeChart(n,r),f=B.util.superMethod.call(d,"draw"),p=l(d);p.me=p;var v,m,h={},g=[],y={},x=[],b=e.svg.line().interpolate("monotone").x(function(t){return Math.round(d.x(t.date)+.5)-.5}).y(function(t){var e=this.getAttribute("class"),n=y[e]?y[e]:d.plotPropertyName,r=t[n];return Math.round(d.y(void 0===r?null:r)+.5)-.5}),C=e.scale.ordinal().range(t.Set3[12]);return p.load=function(t,e,n){return void 0===h[e]?(g.push(e),h[e]=t):h[e]=h[e].concat(t),n?y[e]=n:y[e]&&delete y[e],p.me},p.sourceExcludeCallback=function(t){return arguments.length?(v="function"==typeof t?t:void 0,p.me):v},p.colors=function(t){return arguments.length?(m=t,C.range(t),p.me):C.range()},p.colorScale=function(){return C},p.data=function(t){return h[t]},p.reset=function(){return d.reset(),h={},g.length=0,y={},x.length=0,p.me},p.enumerateDataOverTime=function(t){if("function"!=typeof t)return p.me;if(!g||g.length<1)return p.me;var n=[],r=B.api.datum.datumDate,a={date:null,data:{}};return g.forEach(function(t){n.push(h[t])}),n=e.merge(n).sort(function(t,e){var n=r(t);t.date||(t.date=n);var a=r(e);return e.date||(e.date=rD),a>n?-1:n>a?1:0}),n.forEach(function(e){var n=r(e);a.date&&n>a.date?(t.call(p.me,a.data,a.date),a.date=n,a.data={}):a.date||(a.date=n),a.data[e.sourceId]=e}),p.me},d.setup=a,d.draw=c,p},B.chart.energyBarOverlapChart=function(t,e){function n(t,e){return a.groupOpacityFn(null,e)}function r(){var t,e,r=[],o=a.groupIds,i=a.transitionMs();a.computeDomainX(),o.forEach(function(t){var e=a.groupLayers[t];void 0===e?r.push([]):r.push(e.map(function(t){return t.values}))}),t=u.selectAll("g.dataType").data(r,function(t,e){return o[e]}),t.enter().append("g").attr("class","dataType").style("opacity",n),e=t.selectAll("g.source").data(Object,function(t){return t[0].sourceId}).style("fill",a.groupFillFn),e.enter().append("g").attr("class","source").style("fill",a.groupFillFn),e.exit().transition().duration(i).style("opacity",1e-6).remove(),a.drawBarsForSources(e),a.drawAxisY(),a.drawAxisX()}var a=B.chart.baseGroupedStackTimeBarChart(t,e),o=function(){var t=B.util.copy(a);return Object.defineProperty(t,"version",{value:"1.0.0",enumerable:!0,configurable:!0}),t}();a.me=o;var i=o,u=a.svgDataRoot.append("g").attr("class","data");return Object.defineProperty(o,"me",{enumerable:!1,get:function(){return i},set:function(t){i=t,a.me=t}}),a.draw=r,o},B.chart.energyIOBarChart=function(t,n){function r(t){var e=y.config.seasonColors||["#5c8726","#e9a712","#762123","#80a3b7"],n=t.date.getUTCMonth();return 2>n||11==n?b?e[3]:e[1]:5>n?b?e[0]:e[2]:8>n?b?e[1]:e[3]:b?e[2]:e[0]}function a(t){return"Month"===y.aggregate()?r(t):null}function o(){var t;return t=1===y.yScale()?",d":",.1f",e.format(t)}function i(t){var e,n,r,a,o,i=null,u=null,l=null,s=t.length,c=!1;for(r=0;s>r;r+=1)e=t[r],n=e[y.plotPropertyName],void 0!==n&&(a=e[y.internalPropName].groupId,o=y.scaleFactor(a),c=C[a]===!0,c?l+=n*o:u+=n*o);return null===u&&null===l||(i=u-l),{date:t[0].date,y:i,plus:u,minus:l}}function u(){var t,n,r=[],a=y.groupIds,o=0,u=0,l=y.aggregate();a.forEach(function(t){var n=y.groupLayers[t];void 0===n?r.push([]):r.push(n.map(function(n){var r=e.max(n.values,function(t){return t.y+t.y0});return C[t]===!0?r>u&&(u=r):r>o&&(o=r),n.values}))});var s=e.merge(e.merge(r)).concat(y.xBar.domain().map(function(t){return{date:t}}));return t=e.nest().key(function(t){return t.date.getTime()}).sortKeys(e.ascending).rollup(i).entries(s).map(function(t){return t.values}),n=e.nest().key(function(t){var n;return n="Day"===l?e.time.month.utc.floor(t.date):"Month"===l?e.time.month.utc.offset(t.date,-((t.date.getUTCMonth()+1)%3)):e.time.day.utc.floor(t.date),n.getTime()}).sortKeys(e.ascending).rollup(i).entries(s).map(function(t){return t.values.date=new Date(Number(t.key)),t.values}),{allData:s,groupedData:r,sumLineData:t,timeAggregateData:n,maxPositiveY:o,maxNegativeY:u}}function l(){function t(t,e){var n=0;return C[o[e]]===!0?(n=-(2*r),"scale(1, -1) translate(0,"+n+")"):null}var e,n,r,a,o=y.groupIds,i=y.transitionMs(),l=y.y.domain();y.computeDomainX(),a=u(),w=a,l[0]=-a.maxNegativeY,l[1]=a.maxPositiveY,y.y.domain(l).nice(),r=y.y(0),e=k.selectAll("g.dataType").data(a.groupedData,function(t,e){return o[e]}),e.transition().duration(i).attr("transform",t),e.enter().append("g").attr("class","dataType").attr("transform",t),n=e.selectAll("g.source").data(Object,function(t){return t[0].sourceId}).style("fill",y.groupFillFn),n.enter().append("g").attr("class","source").style("fill",y.groupFillFn),n.exit().transition().duration(i).style("opacity",1e-6).remove(),y.drawBarsForSources(n),s(a.sumLineData),c(a.timeAggregateData),d(a.timeAggregateData),y.drawAxisY(),y.drawAxisX(),y.drawAxisXRules(a.timeAggregateData)}function s(t){function n(t){return null!==t.y}var r=y.transitionMs(),a=e.svg.line().x(y.valueXMidBar).y(function(t){return y.y(t.y)-.5}).interpolate("monotone").defined(n),o=I.selectAll("path").data([t]);o.transition().duration(r).attr("d",a),o.enter().append("path").attr("d",e.svg.line().x(y.valueXMidBar).y(function(){return y.y(0)-.5}).interpolate("monotone").defined(n)).transition().duration(r).attr("d",a),o.exit().transition().duration(r).style("opacity",1e-6).remove()}function c(t){function n(t){var e=y.valueXMidBar(t);return e}function a(t){return m((t.plus-t.minus)/y.yScale())}var i,u=y.transitionMs(),l=y.x.domain(),s=y.xBar,c=t.length;i="Month"===y.aggregate()&&c>0?t:[];var d=s.rangeBand(),f=y.xBarPadding()/2,p=D.selectAll("line").data(i,y.keyX),v=function(t){t.attr("x1",function(t){var e=t.date;return e.getTime()<l[0].getTime()&&(e=l[0]),s(e)-f}).attr("x2",function(t,e){return e+1<i.length?s(i[e+1].date)-f:i.length>0?s(l[1])+d+f:s(t.date)+f}).style("stroke",r)};p.transition().duration(u).call(v),p.enter().append("line").style("opacity",1e-6).call(v).transition().duration(u).style("opacity",1).each("end",function(){e.select(this).style("opacity",null)}),p.exit().transition().duration(u).style("opacity",1e-6).remove();var m=o(),h=T.selectAll("text").data(y.trimToXDomain(i),y.keyX);h.transition().duration(u).attr("x",n).text(a),h.enter().append("text").style("opacity",1e-6).attr("x",n).transition().duration(u).style("opacity",1).text(a).each("end",function(){e.select(this).style("opacity",null)}),h.exit().transition().duration(u).style("opacity",1e-6).remove()}function d(t){function n(t){return l(t.plus/y.yScale())}var r,i,u=y.transitionMs(),l=o();i=y.trimToXDomain(t),r=A.selectAll("text").data(i,y.keyX),r.transition().duration(u).attr("x",y.valueXMidBar).text(n).style("fill",a),r.enter().append("text").attr("x",y.valueXMidBar).style("opacity",1e-6).style("fill",a).transition().duration(u).text(n).style("opacity",1).each("end",function(){e.select(this).style("opacity",null)}),r.exit().transition().duration(u).style("opacity",1e-6).remove()}function f(t){if(w){var n=y.xBar.range(),r=e.bisectLeft(n,t[0]),a=1>r?0:r-1,o=y.xBar.domain()[a],i=[],u=[],l={data:u,yRange:[y.y(0),y.y(0)],allData:i,groups:{}};return w.groupedData.forEach(function(t,e){var n,r,a={groupId:y.groupIds[e],data:[],negate:C[y.groupIds[e]]===!0},s=y.scaleFactor(a.groupId),c=0;t.length>0&&t[0].length>0&&(r=R(t[0],o),r>=t[0].length&&(r-=1),a.index=r,t.forEach(function(t){t[r].date.getTime()===o.getTime()?(n=t[r][y.plotPropertyName]*s,void 0===l.dateUTC&&t[r].created&&(l.dateUTC=t[r].created,l.utcDate=B.format.timestampFormat.parse(l.dateUTC))):n=null,c+=n,a.data.push(n),i.push(n)}),a.total=c,a.y=y.y(c),a.y<l.yRange[0]&&(l.yRange[0]=a.y),a.y>l.yRange[1]&&(l.yRange[1]=a.y)),u.push(a),l.groups[a.groupId]=a}),l.date=o,l.x=y.valueXMidBar({date:o}),l.index=a,void 0===l.utcDate&&w.groupedData.some(function(t){return t.some(function(t){var n,r=t.length>0?t[0]:void 0,o=-1,i=e.time.month,u=1,s=y.aggregate();return r&&r.date&&r.created&&(y.xBar.domain().some(function(t,e){return t.getTime()===r.date.getTime()?(o=e,!0):!1}),o>=0)?(n=B.format.timestampFormat.parse(r.created),"Day"===s?i=e.time.day:"Hour"===s?i=e.time.hour:"FiveMinute"===s?(i=e.time.minute,u=5):"TenMinute"===s?(i=e.time.minute,u=10):"FifteenMinute"===s&&(i=e.time.minute,u=15),l.utcDate=i.offset(n,u*(a-o)),!0):!1})}),l}}function p(){var t=y.hoverEnterCallback();if(t){var e=B.tapCoordinates(this),n=f(e);if(!n)return void(M=void 0);y.drawHoverHighlightBars(n&&n.dateUTC?[n]:[]),M=n,t.call(y.me,this,e,n)}}function v(){var t=y.hoverMoveCallback();if(t){var e=B.tapCoordinates(this),n=f(e);if(!n)return void(M=void 0);y.drawHoverHighlightBars(n&&n.dateUTC?[n]:[]),M=n,P.length>0&&(n.date>P[0].date?y.drawSelection(P.concat(n)):y.drawSelection([n,P[0]])),t.call(y.me,this,e,n)}}function m(){var t=y.hoverLeaveCallback();if(t){var e=[];this&&(e.push(this),e.push(B.tapCoordinates(this))),y.drawHoverHighlightBars([]),M=void 0,t.apply(y.me,e)}}function h(){var t=y.doubleClickCallback();if(t){var n=B.tapCoordinates(this),r=M;r||(r=f(n)),P.length>0&&(P.length=0,y.drawSelection(P)),e.event.preventDefault(),t.call(y.me,this,n,r)}}function g(){var t=y.rangeSelectionCallback();if(t){var n,r=B.tapCoordinates(this),a=M;a||(a=f(r)),a&&((B.hasTouchSupport||e.event.shiftKey)&&P.length>0?a.date>P[0].date?P.push(a):P.splice(0,0,a):P.length>0?P.length=0:P.push(a),n=P,P.length>1&&(n=P.slice(0,P.length),P.length=0),y.drawSelection(P),e.event.preventDefault(),t.call(y.me,this,r,n))}}n&&n.padding||n.value("padding",[20,0,30,30]);var y=B.chart.baseGroupedStackTimeBarChart(t,n),x=function(){var t=B.util.copy(y);return Object.defineProperty(t,"version",{value:"1.0.0",enumerable:!0,configurable:!0}),t}();y.me=x;var b=void 0,C={Consumption:!0},D=y.svgDataRoot.append("g").attr("class","agg-band").attr("transform","translate(0,"+(y.height+y.padding[2]-25)+".5)"),T=y.svgDataRoot.append("g").attr("class","agg-band-ticks").attr("transform","translate(0,"+(y.height+y.padding[2]-21)+")"),k=y.svgDataRoot.append("g").attr("class","data"),I=y.svgDataRoot.append("g").attr("class","agg-sum"),A=y.svgDataRoot.append("g").attr("class","agg-gen").attr("transform","translate(0,"+(10-y.padding[0])+")"),w=void 0,M=void 0,P=[],R=e.bisector(function(t){return t.date}).left;return x.showSumLine=function(t){if(!arguments.length)return!I.classed("off");var n=y.transitionMs();return I.style("opacity",t?1e-6:1).classed("off",!1).transition().duration(n).style("opacity",t?1:1e-6).each("end",function(){e.select(this).style("opacity",null).classed("off",!t)}),y.me},x.northernHemisphere=function(t){if(!arguments.length)return b;if(t===b)return y.me;var e=y.transitionMs();return b=t===!0,D.selectAll("line").transition().duration(e).style("stroke",r),A.selectAll("text").transition().duration(e).style("fill",a),y.me},x.negativeGroupIds=function(t){return arguments.length?(C={},t.forEach(function(t){C[t]=!0}),y.me):function(){var t,e=[];for(t in C)C.hasOwnProperty(t)&&e.pus(t);return e}()},y.draw=l,y.handleHoverEnter=p,y.handleHoverMove=v,y.handleHoverLeave=m,y.handleClick=g,y.handleDoubleClick=h,x},B.math={deg2rad:P,rad2deg:R},B.chart.energyIOPieChart=function(t,n){function r(t){return"scale(1.05) "+x(t,4)}function a(){return M||(M=w.append("g").attr("class","hover-root").attr("transform","translate("+L[3]+","+L[0]+")")),M}function o(t){var e=t.data()[0],n=h(e),r=g(e);return{groupId:e.data.groupId,sourceId:e.data.sourceId,allData:rt.map(function(t){return t.data}),value:e.value,valueDisplay:b(e),percent:e.value/at,percentDisplay:C(e),totalValue:at,totalValueDisplay:ft(at/dt),angle:n,angleStart:e.startAngle,angleEnd:e.endAngle,degrees:B.math.rad2deg(n),radius:S,innerRadius:ot,center:[(E+L[1]+L[3])/2,(F+L[0]+L[2])/2],centerContainer:w.node(),labelTranslate:[Math.cos(r)*(S+15),Math.sin(r)*(S+15)]}}function i(t,e){return t.key.localeCompare(e.key)}function u(){j=O.value("transitionMs")||600,ot=O.value("innerRadius")||0,it.innerRadius(ot).outerRadius(S)}function l(t){return t.value}function s(){var t,n=e.max(rt,l);dt=1,W?dt=W.call(P,n):n>=1e9?dt=1e9:n>=1e6?dt=1e6:n>=1e3&&(dt=1e3),t=dt>=1e6?",.2f":1e3===dt?",.1f":1===dt?",d":",g",ft=e.format(t),at=e.sum(rt,l)}function c(){var t=[];nt.forEach(function(n){var r=function(t,e){return Y?Y.call(P,n,t,e):(n+"-"+t.sourceId).replace(/\W/,"-")},a=e.nest().key(r).rollup(function(t){var r={sum:0,groupId:n};return t.length&&(r.sourceId=t[0].sourceId,r.sum=e.sum(t,function(t){var e=t[H];return(e&&0>e||_&&_.call(P,n,t.sourceId))&&(e=0),e})*P.scaleFactor(n)),r}).entries(tt[n]);_&&(a=a.filter(function(t){return!_.call(P,n,t.key)})),t=t.concat(a.map(function(t){return t.values.key=t.key,t.values}))});var n=e.layout.pie().sort(q).value(function(t){return t.sum});et=t,rt=n(t),s()}function d(t,n){if(K)return K.call(P,t.data.groupId,t.data.sourceId,n);var r=e.scale.category10().range();return r[n%r.length]}function f(){e.select(this).style("opacity",null)}function p(t){var n=e.interpolate(this._data_start.startAngle,t.startAngle),r=e.interpolate(this._data_start.endAngle,t.endAngle);return this._data_start=t,function(t){var e={startAngle:n(t),endAngle:r(t)};return it(e)}}function v(t){return t.data.key}function m(){var t=z.selectAll("path").data(rt,v);t.transition().duration(j).attr("d",it).style("fill",d).attrTween("d",p),t.enter().append("path").attr("class",function(t){return"area "+t.data.key}).style("fill",d).style("opacity",1e-6).attr("d",it).attr("pointer-events","all").on("mouseover",ut).on("mousemove",lt).on("mouseout",st).on(B.tapEventNames.click,ct).each(function(t){this._data_start=t}).transition().duration(j).style("opacity",1).each("end",f),t.exit().transition().duration(j).style("opacity",1e-6).remove(),A()}function h(t){return t.startAngle+(t.endAngle-t.startAngle)/2}function g(t){return h(t)-Math.PI/2}function y(t,n){var r=e.interpolate(h(this._data_start),h(t));return this._data_start=t,function(t){var e=r(t)-Math.PI/2;return"translate("+Math.cos(e)*n+","+Math.sin(e)*n+")"}}function x(t,e){var n=g(t);return"translate("+Math.cos(n)*e+","+Math.sin(n)*e+")"}function b(t){return ft(t.value/dt)}function C(t){return $(t.value/at)}function D(t){var e=h(t);return e<2*Math.PI*(1/8)||e>2*Math.PI*(7/8)?"middle":e<2*Math.PI*(3/8)?"start":e<2*Math.PI*(5/8)?"middle":"end"}function T(t){var e=h(t);return e>=2*Math.PI*(3/8)&&e<2*Math.PI*(5/8)?"0.5em":0}function k(){var t=Number(O.value("percentageLabelMinimumPercent"));return(isNaN(t)?5:t)/100*at}function I(){var t=Number(O.value("valueLabelMinimumPercent"));return(isNaN(t)?5:t)/100*at}function A(){var t=I(),e=O.enabled("hideValues")?[]:rt.filter(function(e){return e.value>t}),n=G.selectAll("text.outer").data(e,v);n.transition().duration(j).text(b).attr("text-anchor",D).attr("dy",T).attr("transform",function(t){return x(t,S+15)}).attrTween("transform",function(t){return y.call(this,t,S+15)}),n.enter().append("text").classed("outer",!0).attr("transform",function(t){return x(t,S+15)}).attr("text-anchor",D).attr("dy",T).style("opacity",1e-6).text(b).each(function(t){this._data_start=t}).transition().duration(j).style("opacity",1).each("end",f),n.exit().transition().duration(j).style("opacity",1e-6).remove();var r=k(),a=O.enabled("hidePercentages")?[]:rt.filter(function(t){return t.value>r}),o=G.selectAll("text.inner").data(a,v),i=(S-ot)/2+ot;o.transition().duration(j).text(C).attr("transform",function(t){return x(t,i)}).attrTween("transform",function(t){return y.call(this,t,i)}),o.enter().append("text").classed("inner",!0).attr("transform",function(t){return x(t,i)}).attr("text-anchor","middle").style("opacity",1e-6).text(C).each(function(t){this._data_start=t}).transition().duration(j).style("opacity",1).each("end",f),o.exit().transition().duration(j).style("opacity",1e-6).remove()}var w,M,P={version:"1.0.0"},R=P,U=[],O=n||new B.Configuration,N=B.ui.pixelWidth(t),L=O.padding||[24,24,24,24],E=(O.width||N||300)-L[1]-L[3],F=(O.height||300)-L[0]-L[2],S=e.min([E,F])/2,j=void 0,H="wattHours",z=void 0,G=void 0,X={},K=void 0,_=void 0,W=void 0,Y=void 0,q=i,Q=void 0,V=void 0,Z=void 0,J=void 0,$=e.format(".0%"),tt={},et=[],nt=[],rt=void 0,at=0,ot=0,it=e.svg.arc(),ut=function(){if(Q){var t=e.select(this),n=e.mouse(this),a=o(t,n);t.transition().duration(j).attr("transform",r),Q.call(R,this,n,a)}},lt=function(){if(V){var t=e.select(this),n=e.mouse(this),r=o(t,n);V.call(R,this,n,r)}},st=function(){if(Z){var t=e.select(this),n=e.mouse(this),r=o(t,n);t.transition().duration(j).attr("transform","identity").each("end",function(){e.select(this).style("transform",null)}),Z.call(R,this,n,r)}},ct=function(){if(J){var t=e.select(this),n=e.mouse(this),r=o(t,n);J.call(R,this,n,r)}};u(),w=e.select(t),w.node()&&"svg"!==w.node().tagName.toLowerCase()&&(w=w.select("svg"),w.empty()?w=e.select(t).append("svg:svg").attr("class","chart").attr("width",E+L[1]+L[3]).attr("height",F+L[0]+L[2]):w.selectAll("*").remove()),z=w.append("g").attr("class","data").attr("transform","translate("+(E+L[1]+L[3])/2+","+(F+L[0]+L[2])/2+")"),G=w.append("g").attr("class","label").attr("transform","translate("+(E+L[1]+L[3])/2+","+(F+L[0]+L[2])/2+")");var dt=1,ft=e.format(",d");return P.sources=U,P.scale=function(){return W?W():dt},P.totalValue=function(){return at},P.reset=function(){return tt={},nt=[],et=[],rt=void 0,R},P.load=function(t,e){return void 0===tt[e]?(nt.push(e),tt[e]=t):tt[e].concat(t),R},P.regenerate=function(){return void 0===tt?P:(u(),c(),m(),R)},P.transitionMs=function(t){return arguments.length?(j=+t,R):j},P.plotProperty=function(t){return arguments.length?(H=t,R):H},P.scaleFactor=function(t,e){var n;if(!arguments.length)return X;if(1===arguments.length){if("string"==typeof t)return n=X[t],void 0===n?1:n;X=t}else 2==arguments.length&&(X[t]=e);return R},P.colorCallback=function(t){return arguments.length?(K="function"==typeof t?t:void 0,R):K},P.displayFactorCallback=function(t){return arguments.length?(W="function"==typeof t?t:void 0,R):W},P.sourceExcludeCallback=function(t){return arguments.length?(_="function"==typeof t?t:void 0,R):_},P.layerKeyCallback=function(t){return arguments.length?("function"==typeof t&&(Y=t),R):Y},P.layerKeySort=function(t){return arguments.length?("function"==typeof t&&(q=t),R):q},P.hoverEnterCallback=function(t){return arguments.length?(a(),Q="function"==typeof t?t:void 0,R):Q},P.hoverMoveCallback=function(t){return arguments.length?(a(),"function"==typeof t?(a(),V=t):V=void 0,R):V},P.hoverLeaveCallback=function(t){return arguments.length?(a(),Z="function"==typeof t?t:void 0,R):Z},P.clickCallback=function(t){return arguments.length?(J="function"==typeof t?t:void 0,R):J},P.exportChartData=function(t){return"function"==typeof t&&Array.isArray(et)&&et.forEach(function(e){t.call(R,e)}),R},P.enumerateDataOverTime=function(t){if("function"!=typeof t)return R;if(!nt||nt.length<1)return R;var n=[],r=B.api.datum.datumDate,a={
date:null,data:{}};return nt.forEach(function(t){n.push(tt[t])}),n=e.merge(n).sort(function(t,e){var n=r(t);t.date||(t.date=n);var a=r(e);return e.date||(e.date=rD),a>n?-1:n>a?1:0}),n.forEach(function(e){var n=r(e);a.date&&n>a.date?(t.call(R,a.data,a.date),a.date=n,a.data={}):a.date||(a.date=n),a.data[e.sourceId]=e}),R},P},B.chart.gauge=function(t,n){function r(t){var e=h(t),n=c.minAngle+e*d;return n}function a(t){var n=void 0;for(n in t)c[n]=t[n];d=c.maxAngle-c.minAngle,f=c.size/2,p=Math.round(f*c.pointerHeadLengthPercent),h=e.scale.linear().range([0,1]).domain([c.minValue,c.maxValue]),g=h.ticks(c.majorTicks),y=e.range(c.majorTicks).map(function(){return 1/c.majorTicks}),m=e.svg.arc().innerRadius(f-c.ringWidth-c.ringInset).outerRadius(f-c.ringInset).startAngle(function(t,e){var n=t*e;return B.math.deg2rad(c.minAngle+n*d)}).endAngle(function(t,e){var n=t*(e+1);return B.math.deg2rad(c.minAngle+n*d)})}function o(){return"translate("+f+","+f+")"}function i(){return void 0!==v}function u(n){v=e.select(t).append("svg:svg").attr("class","gauge").attr("width",c.clipWidth).attr("height",c.clipHeight);var a=o(),i=v.append("g").attr("class","arc").attr("transform",a);i.selectAll("path").data(y).enter().append("path").attr("fill",function(t,e){return c.arcColorFn(t*e)}).attr("d",m);var u=v.append("g").attr("class","label").attr("transform",a);u.selectAll("text").data(g).enter().append("text").attr("transform",function(t){var e=r(t);return"rotate("+e+") translate(0,"+(c.labelInset-f)+")"}).text(c.labelFormat);var s=[[c.pointerWidth/2,0],[0,-p],[-(c.pointerWidth/2),0],[0,c.pointerTailLength],[c.pointerWidth/2,0]],d=e.svg.line().interpolate("monotone"),h=v.append("g").data([s]).attr("class","pointer").attr("transform",a);x=h.append("path").attr("d",d).attr("transform","rotate("+c.minAngle+")"),l(void 0===n?0:n)}function l(t,e){void 0!==e&&a(e);var n=r(t);x.transition().duration(c.transitionMs).ease("elastic").attr("transform","rotate("+n+")")}var s={version:"1.0.0"},c={size:200,clipWidth:200,clipHeight:110,ringInset:20,ringWidth:20,pointerWidth:10,pointerTailLength:5,pointerHeadLengthPercent:.9,minValue:0,maxValue:10,minAngle:-90,maxAngle:90,transitionMs:750,majorTicks:5,labelFormat:e.format(",g"),labelInset:10,arcColorFn:e.interpolateHsl(e.rgb("#e8e2ca"),e.rgb("#3e6c0a"))},d=void 0,f=void 0,p=void 0,v=void 0,m=void 0,h=void 0,g=void 0,y=void 0,x=void 0;return s.configure=a,s.isRendered=i,s.render=u,s.update=l,a(n),s},B.chart.powerAreaChart=function(t,n){function r(t,e){return i.fillColor.call(this,t[0][i.internalPropName].groupId,t[0],e)}function a(){var t,n,r,a,o,u=[],s=i.plotPropertyName,c=e.layout.stack().offset(l.stackOffset()).values(function(t){return t.values}).x(function(t){return t.date}).y(function(t){var e=t[s],n=i.scaleFactor(t[i.internalPropName].groupId);return(void 0===e||0>e||null===e)&&(e=0),e*n});i.groupIds.forEach(function(t){var e,n,r,a=l.data(t);if(a&&!(!a.length>1))for(e=0,n=a.length;n>e;e+=1)r=a[e],r.hasOwnProperty(i.internalPropName)||(r[i.internalPropName]={},r[i.internalPropName].groupId=t,l.dataCallback()?l.dataCallback().call(i.me,t,r):void 0===r.date&&(r.date=B.api.datum.datumDate(r))),l.sourceExcludeCallback()&&l.sourceExcludeCallback().call(i.me,t,r.sourceId)||u.push(r)}),t=e.nest().key(function(t){return t[i.internalPropName].groupId+"|"+t.sourceId}).sortKeys(e.ascending).entries(u),t.length<1||(n={},n[s]=null,B.api.datum.nestedStackDataNormalizeByDate(t,n,function(t,e){var n=e.indexOf("|");t[i.internalPropName]={groupId:e.slice(0,n)},t.sourceId=e.slice(n+1)}),i.insertNormalizedDurationIntoLayerData(t),i.me.layerPostProcessCallback()&&(t=function(){var e=[];return i.groupIds.forEach(function(n){var r=t.filter(function(t){return 0===t.key.indexOf(n+"|")});r.length>0&&(e=e.concat(i.me.layerPostProcessCallback().call(i.me,n,r)))}),e}()),r=u.length>0?[u[0].date,u[u.length-1].date]:void 0,o=c(t),i.groupLayers.All=o,a=[0,e.max(o[o.length-1].values,function(t){return t.y0+t.y})],void 0!==r&&i.x.domain(r),void 0!==a&&i.y.domain(a).nice(),i.computeUnitsY())}function o(){var t=i.transitionMs(),e=i.groupLayers.All,n=e?e.map(function(t){return t.values}):[],a=i.svgDataRoot.selectAll("path.area").data(n,function(t){return t.length?t[0][i.internalPropName].groupId+"-"+t[0].sourceId:null});a.transition().duration(t).attr("d",s).style("fill",r),a.enter().append("path").attr("class","area").style("fill",r).attr("d",s).style("opacity",1e-6).transition().duration(t).style("opacity",1),a.exit().transition().duration(t).style("opacity",1e-6).remove(),u()}var i=B.chart.baseGroupedStackTimeChart(t,n),u=B.util.superMethod.call(i,"draw"),l=function(){var t=B.util.copy(i);return t}();i.me=l;var s=e.svg.area().interpolate("monotone").x(function(t){return i.x(t.date)}).y0(function(t){return i.y(t.y0)}).y1(function(t){return i.y(t.y0+t.y)});return i.setup=a,i.draw=o,l},B.chart.powerAreaOverlapChart=function(t,n){function r(t,e){return i.fillColor.call(this,t[0][i.internalPropName].groupId,t[0],e)}function a(t,e,n){return i.groupOpacityFn(null,n)}function o(){var t=[],e=[],n=i.groupIds,o=i.transitionMs();n.forEach(function(n){var r=i.groupLayers[n];if(void 0!==r){e.push(n);var a=r.map(function(t){return t.values});t.push(a)}});var l=i.svgDataRoot.selectAll("g.data").data(t,function(t,n){return e[n]});l.enter().append("g").attr("class","data"),l.exit().transition().duration(o).style("opacity",1e-6).remove();var c=l.selectAll("path.area").data(Object,function(t){return t.length?t[0][i.internalPropName].groupId+"."+t[0].sourceId:null});c.transition().duration(o).delay(200).attr("d",s).style("fill",r),c.enter().append("path").attr("class","area").style("fill",r).attr("d",s).style("opacity",1e-6).transition().duration(o).style("opacity",a),c.exit().transition().duration(o).style("opacity",1e-6).remove(),u()}var i=B.chart.baseGroupedStackTimeChart(t,n),u=B.util.superMethod.call(i,"draw"),l=function(){var t=B.util.copy(i);return t}();i.me=l;var s=e.svg.area().interpolate("monotone").x(function(t){return i.x(t.date)}).y0(function(t){return i.y(t.y0)}).y1(function(t){return i.y(t.y0+t.y)});return i.draw=o,i.normalizeDataTimeGaps(!0),l},B.chart.powerIOAreaChart=function(t,n){function r(t,e){return s.fillColor.call(this,t[0][s.internalPropName].groupId,t[0],e)}function a(t){var e,n,r,a,o,i=null,u=null,l=null,c=t.length,d=!1;for(r=0;c>r;r+=1)e=t[r],n=e[s.plotPropertyName],void 0!==n&&(a=e[s.internalPropName].groupId,o=s.scaleFactor(a),d=v[a]===!0,d?l+=n*o:u+=n*o);return null===u&&null===l||(i=u-l),{date:t[0].date,y:i,plus:u,minus:l}}function o(){var t,n,r=e.scale.ordinal(),a=s.x,o=s.aggregate(),i=a.domain(),u=1;return"Month"===o?t=e.time.month.utc:"Day"===o?t=e.time.day.utc:"Hour"===o?t=e.time.hour.utc:0===o.search(/^Ten/)?(t=e.time.minute.utc,u=10):0===o.search(/^Five/)?(t=e.time.minute.utc,u=5):(t=e.time.minute.utc,u=15),n=t.range(i[0],t.offset(i[1],u),u),r.domain(n),r}function i(){var t,n=[],r=s.groupIds,i=0,u=0,l=o();r.forEach(function(t){var r=s.groupLayers[t];void 0===r?n.push([]):n.push(r.map(function(n){var r=e.max(n.values,function(t){return t.y+t.y0});return v[t]===!0?r>u&&(u=r):r>i&&(i=r),n.values}))});var c=e.merge(e.merge(n)).concat(l.domain().map(function(t){return{date:t}}));return t=e.nest().key(function(t){return t.date.getTime()}).sortKeys(e.ascending).rollup(a).entries(c).map(function(t){return t.values}),{groupedData:n,sumLineData:t,maxPositiveY:i,maxNegativeY:u}}function u(){function t(t,e){var n=0;return v[u[e]]===!0?(n=-(2*a),"scale(1, -1) translate(0,"+n+")"):null}var e,n,a,o,u=s.groupIds,d=s.transitionMs(),f=s.y.domain();o=i(),f[0]=-o.maxNegativeY,f[1]=o.maxPositiveY,s.y.domain(f).nice(),a=s.y(0),e=s.svgDataRoot.selectAll("g.dataType").data(o.groupedData,function(t,e){return u[e]}),e.transition().duration(d).attr("transform",t),e.enter().append("g").attr("class","dataType").attr("transform",t),n=e.selectAll("path.source").data(Object,function(t){return t.length?t[0].sourceId:null}),n.transition().duration(d).attr("d",p).style("fill",r),n.enter().append("path").attr("class","source").style("fill",r).attr("d",p).style("opacity",1e-6).transition().duration(d).style("opacity",1),n.exit().transition().duration(d).style("opacity",1e-6).remove(),l(o.sumLineData),c()}function l(t){function n(t){return null!==t.y}function r(t){return s.x(t.date)}var a=s.transitionMs(),o=e.svg.line().x(r).y(function(t){return s.y(t.y)-.5}).interpolate("monotone").defined(n),i=f.selectAll("path").data([t]);i.transition().duration(a).attr("d",o),i.enter().append("path").attr("d",e.svg.line().x(r).y(function(){return s.y(0)-.5}).interpolate("monotone").defined(n)).transition().duration(a).attr("d",o),i.exit().transition().duration(a).style("opacity",1e-6).remove()}var s=B.chart.baseGroupedStackTimeChart(t,n),c=B.util.superMethod.call(s,"draw"),d=function(){var t=B.util.copy(s);return Object.defineProperty(t,"version",{value:"1.0.0",enumerable:!0,configurable:!0}),t}();s.me=d;var f=s.svgRoot.append("g").attr("class","agg-sum").attr("transform",s.svgDataRoot.attr("transform")),p=e.svg.area().interpolate("monotone").x(function(t){return s.x(t.date)}).y0(function(t){return s.y(t.y0)}).y1(function(t){return s.y(t.y0+t.y)}),v={Consumption:!0};return d.showSumLine=function(t){if(!arguments.length)return!f.classed("off");var n=s.transitionMs();return f.style("opacity",t?1e-6:1).classed("off",!1).transition().duration(n).style("opacity",t?1:1e-6).each("end",function(){e.select(this).style("opacity",null).classed("off",!t)}),s.me},d.negativeGroupIds=function(t){return arguments.length?(v={},t.forEach(function(t){v[t]=!0}),s.me):function(){var t,e=[];for(t in v)v.hasOwnProperty(t)&&e.pus(t);return e}()},s.draw=u,s.normalizeDataTimeGaps(!0),d},B.chart.seasonalDayOfWeekLineChart=function(t,n){var r=B.chart.baseGroupedSeasonalLineChart(t,n),a=function(){var t=B.util.copy(r);return Object.defineProperty(t,"version",{value:"1.0.0",enumerable:!0,configurable:!0}),t}();return r.me=a,r.timeKeyLabels(["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]),r.xAxisTicks=function(){return r.x.domain()},r.dateForTimeKey=function(t){return new Date(Date.UTC(2001,0,1+t))},r.timeKeyForDate=function(t){return(t.getUTCDay()+6)%7},r.timeKeyInterval=function(){return e.time.day.utc},a},B.chart.seasonalHourOfDayLineChart=function(t,n){var r=B.chart.baseGroupedSeasonalLineChart(t,n),a=function(){var t=B.util.copy(r);return Object.defineProperty(t,"version",{value:"1.0.0",enumerable:!0,configurable:!0}),t}();return r.me=a,r.timeKeyLabels(["Midnight","1am","2am","3am","4am","5am","6am","7am","8am","9am","10am","11am","Noon","1pm","2pm","3pm","4pm","5pm","6pm","7pm","8pm","9pm","10pm","11pm"]),r.xAxisTicks=function(){return r.x.domain().filter(function(t,e){return e%2===0})},r.dateForTimeKey=function(t){return new Date(Date.UTC(2001,0,1,t))},r.timeKeyForDate=function(t){return t.getUTCHours()},r.timeKeyInterval=function(){return e.time.hour.utc},a},B.runtime={},B.color.map=U,B.color.color=O,B.color.sourceColorMapping=N,B.counter=L,B.hasTouchSupport=function(){if(!G||!G.document)return!1;if("createTouch"in G.document)return!0;try{var t=G.document.createEvent("TouchEvent");return!!t.initTouchEvent}catch(e){return!1}}(),B.tapEventNames=function(){return B.hasTouchSupport?{start:"touchstart",move:"touchmove",end:"touchend",cancel:"touchcancel",click:"touchstart",dblclick:"touchstart"}:{start:"mousedown",move:"mousemove",end:"mouseup",cancel:"touchcancel",click:"click",dblclick:"dblclick"}}(),B.tapCoordinates=function(t){var n;return B.hasTouchSupport?(n=e.touches(t),n&&n.length>0?n[0]:void 0):e.mouse(t)},B.format.displayScaleForValue=E,B.format.displayUnitsForScale=F,B.format.fmt=S,B.net.encodeURLQueryTerms=j,B.net.securityHelper=function(t,n){function a(){return m.token&&m.token.length>0&&m.secret&&m.secret.length>0}function o(t){return arguments.length?(m.token=t&&t.length>0?t:void 0,v):m.token}function i(t){return arguments.length&&(m.secret=t),v}function u(){return m.secret&&m.secret.length>0}function l(){return m.secret=void 0,v}function s(t){return null!==t&&t.indexOf("application/x-www-form-urlencoded")<0}function c(t){var e=(void 0===t.method?"GET":t.method.toUpperCase())+"\n"+(void 0!==t.data&&s(t.contentType)?r.MD5(t.data):"")+"\n"+(void 0===t.contentType?"":t.contentType)+"\n"+t.date+"\n"+t.path,n=r.HmacSHA1(e,t.secret||""),a=t.token+":"+r.enc.Base64.stringify(n);return a}function d(t){var e,n,r,a,o={};if(void 0!==t&&t.length>0)for(t.match(/^\?/)&&(t=t.substring(1)),e=t.split("&"),r=0,a=e.length;a>r;r++)n=e[r].split("=",2),2===n.length&&(o[decodeURIComponent(n[0])]=decodeURIComponent(n[1]));return o}function f(t,e){var n=document.createElement("a");n.href=t;var r,a,o=n.pathname,i=d(void 0===e?n.search:e),u=[],l=void 0,s=!0;o.length>0&&"/"!==o.charAt(0)&&(o="/"+o);for(l in i)u.push(l);if(u.sort(),u.length>0)for(o+="?",r=0,a=u.length;a>r;r++)s?s=!1:o+="&",o+=u[r],o+="=",o+=i[u[r]];return o}function p(t,n,a,o,i){var u=t;arguments.length>0&&(arguments.length<5&&"function"==typeof arguments[arguments.length-1]&&(i=arguments[arguments.length-1]),"string"!=typeof n&&(n=void 0),"string"!=typeof a&&(a=void 0),"string"!=typeof o&&(o=void 0)),n=void 0===n?"GET":n.toUpperCase(),"POST"!==n&&"PUT"!==n||a||!function(){var e=t.indexOf("?");-1!==e&&(e+1<t.length-1&&(a=t.substring(e+1)),u=t.substring(0,e),o="application/x-www-form-urlencoded; charset=UTF-8")}();var l=e.json(u);return void 0!==o&&l.header("Content-Type",o),l.on("beforesend",function(e){var i=(new Date).toUTCString(),u=f(t,void 0!==o&&0===o.indexOf("application/x-www-form-urlencoded")?a:void 0),l=c({method:n,date:i,path:u,token:m.token,secret:m.secret,data:a,contentType:o});void 0!==a&&s(o)&&e.setRequestHeader("Content-MD5",r.MD5(a)),e.setRequestHeader("X-SN-Date",i),e.setRequestHeader("Authorization","SolarNetworkWS "+l)}),l.on("load.internal",function(){}),void 0!==i&&l.send(n,a,i),l}var v=p,m={token:t,secret:n};return Object.defineProperties(v,{version:{value:"1.2.0"},hasTokenCredentials:{value:a},token:{value:o},secret:{value:i},hasSecret:{value:u},clearSecret:{value:l},generateAuthorizationHeaderValue:{value:c},parseURLQueryTerms:{value:d},authURLPath:{value:f},json:{value:p}}),v},B.net.sec=B.net.securityHelper(),B.ui.adjustDisplayUnits=function(t,e,n,r){var a=B.format.displayUnitsForScale(e,n);t.selectAll(".unit").text(a),void 0!==r&&t.selectAll(".unit-kind").text(r)},B.ui.colorDataLegendTable=H,B.ui.flipCounter=function(t,n){function r(t){var e=void 0;for(e in t)l[e]=t[e]}function a(n){s=e.select(t).classed("flipCounter",!0),i(void 0===n?0:n)}function o(t,e){return l.flipperWidth*(c.length-1)-l.flipperWidth*e+"px"}function i(t){var n=l.format(t);c=function(){var t,e,r=[];for(t=0,e=n.length;e>t;t++)r.push(n.charAt(t));return r.reverse()}();var r=s.selectAll("span.flipper").data(c);r.style("left",o).each(function(t){var n=e.select(this),r=l.animate===!0?n.classed("flipped"):!1,a=n.select(r||l.animate!==!0?"span.a":"span.b"),o=n.select(r?"span.b":"span.a").text();o!==t&&(a.select("span.value").text(t),l.animate&&n.classed("flipped",!r))}),r.enter().append("span").attr("class","flipper").style("left",o).html(function(t){return(l.animate?'<span class="face b"><span class="value">b</span></span>':"")+'<span class="face a"><span class="value">'+t+"</span></span>"}),r.exit().remove()}var u={version:"1.0.0"},l={flipperWidth:34,transitionMs:200,format:e.format("07,g"),animate:!0},s=void 0,c=["0"];return u.configure=r,u.render=a,u.update=i,r(n),u},B.ui.Matrix=function(){var t="Float32Array"in window;this.matrix=function(){var e;return t?(e=new Float32Array(6),e[0]=1,e[3]=1):e=[1,0,0,1,0,0],e}(),this.support={use3d:this.supportDefaults.use3d,tProp:this.supportDefaults.tProp,trProp:this.supportDefaults.trProp,trTransform:this.supportDefaults.trTransform,trEndEvent:this.supportDefaults.trEndEvent}},B.ui.Matrix.prototype={constructor:B.ui.Matrix,supportDefaults:function(){for(var t=document.createElement("div").style,e="Transform",n=["Webkit"+e,"O"+e,"ms"+e,"Moz"+e],r=["webkitTransitionEnd","oTransitionEnd","transitionend","transitionend"],a=["WebkitTransition","OTransition","transition","MozTransition"],o=["-webkit-transform","-o-transform","transform","-moz-transform"],i="Transform",u="Transition",l="transform",s="transitionEnd",c=n.length;c--;)if(n[c]in t){i=n[c],u=a[c],l=o[c],s=r[c];break}return{use3d:void 0===window.devicePixelRatio?!1:window.devicePixelRatio>1,tProp:i,trProp:u,trTransform:l,trEndEvent:s}}(),toMatrix3D:function(){return"matrix3d("+this.matrix[0]+","+this.matrix[1]+",0,0,"+this.matrix[2]+","+this.matrix[3]+",0,0,0,0,1,0,"+this.matrix[4]+","+this.matrix[5]+",0,1)"},toMatrix2D:function(){return"matrix("+this.matrix[0]+","+this.matrix[1]+","+this.matrix[2]+","+this.matrix[3]+","+this.matrix[4]+","+this.matrix[5]+")"},setRotation:function(t){var e=Math.cos(t),n=Math.sin(t);this.matrix[0]=this.matrix[3]=e,this.matrix[1]=0-n,this.matrix[2]=n},setScale:function(t){this.matrix[0]=t,this.matrix[3]=t},setTranslation:function(t,e){this.matrix[4]=t,this.matrix[5]=e},translate:function(t,e){this.matrix[4]+=t,this.matrix[5]+=e},getTranslation:function(){return{x:this.matrix[4],y:this.matrix[5]}},getDistanceFrom:function(t){return Math.sqrt(Math.pow(t.x-this.matrix[4],2),Math.pow(t.y-this.matrix[5],2))},apply:function(t){var e=this.support.use3d===!0?this.toMatrix3D():this.toMatrix2D();t.style[this.support.tProp]=e},animateListen:function(t,e){var n=void 0,r=this;n=function(a){a.target===t&&(t.removeEventListener(r.support.trEndEvent,n,!1),e.apply(t))},t.addEventListener(r.support.trEndEvent,n,!1)},animate:function(t,e,n,r){var a=this;this.animateListen(t,function(){t.style[a.support.trProp]="",void 0!==r&&r.apply(t)});var o=this.support.trTransform+" "+(void 0!==n?n:"0.3s")+" "+(void 0!==e?e:"ease-out");t.style[this.support.trProp]=o,this.apply(t)},easeOut:function(t,e){this.animate(t,"ease-out",void 0,e)},easeIn:function(t,e){this.animate(t,"ease-in",void 0,e)},isUse3d:function(){return this.support.use3d===!0},setUse3d:function(t){this.support.use3d=t===!0}},B});
//# sourceMappingURL=solarnetwork-d3.min.js.map
